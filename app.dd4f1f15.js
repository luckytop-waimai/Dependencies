!function(e){function t(t){for(var r,o,c=t[0],s=t[1],l=t[2],u=0,d=[];u<c.length;u++)o=c[u],Object.prototype.hasOwnProperty.call(a,o)&&a[o]&&d.push(a[o][0]),a[o]=0;for(r in s)Object.prototype.hasOwnProperty.call(s,r)&&(e[r]=s[r]);for(p&&p(t);d.length;)d.shift()();return i.push.apply(i,l||[]),n()}function n(){for(var e,t=0;t<i.length;t++){for(var n=i[t],r=!0,o=1;o<n.length;o++){var s=n[o];0!==a[s]&&(r=!1)}r&&(i.splice(t--,1),e=c(c.s=n[0]))}return e}var r={},o={1:0},a={1:0},i=[];function c(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,c),n.l=!0,n.exports}c.e=function(e){var t=[];o[e]?t.push(o[e]):0!==o[e]&&{0:1,2:1,3:1,4:1,6:1,7:1,10:1}[e]&&t.push(o[e]=new Promise((function(t,n){for(var r="static/css/"+e+"."+{0:"49ac6d03",2:"69611b76",3:"eccd9f34",4:"e2aa5800",5:"31d6cfe0",6:"19dc7aeb",7:"62b9ac4d",8:"31d6cfe0",10:"58c19c0e",11:"31d6cfe0",12:"31d6cfe0"}[e]+".css",a=c.p+r,i=document.getElementsByTagName("link"),s=0;s<i.length;s++){var l=(p=i[s]).getAttribute("data-href")||p.getAttribute("href");if("stylesheet"===p.rel&&(l===r||l===a))return t()}var u=document.getElementsByTagName("style");for(s=0;s<u.length;s++){var p;if((l=(p=u[s]).getAttribute("data-href"))===r||l===a)return t()}var d=document.createElement("link");d.rel="stylesheet",d.type="text/css",d.onload=t,d.onerror=function(t){var r=t&&t.target&&t.target.src||a,i=new Error("Loading CSS chunk "+e+" failed.\n("+r+")");i.code="CSS_CHUNK_LOAD_FAILED",i.request=r,delete o[e],d.parentNode.removeChild(d),n(i)},d.href=a,document.getElementsByTagName("head")[0].appendChild(d)})).then((function(){o[e]=0})));var n=a[e];if(0!==n)if(n)t.push(n[2]);else{var r=new Promise((function(t,r){n=a[e]=[t,r]}));t.push(n[2]=r);var i,s=document.createElement("script");s.charset="utf-8",s.timeout=120,c.nc&&s.setAttribute("nonce",c.nc),s.src=function(e){return c.p+"static/js/"+({0:"vendors~ksid-login~login~password-reset",2:"ksid-login",3:"login",4:"logined",5:"main",6:"not-found",7:"password-reset",8:"root",10:"vendors~password-reset",11:"vendors~sound"}[e]||e)+"."+{0:"1baaca6c",2:"2759768e",3:"4e05c7f3",4:"e4dc2aaa",5:"16536d9a",6:"c34eaf28",7:"4d274969",8:"790f3138",10:"33584b92",11:"1fa2eb2d",12:"747fb420"}[e]+".chunk.js"}(e);var l=new Error;i=function(t){s.onerror=s.onload=null,clearTimeout(u);var n=a[e];if(0!==n){if(n){var r=t&&("load"===t.type?"missing":t.type),o=t&&t.target&&t.target.src;l.message="Loading chunk "+e+" failed.\n("+r+": "+o+")",l.name="ChunkLoadError",l.type=r,l.request=o,n[1](l)}a[e]=void 0}};var u=setTimeout((function(){i({type:"timeout",target:s})}),12e4);s.onerror=s.onload=i,document.head.appendChild(s)}return Promise.all(t)},c.m=e,c.c=r,c.d=function(e,t,n){c.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},c.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},c.t=function(e,t){if(1&t&&(e=c(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(c.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)c.d(n,r,function(t){return e[t]}.bind(null,r));return n},c.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return c.d(t,"a",t),t},c.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},c.p="//shadow.elemecdn.com/faas/melody-plus/",c.oe=function(e){throw console.error(e),e};var s=window.webpackJsonp=window.webpackJsonp||[],l=s.push.bind(s);s.push=t,s=s.slice();for(var u=0;u<s.length;u++)t(s[u]);var p=l;i.push([507,9]),n()}({0:function(e,t){e.exports=React},1:function(e,t,n){"use strict";n.d(t,"s",(function(){return r.a})),n.d(t,"b",(function(){return o.a})),n.d(t,"c",(function(){return a.a})),n.d(t,"j",(function(){return a.b})),n.d(t,"a",(function(){return i.a})),n.d(t,"d",(function(){return w})),n.d(t,"e",(function(){return v.a})),n.d(t,"u",(function(){return S.s})),n.d(t,"t",(function(){return S.r})),n.d(t,"p",(function(){return S.n})),n.d(t,"k",(function(){return S.h})),n.d(t,"h",(function(){return S.d})),n.d(t,"o",(function(){return S.m})),n.d(t,"q",(function(){return S.o})),n.d(t,"r",(function(){return S.p})),n.d(t,"f",(function(){return S.b})),n.d(t,"g",(function(){return S.c})),n.d(t,"i",(function(){return S.e})),n.d(t,"l",(function(){return S.j})),n.d(t,"v",(function(){return S.t})),n.d(t,"n",(function(){return S.l})),n.d(t,"m",(function(){return _.b}));var r=n(90),o=n(201),a=n(84),i=n(174),c=(n(48),n(17),n(11));function s(e,t,n,r,o,a,i){try{var c=e[a](i),s=c.value}catch(e){return void n(e)}c.done?t(s):Promise.resolve(s).then(r,o)}function l(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var a=e.apply(t,n);function i(e){s(a,r,o,i,c,"next",e)}function c(e){s(a,r,o,i,c,"throw",e)}i(void 0)}))}}const u=()=>window.chat.invoke("pc.print.getPrinters"),p=e=>{if(d(e))return;let t=h();t=t.concat([e]);const n=t.join(",");f(n)},d=e=>h().indexOf(String(e))>-1,h=()=>{const e=localStorage.connectedPrinters||"";return e?e.split(","):[]},f=e=>{o.a.setLocalData("connectedPrinters",e)},m=function(){var e=l((function*(){try{return yield window.chat.invoke("pc.print.clearGlobalPrintSettings"),!0}catch(e){return!1}}));return function(){return e.apply(this,arguments)}}(),y=function(){var e=l((function*(){try{return yield window.chat.invoke("pc.print.getGlobalPrintSettings")}catch(e){yield m();return yield window.chat.invoke("pc.print.getGlobalPrintSettings")}}));return function(){return e.apply(this,arguments)}}(),g=function(){var e=l((function*(){try{if(!o.a.isClient)return[];const e=(yield u()).filter(({isEnabled:e})=>e);if(!e||0===e.length){return h().map(e=>({id:Number(e)}))}return e}catch(e){return Object(c.c)("get_printers","fail",{error:e}),[]}}));return function(){return e.apply(this,arguments)}}(),b=function(){var e=l((function*(){return((yield g())||[]).length>0}));return function(){return e.apply(this,arguments)}}(),O=e=>{if(!d(e))return;let t=h();t=t.filter(t=>t!==String(e)),f(t.join(","))};var w={getPrinters:u,connectPrinter:p,isPrinterConnected:d,getConnectedPrinters:h,setConnectedPrinters:f,clearGlobalPrintSettings:m,getGlobalPrintSettings:y,updateGlobalPrintSettings:e=>window.chat.invoke("pc.print.updateGlobalPrintSettings",[e]),getAvailablePrinters:g,haveAvailablePrinter:b,enablePrinter:e=>(p(e),window.chat.invoke("pc.print.enablePrinter",{printerId:Number(e)})),disablePrinter:e=>(O(e),window.chat.invoke("pc.print.disablePrinter",{id:Number(e)})),updatePrinter:e=>window.chat.invoke("pc.print.updatePrinter",e),printOrderByTpl:e=>window.chat.invoke("pc.print.printOrderByTpl",e),parsePNG:e=>window.chat.invoke("pc.print.parsePNG",e)},v=n(175);n(104);var S=n(21),_=n(249)},104:function(e,t,n){"use strict";n.d(t,"c",(function(){return o})),n.d(t,"b",(function(){return a}));const r=new(n(466).a)("sound-db");r.version(11).stores({sound:"name",option:"type"});const o=()=>r.table("sound").toArray(),a=()=>r.table("option").toArray();t.a={getSounds:o,updateSounds:e=>r.table("sound").put(e),getOptions:a,updateOptions:e=>r.table("option").put(e)}},105:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));n(55),n(29),n(20),n(17);var r=n(114),o=n(1),a=n(12);function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function c(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){s(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}let l;!function(e){e.iframe="iframe",e.assets="assets",e.html="html"}(l||(l={}));t.b=new class{constructor(){s(this,"getMenuTree",e=>{const t=Object(o.j)(["shopId","shopType"]),n=t.shopId,r=t.shopType;return a.d.fetch({module:"arena",service:"PermissionManagerService",method:"getMenuTree",params:{shopId:n,shopType:e||r}})}),s(this,"getMenuTreeBackup",e=>{const t=e.toLowerCase();return fetch(`${r.b}melody-plus/menu-backup/${t}`).then(e=>e.json())}),s(this,"getHideApp",e=>{const t=e.toLowerCase();return fetch(`${r.b}melody-plus/hide-app/${t}`).then(e=>e.json())}),s(this,"getIsInGrayNcp",({path:e,service:t,method:n,paramsKey:r,other:i})=>{const s=Object(o.j)(["shopId"]).shopId;return a.d.fetch({module:e,service:t,method:n,params:c({[r||"shopId"]:Number(s)},Object(o.q)(i))})}),s(this,"getIsInGrayRest",({httpMethod:e,path:t,paramsKey:n,withCredentials:r,other:i})=>{const s=Object(o.j)(["shopId","ksid"]),l=s.shopId,u=s.ksid,p=["get","post"].includes(e)?e:"get",d=t.replace(":shopId",l?String(l):"").replace(":ksid",u||"");return"get"===p?a.g.get({url:d,params:{},config:{credentials:r?"include":"omit"}}):a.g.post({url:d,params:c({[n||"shopId"]:l},Object(o.q)(i)),config:{credentials:r?"include":"omit"}})})}}},106:function(e,t,n){"use strict";n.d(t,"a",(function(){return w})),n.d(t,"o",(function(){return J})),n.d(t,"i",(function(){return ce})),n.d(t,"l",(function(){return ge})),n.d(t,"p",(function(){return Me})),n.d(t,"m",(function(){return xe})),n.d(t,"n",(function(){return Ye})),n.d(t,"q",(function(){return Xe})),n.d(t,"f",(function(){return Lt})),n.d(t,"k",(function(){return un})),n.d(t,"b",(function(){return jn})),n.d(t,"c",(function(){return Kn})),n.d(t,"j",(function(){return mr})),n.d(t,"g",(function(){return br})),n.d(t,"d",(function(){return jr})),n.d(t,"r",(function(){return Rr})),n.d(t,"e",(function(){return xr})),n.d(t,"h",(function(){return zr}));n(41),n(20),n(42),n(29),n(48),n(17),n(232);var r,o=n(131),a=(n(278),n(62)),i=n(0),c=n.n(i),s=n(8),l=n(884),u=n(15),p=n(1),d=n(11),h=n(32),f=n(352),m=n.n(f);function y(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,a=void 0;try{for(var i,c=e[Symbol.iterator]();!(r=(i=c.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){o=!0,a=e}finally{try{r||null==c.return||c.return()}finally{if(o)throw a}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return g(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return g(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function g(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function b(e,t,n,r,o,a,i){try{var c=e[a](i),s=c.value}catch(e){return void n(e)}c.done?t(s):Promise.resolve(s).then(r,o)}!function(e){e.USERNAME="USERNAME",e.ACCOUNT="ACCOUNT",e.OPERATION_LOG="OPERATION_LOG",e.RULE_CENTER="RULE_CENTER",e.LOGIN_OUT="LOGIN_OUT"}(r||(r={}));const O=e=>{const t=e.isBrand,n=Object(p.j)(["username"]).username,i=()=>{const e=Object(p.j)(["keeper"]).keeper;if(!e)return void(location.href=location.origin+"/login");const n=(e||{}).chainKeeper;t?s.a.go("app.chainshop.brand-my-account"):n?s.a.go("app.chainshop.userinfo"):s.a.go("app.shop.userinfo")},f=function(){var e,t=(e=function*(){y(yield Object(p.t)(u.d.loginOut),2)[1]||(p.b.isClient&&p.a.removeCurrentProfile(),Object(d.c)("to_login","initiative"),location.href=location.origin+"/login")},function(){var t=this,n=arguments;return new Promise((function(r,o){var a=e.apply(t,n);function i(e){b(a,r,o,i,c,"next",e)}function c(e){b(a,r,o,i,c,"throw",e)}i(void 0)}))});return function(){return t.apply(this,arguments)}}(),g=c.a.createElement(a.a,{onClick:({key:e})=>{const t=Object(p.j)(["isChain"]).isChain;switch(h.a.log("MY_ACCOUNT_CLK",{action_type:e}),e){case r.USERNAME:case r.ACCOUNT:i();break;case r.OPERATION_LOG:t?s.a.go("app.chainshop.log"):s.a.go("app.shop.log");break;case r.RULE_CENTER:t?s.a.go("app.chainshop.ruleCenter"):s.a.go("app.shop.ruleCenter");break;case r.LOGIN_OUT:f();break;default:throw new Error("key is not fond")}}},c.a.createElement(a.a.Item,{className:m.a.userName,key:r.USERNAME},n),c.a.createElement(a.a.Divider,null),c.a.createElement(a.a.Item,{key:r.ACCOUNT},"我的账号"),!t&&c.a.createElement(c.a.Fragment,null,c.a.createElement(a.a.Item,{key:r.OPERATION_LOG},"操作日志"),c.a.createElement(a.a.Item,{key:r.RULE_CENTER},"规则中心")),c.a.createElement(a.a.Divider,null),c.a.createElement(a.a.Item,{key:r.LOGIN_OUT},"退出登录")),O=c.a.createElement("div",{className:m.a.account},c.a.createElement(l.a,null));return c.a.createElement(c.a.Fragment,null,c.a.createElement(o.a,{placement:"bottomCenter",overlay:g,trigger:["click"]},O))};var w=c.a.memo(O,p.g),v=(n(98),n(47)),S=(n(277),n(166)),_=(n(162),n(83)),j=(n(109),n(45)),E=(n(230),n(102)),I=n(46),A=n.n(I),P=n(892),T=n(891),C=n(890),k=n(889),N=n(888),R=(n(363),n(158)),M=(n(412),n(188));function L(e,t,n,r,o,a,i){try{var c=e[a](i),s=c.value}catch(e){return void n(e)}c.done?t(s):Promise.resolve(s).then(r,o)}function D(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,a=void 0;try{for(var i,c=e[Symbol.iterator]();!(r=(i=c.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){o=!0,a=e}finally{try{r||null==c.return||c.return()}finally{if(o)throw a}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return U(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return U(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function U(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}const x=M.a.Group,H=R.a.TabPane,B={needOpenModalText:"",needDescText:"",list:[{index:1,name:"",items:[{name:""}]},{index:1,name:"",items:[{name:""}]}]};var G=({visible:e,onOK:t,onCancel:n,onClose:r})=>{const o=D(Object(i.useState)(Q.SHOP_REASON),2),a=o[0],s=o[1],l=D(Object(i.useState)(B),2),d=l[0],h=l[1],f=D(Object(i.useState)(""),2),m=f[0],y=f[1],g=D(Object(i.useState)(""),2),b=g[0],O=g[1],w=d.needOpenModalText,S=d.list;Object(i.useEffect)(()=>{(function(){var e,t=(e=function*(){const e=D(yield Object(p.t)(u.a.get,"closeReasonInfo"),2),t=e[0];e[1]||h(t||B)},function(){var t=this,n=arguments;return new Promise((function(r,o){var a=e.apply(t,n);function i(e){L(a,r,o,i,c,"next",e)}function c(e){L(a,r,o,i,c,"throw",e)}i(void 0)}))});return function(){return t.apply(this,arguments)}})()()},[]);const _=c.a.createElement(c.a.Fragment,null,c.a.createElement(v.a,{onClick:n},"暂不关店"),c.a.createElement(v.a,{type:"primary",onClick:()=>{const e=a===Q.SHOP_REASON?m:b;t(e,a,e===w)},disabled:!b&&!m},"确认关店")),j={display:"block",height:"30px",lineHeight:"30px"};return c.a.createElement(c.a.Fragment,null,c.a.createElement(E.a,{title:"请如实选择关店原因",footer:_,visible:e,onCancel:r},d&&c.a.createElement(R.a,{activeKey:String(a),onChange:e=>s(e)},c.a.createElement(H,{tab:S[0].name,key:String(Q.SHOP_REASON)},c.a.createElement(x,{value:m,onChange:e=>y(e.target.value)},S[0].items.map(e=>c.a.createElement(M.a,{style:j,value:e.name,key:e.name},e.name)))),c.a.createElement(H,{tab:S[1].name,key:String(Q.LOGISTICS_REASON)},c.a.createElement(x,{value:b,onChange:e=>O(e.target.value)},S[1].items.map(e=>c.a.createElement(M.a,{style:j,value:e.name,key:e.name},e.name)))))))},q=n(73),F=n.n(q);function W(e,t,n,r,o,a,i){try{var c=e[a](i),s=c.value}catch(e){return void n(e)}c.done?t(s):Promise.resolve(s).then(r,o)}function V(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var a=e.apply(t,n);function i(e){W(a,r,o,i,c,"next",e)}function c(e){W(a,r,o,i,c,"throw",e)}i(void 0)}))}}function K(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,a=void 0;try{for(var i,c=e[Symbol.iterator]();!(r=(i=c.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){o=!0,a=e}finally{try{r||null==c.return||c.return()}finally{if(o)throw a}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Y(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Y(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Y(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}const z=E.a.confirm;let Q;!function(e){e[e.SHOP_REASON=1]="SHOP_REASON",e[e.LOGISTICS_REASON=2]="LOGISTICS_REASON"}(Q||(Q={}));const $=({changeShopState:e,shopInfo:t,loading:n})=>{const r=K(Object(i.useState)(!0),2),a=r[0],l=r[1],d=K(Object(i.useState)(!1),2),f=d[0],m=d[1],y=K(Object(i.useState)(!1),2),g=y[0],b=y[1],O=K(Object(i.useState)(),2),w=O[0],I=O[1],R=K(Object(i.useState)(),2),M=R[0],L=R[1],D=K(Object(i.useState)([]),2),U=D[0],x=D[1],H=K(Object(i.useState)([]),2),B=H[0],q=H[1],W=K(Object(i.useState)(),2),Y=W[0],Q=W[1],$=K(Object(i.useState)(),2),J=$[0],X=$[1],Z=K(Object(i.useState)(!1),2),ee=Z[0],te=Z[1],ne=K(Object(i.useState)(!1),2),re=ne[0],oe=ne[1],ae=K(Object(i.useState)(!1),2),ie=ae[0],ce=ae[1],se=K(Object(i.useState)("closed"),2),le=se[0],ue=se[1],pe=K(Object(i.useState)(!1),2),de=pe[0],he=pe[1],fe=K(Object(i.useState)(!1),2),me=fe[0],ye=fe[1],ge=K(Object(i.useState)(!1),2),be=ge[0],Oe=ge[1],we=K(Object(i.useState)(!1),2),ve=we[0],Se=we[1],_e=K(Object(i.useState)("尊敬的饿了么商户，您的店铺已被调整至无效状态，无法接收外卖订单。如需帮助请联系市场经理，若无市场经理请联系饿了么客服。您可搜索关注微信公众号“饿了么培训学习中心”，学习更多经营之道。"),2),je=_e[0],Ee=_e[1],Ie=Object(i.useRef)(null),Ae=Object(i.useRef)(!1),Pe=Object(i.useRef)(!0);Pe.current=null==n||n,Object(i.useEffect)(()=>{if(Pe.current&&!Ae.current&&!t)return;Ae.current=!0;const e=e=>{(e.path||[]).includes(Ie.current)||b(!1)};document.addEventListener("click",e);const n=()=>{Ce()};if(window._OSAdaptor.on("shop.closed",n),s.a.on("socket.shop.open",n),s.a.on("socket.shop.closed",n),t&&Ce(),t){const e=t.detail||{};Se(!A()(e,"valid",!0)),Ee(A()(e,"invalidMsg")),Te(t)}return()=>{s.a.off("socket.shop.open",n),s.a.off("socket.shop.closed",n),document.removeEventListener("click",e),window._OSAdaptor.off("shop.closed",n)}},[t]),Object(i.useEffect)(()=>{const e=({visible:e})=>{b(e),e&&ke()};return s.a.on("shop.toggleState",e),()=>{s.a.off("shop.toggleState",e)}},[]);const Te=function(){var e=V((function*(e){const t=e.basis,n=t.hasEverOpen,r=t.createdRecently;if(!n&&r){const e=K(yield Object(p.t)(u.k.getOpenShopGuide,{}),2),t=e[0].leftSteps;if(e[1])return;0===t?(l(!0),m(!0)):l(!1)}}));return function(t){return e.apply(this,arguments)}}(),Ce=Object(i.useCallback)(V((function*(){const e=K(yield Object(p.t)(u.k.queryShopStatusView,{}),2),t=e[0];if(!e[1]){const e=t||{},n=e.showMainStatus,r=e.showMinorStatus;I(n),L(r)}})),[]),ke=function(){var e=V((function*(){te(!0);const e=K(yield Object(p.t)(u.k.queryShopStatusViewDetail,{}),2),t=e[0];if(!e[1]){const e=t||{},n=e.shopStatusClickDetail,r=e.shopStatusView;I(A()(r,"showMainStatus")),L(A()(r,"showMinorStatus")),x(A()(n,"businessTime",[])),q(A()(n,"statusDetailContent",[])),Q({status:A()(n,"operationDetailsFroPc.openStatus",!1),msg:A()(n,"operationDetailsFroPc.openStatusMsg","正常营业"),operations:[A()(n,"operationDetailsFroPc.openOperation")]}),X({status:A()(n,"operationDetailsFroPc.closeStatus"),msg:A()(n,"operationDetailsFroPc.closeStatusMsg"),operations:[A()(n,"operationDetailsFroPc.delayCloseOperation"),A()(n,"operationDetailsFroPc.closeOperation"),A()(n,"operationDetailsFroPc.vocationOperation")]})}te(!1)}));return function(){return e.apply(this,arguments)}}(),Ne=({code:e,clickConfirmVO:t},n)=>{const r=A()(t||{},"needConfirm",!1);h.a.log("SHOP_STATUS_SWITCHER",{status:n}),r?z({title:"请确认操作",icon:c.a.createElement(P.a,null),content:""+A()(t,"confirmMsg",""),okText:"确认",cancelText:"取消",onOk(){Re(e)},onCancel(){}}):Re(e)},Re=e=>{switch(Number(e)){case 1:Me();break;case 2:Le("delay");break;case 3:Le("closed");break;case 4:Oe(!0)}},Me=function(){var t=V((function*(){oe(!0);const t=K(yield Object(p.t)(u.k.openShop),2)[1];oe(!1),t||(j.b.success("开启营业成功"),Ce(),e&&e(),ie&&(s.a.go("shop.dashboard.toIndex"),ce(!1)))}));return function(){return t.apply(this,arguments)}}(),Le=e=>{he(!0),ue(e)},De=function(){var e=V((function*(e,t,n){if(he(!1),me)return;ye(!0),oe(!0);const r=K(yield Object(p.t)(u.k.countOrder),2),o=r[0],a=r[1];oe(!1),a||0===o?"delay"===le?He(e,t,n):"closed"===le&&xe(e,t,n):(z({title:"请确认操作",icon:c.a.createElement(P.a,null),content:`当前有${o}个未处理订单，确认关店？`,okText:"确认",cancelText:"取消",onOk(){"delay"===le?He(e,t,n):"closed"===le&&xe(e,t,n)},onCancel(){}}),ye(!1))}));return function(t,n,r){return e.apply(this,arguments)}}(),Ue=Object(i.useCallback)(()=>{Oe(!1)},[]),xe=function(){var t=V((function*(t,n,r){oe(!0);const o=K(yield Object(p.t)(u.k.updateShopBusyLevel,{busyLevel:"closed",closeReason:t,reasonType:n}),2)[1];oe(!1),o?ye(!1):(j.b.success("关店成功"),Ce(),ye(!1),e&&e(),r&&Be())}));return function(e,n,r){return t.apply(this,arguments)}}(),He=function(){var e=V((function*(e,t,n){oe(!0);const r=K(yield Object(p.t)(u.k.delayCloseShop,{closeReason:e,reasonType:t}),2)[1];oe(!1),r?ye(!1):(j.b.success("延时关店成功"),Ce(),ye(!1),n&&Be())}));return function(t,n,r){return e.apply(this,arguments)}}(),Be=()=>{s.a.go("app.shop.feedback",{params:"createTicket"})},Ge=c.a.createElement("div",{className:F.a.dropContent},c.a.createElement(_.a,{spinning:ee},c.a.createElement("div",{className:F.a.businessHours},c.a.createElement("div",null,"营业时间：",(qe=U,c.a.createElement(c.a.Fragment,null,1===qe.length&&c.a.createElement("span",null,qe.join("、")),2===qe.length&&c.a.createElement("div",null,qe.join("、")),3===qe.length&&c.a.createElement(c.a.Fragment,null,c.a.createElement("span",null,qe.slice(0,1).join("")),c.a.createElement("div",null,qe.slice(1).join("、")))))),c.a.createElement("div",{className:F.a.changeText,onClick:()=>{h.a.log("SHOP_STATUS_SWITCHER",{status:"修改设置"}),b(!1),s.a.go("app.shop.shop-info",{pageType:"shop-business"})}},"修改",c.a.createElement(T.a,{className:F.a.icon}))),c.a.createElement("ul",{className:F.a.tips},B.map((e,t)=>c.a.createElement("li",{key:t.toString()},c.a.createElement(C.a,{style:{marginRight:"4px"}}),c.a.createElement("span",{dangerouslySetInnerHTML:{__html:e}})))),Y&&c.a.createElement("div",null,c.a.createElement("div",{className:F.a.biz,style:{color:Y.status?"#2d2f33":"rgb(144, 147, 153)"}},c.a.createElement(k.a,{style:{marginRight:"4px",color:Y.status?"#52c41a":"#DCDFE6"}}),c.a.createElement("span",null,Y.msg)),c.a.createElement("ul",{className:F.a.opener},Y.operations.map((e,t)=>c.a.createElement("li",{key:t.toString(),className:e.setAsh?F.a.disabled:"",onClick:()=>Ne(e,e.operationTitle)},c.a.createElement("p",null,e.operationTitle),c.a.createElement("p",null,e.operationRemark))))),J&&c.a.createElement("div",null,c.a.createElement("div",{className:F.a.biz,style:{color:J.status?"#2d2f33":"rgb(144, 147, 153)"}},c.a.createElement(k.a,{style:{marginRight:"4px",color:""+(J.status?"#52c41a":"#DCDFE6")}}),c.a.createElement("span",null,J.msg)),c.a.createElement("ul",{className:F.a.opener},J.operations.map((e,t)=>c.a.createElement("li",{key:t.toString(),className:e.setAsh?F.a.disabled:"",onClick:()=>Ne(e,e.operationTitle)},c.a.createElement("p",null,e.operationTitle),c.a.createElement("p",null,e.operationRemark)))))));var qe;return c.a.createElement(c.a.Fragment,null,w&&a&&c.a.createElement(c.a.Fragment,null,c.a.createElement(o.a,{placement:"bottomCenter",trigger:["click"],visible:g,overlay:Ge},c.a.createElement(S.a,{visible:f,placement:"bottom",content:"点这里更改营业状态，开启营业吧"},c.a.createElement("div",{ref:Ie,className:F.a.shopState,onClick:()=>{b(!g),!g&&ke(),f&&m(!1)}},c.a.createElement(_.a,{spinning:re,size:"small"},c.a.createElement("span",{className:F.a.mainStatus,style:{color:w.statusRemarkColor}},w.statusRemark),M&&c.a.createElement("span",{className:F.a.minorStatuses,style:{color:M.statusRemarkColor,backgroundColor:M.statusBgColor}},M.statusRemark),c.a.createElement(N.a,{className:F.a.icon})))))),de&&c.a.createElement(G,{visible:de,onOK:De,onCancel:()=>he(!1),onClose:()=>he(!1)}),be&&c.a.createElement(Rr,{visible:be,onChange:Ce,onClose:Ue}),c.a.createElement(E.a,{title:"您的店铺已被置为无效状态",footer:c.a.createElement(v.a,{type:"primary",onClick:()=>Se(!1)},"确认"),visible:ve,onCancel:()=>Se(!1)},c.a.createElement("span",{dangerouslySetInnerHTML:{__html:je}})))};var J=c.a.memo($,p.g),X=(n(316),n(139)),Z=n(887),ee=n(68),te=n(474),ne=n.n(te);function re(e,t,n,r,o,a,i){try{var c=e[a](i),s=c.value}catch(e){return void n(e)}c.done?t(s):Promise.resolve(s).then(r,o)}function oe(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,a=void 0;try{for(var i,c=e[Symbol.iterator]();!(r=(i=c.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){o=!0,a=e}finally{try{r||null==c.return||c.return()}finally{if(o)throw a}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return ae(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ae(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ae(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}const ie=()=>{const e=oe(Object(i.useState)(0),2),t=e[0],n=e[1];Object(i.useEffect)(()=>{const e=function(){var e,t=(e=function*(){const e=oe(yield Object(p.t)(ee.a.getNoticeNum),2),t=e[0],r=void 0===t?0:t,o=e[1];o?j.b.error(null==o?void 0:o.message):n(r)},function(){var t=this,n=arguments;return new Promise((function(r,o){var a=e.apply(t,n);function i(e){re(a,r,o,i,c,"next",e)}function c(e){re(a,r,o,i,c,"throw",e)}i(void 0)}))});return function(){return t.apply(this,arguments)}}(),t=setTimeout(()=>{e()},3e4),r=ee.a.onReaded(t=>{console.log("read notice",t),e()});return()=>{r(),clearTimeout(t)}},[]);return c.a.createElement("div",{onClick:()=>{h.a.log("smallBellClk");const e=Object(p.j)(["isChain"]).isChain?"app.chainshop.notice":"app.shop.notice";s.a.go(e)},className:ne.a.notice},c.a.createElement(X.a,{dot:!!t},c.a.createElement(Z.a,null)))};var ce=c.a.memo(ie,p.g),se=n(886),le=n(885),ue=n(26),pe=n(190),de=n.n(pe);function he(e,t,n,r,o,a,i){try{var c=e[a](i),s=c.value}catch(e){return void n(e)}c.done?t(s):Promise.resolve(s).then(r,o)}function fe(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,a=void 0;try{for(var i,c=e[Symbol.iterator]();!(r=(i=c.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){o=!0,a=e}finally{try{r||null==c.return||c.return()}finally{if(o)throw a}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return me(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return me(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function me(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}const ye=()=>{const e=fe(Object(i.useState)("已连接"),2),t=e[0],n=e[1],r=fe(Object(i.useState)(!1),2),l=r[0],u=r[1],f=fe(Object(i.useState)(!1),2),m=f[0],y=f[1],g=e=>{Object(d.c)("melody_print",e.message,e)},b=function(){var e,t=(e=function*(){try{const e=yield p.d.getPrinters();g({message:"window_print_list",printers:e});const t=e.filter(({isEnabled:e})=>!0===e);if(t.length>0&&t.forEach(({id:e})=>{p.d.connectPrinter(e)}),0===t.length&&!m){y(!0);const e=p.d.getConnectedPrinters();e.forEach((e,t)=>{window.setTimeout(()=>{p.d.enablePrinter(e)},1e3*(t+1))}),g({message:"local_print_list",printers:e})}const r=t.length>0;u(r),n(r?"已连接":"未连接"),0===t.length?ue.b.activate(ue.a.printerDisconnect):ue.b.kill(ue.a.printerDisconnect)}catch(e){g({message:"print_error",error:e.message})}},function(){var t=this,n=arguments;return new Promise((function(r,o){var a=e.apply(t,n);function i(e){he(a,r,o,i,c,"next",e)}function c(e){he(a,r,o,i,c,"throw",e)}i(void 0)}))});return function(){return t.apply(this,arguments)}}();Object(i.useEffect)(()=>(window.chat.on("pc.print.printersHasChanged",()=>{b(),window._OSAdaptor.broadcast("printer.connectionChange")}),window.chat.on("pc.print.openPrinterSettingDialog",()=>{s.a.go("app.shop.setting",{path:"print"})}),b(),()=>{window.chat.remove("pc.print.printersHasChanged"),window.chat.remove("pc.print.openPrinterSettingDialog")}),[]);const O=c.a.createElement(a.a,{onClick:({key:e})=>{switch(h.a.log("PRINT_CLK",{action_type:e}),e){case"print":case"tip":s.a.go("app.shop.setting",{path:"print"});break;case"help":s.a.go("app.shop.setting",{path:"help"})}}},c.a.createElement(a.a.Item,{key:"tip"},l?c.a.createElement(k.a,{style:{color:"#52c41a"}}):c.a.createElement(se.a,{style:{color:"#ff4d4f"}}),c.a.createElement("span",{className:l?de.a.connected:de.a.noConnected,style:{display:"inline-block",marginLeft:"2px"}},"打印机",t)),!l&&c.a.createElement(a.a.Divider,null),!l&&c.a.createElement(a.a.Item,{key:"print"},"打印机设置"),!l&&c.a.createElement(a.a.Item,{key:"help"},"打印机问题帮助"));return c.a.createElement(c.a.Fragment,null,c.a.createElement(o.a,{overlay:O,trigger:["click"]},c.a.createElement("div",{className:de.a.printState},c.a.createElement(le.a,{style:{color:l?"#52c41a":"#ff4d4f"}}),c.a.createElement("span",{className:l?de.a.connected:de.a.noConnected},t))))};var ge=c.a.memo(ye,p.g),be=(n(682),n(19)),Oe=(n(684),n(494)),we=(n(229),n(121)),ve=n(57),Se=n(84),_e=n(138);function je(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return Ee(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ee(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,c=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return i=e.done,e},e:function(e){c=!0,a=e},f:function(){try{i||null==n.return||n.return()}finally{if(c)throw a}}}}function Ee(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}const Ie=(e,t)=>{let n=!1;const r=[],o=(e=[],t)=>{for(let a=0;a<e.length;a++){const i=e[a];if(!n){if(a>0&&r.pop(),r.push(i.value),+i.value==+t)return void(n=!0);{const e=i.children;e&&o(e,t)}}}n||r.pop()};return o(e,t),r};var Ae=n(140),Pe=n.n(Ae);function Te(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,a=void 0;try{for(var i,c=e[Symbol.iterator]();!(r=(i=c.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){o=!0,a=e}finally{try{r||null==c.return||c.return()}finally{if(o)throw a}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Ce(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ce(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ce(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}const ke=()=>Object(p.j)(["shopId"]).shopId,Ne=e=>(e||"").replace(/[(（]/,"(").replace(/[)）]/,")"),Re=({changeShop:e,treeData:t=[],setLoading:n})=>{const r=Object(p.j)(["shopName","loginShopName","loginShopId"]),a=r.shopName,l=r.loginShopName,u=r.loginShopId,f=Te(Object(i.useState)([]),2),m=f[0],y=f[1],g=Te(Object(i.useState)([]),2),b=g[0],O=g[1],w=Te(Object(i.useState)([]),2),v=w[0],S=w[1],_=Te(Object(i.useState)(a||l),2),E=_[0],I=_[1],A=Object(i.useRef)(ke()||u),P=Te(Object(i.useState)(!1),2),T=P[0],C=P[1],k=Te(Object(i.useState)([]),2),R=k[0],M=k[1],L=Te(Object(i.useState)(""),2),D=L[0],U=L[1],x=Object(i.useRef)(null),H=Object(i.useRef)(null),B=Object(i.useRef)(null),G=Object(ve.useParams)(),q=0!==t.length,F=Object(i.useRef)(!1),W=[{label:"未搜索到店铺",value:"0",parentId:0,disabled:!0,restaurantType:"ROOT",children:[]}];Object(i.useEffect)(()=>{const e=e=>{const t=e.path||[];t.includes(x.current)||t.includes(B.current)||C(!1)};if(G.id){if(document.addEventListener("click",e),"undefined"===localStorage.getItem("shopName")&&localStorage.removeItem("shopName"),t[0]){const e=Object(p.f)(t[0]),n=V(e),r=function(e){const t=Object(p.f)(e),n=[];for(;t.length>0;){const e=t.shift();e&&"LEAF"===e.restaurantType&&n.push(e);const a=Object.prototype.hasOwnProperty.call(e,"children");if(e&&a&&e.children&&e.children.length>0){var r,o=je(e.children);try{for(o.s();!(r=o.n()).done;){const e=r.value;t.push(e)}}catch(e){o.e(e)}finally{o.f()}}}return n}(n);S(n),O(n),y(r);const o=Ie(n,G.id||"");if(o.length){const e=Number(G.id)===Number(u),t=r.find(e=>Number(e.value)===Number(G.id)),n=e?l:t&&t.label,a=e?Number(u):t&&t.value;Object(Se.c)({shopId:Number(G.id),shopName:n}),M(o),A.current=Number(a),I(n)}else M(Ie(n,ke()?String(ke()):""))}return()=>{document.removeEventListener("click",e)}}},[t,G.id]);const V=e=>{if(!e)return[];const t=e;if(t.childList){const e="LEAF"===t.restaurantType;var n;if(!e)t.disabled=0===(null===(n=t.childList)||void 0===n?void 0:n.length),t.children=t.childList;t.label=t.name,t.value=t.id,t.selectable=e,t.isLeaf=e,delete t.childList,delete t.id,delete t.name,t.children&&t.children.length&&t.children.forEach(e=>{V(e)})}return[{restaurantType:t.restaurantType,value:t.value,label:"全部",parentId:t.parentId},...t.children||[]]},K=(e,t=(ke()?String(ke()):""))=>{U(e);const n=e.trim().toLocaleLowerCase();if(!n)return O(v),void M(Ie(v,t));const r=m.filter(({label:e=""})=>Ne(e.toLocaleLowerCase()).includes(Ne(n))),o=r.length?r:W;O(o)};Object(i.useEffect)(()=>{const e=e=>{F.current=e.fetching};return s.a.on("fetchApp",e),()=>{s.a.off("fetchApp",e)}},[]);const Y=c.a.createElement("div",{id:"dropContentEl",ref:x,className:Pe.a.overlayContent},c.a.createElement(we.a,{value:D,placeholder:"搜索店铺",allowClear:!0,onChange:e=>K(e.target.value),style:{width:"200px"}}),c.a.createElement(be.b,{direction:"rtl"},c.a.createElement(Oe.a,{ref:H,popupClassName:"treeDataPopup",value:R,expandTrigger:"hover",changeOnSelect:!1,getPopupContainer:()=>document.getElementById("dropContentEl"),popupVisible:!0,options:b,onChange:(t,r)=>{const o=r.pop(),i=o.label,c=o.value,s=Number(c)===Number(u),p=s?l:i,d=s?Number(u):c;p!==a||A.current!==d?(h.a.log("SHOP_SWITCHER",{action_type:s?"全部":"子级"}),Object(Se.c)({shopId:c,shopName:p}),A.current=d,I(p),C(!1),setTimeout(()=>{Object(_e.a)("CHANGE_SHOP"),n(!0)}),setTimeout(()=>{D&&K("",c),e&&e()},500)):j.b.info("当前店铺已经是"+p)}},c.a.createElement("div",{style:{position:"relative",top:"-3px",height:"0px",opacity:0}}))));return c.a.createElement("div",{id:"shopSwitcher",className:`${Pe.a.shopSwitcher} ${Pe.a.right}`,ref:B},q?c.a.createElement(c.a.Fragment,null,c.a.createElement(o.a,{getPopupContainer:()=>document.getElementById("shopSwitcher"),visible:T,overlay:Y,trigger:["click"],placement:"bottomCenter"},c.a.createElement("div",{onClick:()=>{if(F.current)return Object(d.c)("fos","loading_app",{scene:"switch"}),void j.b.warning("您的点击太快了, 稍后几秒中再试...");h.a.log("SHOP_SWITCHER",{action_type:T?"收起":"展开"}),C(!T)},className:Pe.a["clk-area"]},c.a.createElement("span",{className:Pe.a.shopName},E||"连锁店"),c.a.createElement(N.a,{className:Pe.a.icon})))):c.a.createElement("span",{className:Pe.a["clk-area"]},E||"店铺名"))};var Me=c.a.memo(Re,p.g),Le=n(160),De=n.n(Le);const Ue=({currentId:e,selfId:t,title:n,subTitle:r,imageUrl:o,isUsing:a,onChange:i})=>{const s=e===t;return c.a.createElement("div",{className:De.a.card,onClick:()=>{a||i(t)}},c.a.createElement("img",{className:De.a.img,src:o,alt:""}),c.a.createElement("div",{className:De.a.content},c.a.createElement("div",{className:De.a.info},c.a.createElement("span",null,n),c.a.createElement("span",null,r)),c.a.createElement("div",{className:De.a.cardRadio},a?c.a.createElement("span",{className:De.a.logined},"已登录"):c.a.createElement(M.a,{checked:s}))))};var xe=c.a.memo(Ue,p.g),He=(n(740),n(496)),Be=n(877),Ge=n(114),qe=n(274),Fe=n.n(qe);function We(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,a=void 0;try{for(var i,c=e[Symbol.iterator]();!(r=(i=c.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){o=!0,a=e}finally{try{r||null==c.return||c.return()}finally{if(o)throw a}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Ve(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ve(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ve(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}const Ke=()=>{const e=We(Object(i.useState)(!1),2),t=e[0],n=e[1],r=We(Object(i.useState)(""),2),o=r[0],a=r[1];Object(i.useEffect)(()=>(window._OSAdaptor.on("assistant.sync",s),()=>{window._OSAdaptor.off("assistant.sync",s)}),[]);const s=()=>{h.a.log("HELP_ICON_CLK"),localStorage.setItem("__ml_showself_iframe_init__","inited"),l(),n(!0)},l=()=>{const e=""+Ge.c;a(e)},u=c.a.createElement("div",{className:Fe.a.drawerTitle},c.a.createElement("span",null,"帮助与反馈"));return c.a.createElement(c.a.Fragment,null,c.a.createElement("div",{className:Fe.a.shopHelp},c.a.createElement(Be.a,{onClick:s}),c.a.createElement(He.a,{width:"400px",title:u,placement:"right",visible:t,destroyOnClose:!0,closable:!0,bodyStyle:{width:"100%",height:"100%",padding:"10px",position:"relative"},onClose:()=>n(!1)},o&&c.a.createElement("iframe",{className:Fe.a.helpIframe,src:o}))))};var Ye=c.a.memo(Ke,p.g),ze=n(344),Qe=n(227),$e=n.n(Qe);const Je=({changeShop:e,changeShopState:t,treeData:n,shopInfo:r,setEntryTabKey:o,crmEntryShow:a,entryTabKey:s,isBrand:l,isChain:u,setLoading:d,loading:f})=>{const m=p.b.isClient;return Object(i.useEffect)(()=>{a&&h.a.log("CRM_TAB",{},"EXP")},[a]),c.a.createElement("div",{className:$e.a.toolBarWrapper},c.a.createElement("div",{className:$e.a.leftBlock},c.a.createElement("div",{className:$e.a.tabSwitch},c.a.createElement(R.a,{tabBarStyle:{margin:0},onChange:o,defaultActiveKey:s},c.a.createElement(R.a.TabPane,{tab:"饿了么商家版",key:ze.a.NAPOS}),a&&c.a.createElement(R.a.TabPane,{tab:"CRM 渠道",key:ze.a.CRM})))),l?c.a.createElement(w,{isBrand:!0}):c.a.createElement("div",{className:$e.a.rightBlock},u?c.a.createElement(jn,null):c.a.createElement(un,null),!l&&c.a.createElement(Me,{treeData:n,changeShop:e,setLoading:d}),!u&&!l&&c.a.createElement(J,{changeShopState:t,shopInfo:r,loading:f}),!u&&m&&c.a.createElement(ge,null),c.a.createElement(ce,null),c.a.createElement(Ye,null),c.a.createElement(w,null)))};var Xe=c.a.memo(Je,p.g),Ze=(n(55),n(332),n(79)),et=n(893),tt=(n(867),n(493)),nt=n(482),rt=n.n(nt);n(832);function ot(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,a=void 0;try{for(var i,c=e[Symbol.iterator]();!(r=(i=c.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){o=!0,a=e}finally{try{r||null==c.return||c.return()}finally{if(o)throw a}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return at(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return at(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function at(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}const it=e=>{const t=e.menus,n=e.show,r=e.onClick,o=e.onFocus,a=e.onBlur,s=ot(Object(i.useState)([]),2),l=s[0],u=s[1],p=ot(Object(i.useState)(""),2),d=p[0],f=p[1],m=Object(i.useCallback)(()=>{h.a.log("MENU_SEARCH_FOCUS"),o&&o()},[o]);return c.a.createElement("div",{className:rt.a["menu-search-wrap"],style:{marginTop:n?"20px":void 0}},n?c.a.createElement(tt.a,{value:d,options:l,style:{width:142},placeholder:"搜索菜单",onChange:e=>{e!==d&&(f(e),u(e?t.filter(t=>t.value.includes(e)):[]),h.a.log("MENU_SEARCH_INPUT",{input:e}))},onSelect:(e,t)=>{h.a.log("MENU_SEARCH_CLK",{input:t.value}),r(t.key),a&&a()},onFocus:m,onBlur:a}):c.a.createElement("div",null))};var ct=c.a.memo(it,p.g),st=n(61),lt=n.n(st);function ut(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,a=void 0;try{for(var i,c=e[Symbol.iterator]();!(r=(i=c.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){o=!0,a=e}finally{try{r||null==c.return||c.return()}finally{if(o)throw a}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return pt(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return pt(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function pt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}const dt=()=>window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth;var ht=n(58);const ft=e=>{const t=Number(e);return isNaN(t)?0:t<=99?t:99};function mt(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,a=void 0;try{for(var i,c=e[Symbol.iterator]();!(r=(i=c.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){o=!0,a=e}finally{try{r||null==c.return||c.return()}finally{if(o)throw a}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return yt(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return yt(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function yt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function gt(e,t,n,r,o,a,i){try{var c=e[a](i),s=c.value}catch(e){return void n(e)}c.done?t(s):Promise.resolve(s).then(r,o)}const bt=(e,t)=>{const n=Object(p.i)(e||[],"children",!0).find(e=>e.name===t);return n&&n.parentId},Ot=()=>"BRAND"===Object(p.j)(["shopId"]).shopType;var wt=(e,t)=>{Object(i.useEffect)(()=>{if(Ot())return;const n=({menuName:e,num:n,bubbling:r=!0,noticeType:o="number"})=>{const a=Object(p.i)(t||[],"children",!0).find(t=>t.name===e),i=ft(n);if(a){if(!a.children||!!a.children.length){const e=a.parametersMap["ui-sref"];s.a.emit("os","_update-menu-notice",{key:e,num:i,noticeType:o}),r&&s.a.emit("os","_update-menu-notice",{key:a.parentId,num:i,noticeType:o})}else{const e=a.id;s.a.emit("os","_update-menu-notice",{key:e,num:i,noticeType:o})}}};return s.a.on("update-menu-notice",n),()=>{e&&e(),s.a.off("update-menu-notice",n)}},[t]),vt(()=>{},t),St(()=>{},t),_t(()=>{},t)};const vt=(e,t)=>{Object(i.useEffect)(()=>{if(Ot())return;const n=e=>{const n=Object(p.j)(["isChain"]).isChain,r=bt(t,"订单处理");s.a.emit("os","_update-menu-notice",{key:n?"app.chainshop.order.processing":"app.shop.order.processing",num:e,noticeType:"number"}),s.a.emit("os","_update-menu-notice",{key:r,num:e,noticeType:"number"})};return s.a.on("transferNoticeOrderCount",n),()=>{e&&e(),s.a.off("transferNoticeOrderCount",n)}},[t])},St=(e,t)=>{Object(i.useEffect)(()=>{if(Ot())return;const n=e=>{const n=e.newRatingCount;let r=e.newNegativeCount;r>100&&(r="99+");const o=Object(p.j)(["isChain"]).isChain,a=bt(t,"顾客评价");r?(s.a.emit("os","_update-menu-notice",{key:o?"app.chainshop.comments":"app.shop.comments",num:r,noticeType:"number",cbEventName:"setLastCheckCommentDate"}),s.a.emit("os","_update-menu-notice",{key:o?"app.chainshop.comments":"app.shop.comments",num:0,noticeType:"point",cbEventName:"setLastCheckCommentDate"}),s.a.emit("os","_update-menu-notice",{key:a,num:r,noticeType:"number"})):n&&(s.a.emit("os","_update-menu-notice",{key:o?"app.chainshop.comments":"app.shop.comments",num:1,noticeType:"point",cbEventName:"setLastCheckCommentDate"}),s.a.emit("os","_update-menu-notice",{key:a,num:r,noticeType:"point"}))};(function(){var e,t=(e=function*(){const e=mt(yield Object(p.t)(u.e.getCommentNotice,{}),2),t=e[0];e[1]||n(t)},function(){var t=this,n=arguments;return new Promise((function(r,o){var a=e.apply(t,n);function i(e){gt(a,r,o,i,c,"next",e)}function c(e){gt(a,r,o,i,c,"throw",e)}i(void 0)}))});return function(){return t.apply(this,arguments)}})()();const r=()=>u.e.setLastCheckCommentDate();return s.a.on("setLastCheckCommentDate",r),window._OSAdaptor.on("comment.updateNotice",n),()=>{e&&e(),s.a.off("setLastCheckCommentDate",r),window._OSAdaptor.off("comment.updateNotice",n)}},[t])},_t=(e,t)=>{Object(i.useEffect)(()=>{if(Ot())return;const t=e=>{var t;const n=null==e||null===(t=e.activityApplyCountInfo)||void 0===t?void 0:t.canApplyCount,r=ft(n);s.a.emit("os","_update-menu-notice",{key:"app.chainshop.activity.plantform",num:r,noticeType:"number"})};return s.a.on("PushService.polling",t),()=>{e&&e(),s.a.off("PushService.polling",t)}},[t])};var jt=n(356),Et=n.n(jt);n(835);function It(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function At(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?It(Object(n),!0).forEach((function(t){Pt(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):It(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Pt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Tt(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,a=void 0;try{for(var i,c=e[Symbol.iterator]();!(r=(i=c.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){o=!0,a=e}finally{try{r||null==c.return||c.return()}finally{if(o)throw a}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Ct(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ct(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ct(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}const kt=Object(et.a)({scriptUrl:"https://at.alicdn.com/t/font_1795948_jicitwni3h.js"}),Nt=a.a.Item,Rt=a.a.SubMenu,Mt=e=>{const t=e.data,n=e.onClick,r=Object(ve.useParams)(),o=Tt(Object(i.useState)(""),2),l=o[0],u=o[1],d=Tt(Object(i.useState)(!1),2),f=d[0],m=d[1],y=Tt(Object(i.useState)([]),2),g=y[0],b=y[1],O=Tt(Object(i.useState)(!1),2),w=O[0],v=O[1],S=Tt(Object(i.useState)(!1),2),_=S[0],j=S[1],E=Tt(Object(i.useState)({}),2),I=E[0],A=E[1],P=Tt(Object(i.useState)({}),2),T=P[0],C=P[1],k=function(){const e=ut(Object(i.useState)(dt()),2),t=e[0],n=e[1];return Object(i.useEffect)(()=>{let e=null;const t=()=>{clearTimeout(e),e=setTimeout(()=>n(dt()),300)};return window.addEventListener("resize",t),()=>{window.removeEventListener("resize",t)}},[]),t}(),N=Object(i.useMemo)(()=>Object(p.i)(t).map(({name:e,parametersMap:t})=>({value:e,key:t["ui-sref"]})),[t]),R=Object(i.useMemo)(()=>Object(p.i)(t).map(({name:e,parametersMap:t})=>({name:e,uiSref:t["ui-sref"],appName:t.srefState})),[t]),M=Object(i.useMemo)(()=>Object(p.i)(t).map(({name:e,parametersMap:t,parentId:n})=>({value:e,key:t["ui-sref"],parentId:n})),[t]),L=Object(i.useMemo)(()=>t.filter(e=>{var t;return null==e||null===(t=e.children)||void 0===t?void 0:t.length}).reduce((e,t)=>At(At({},e),{},{[t.id]:t.name}),{}),[t]),D=M.find(e=>e.key===l),U=Object(i.useMemo)(()=>D?[""+(D.parentId||D.key)]:[],[null==D?void 0:D.parentId,null==D?void 0:D.key]);Object(i.useEffect)(()=>{Object(p.i)(t,"children",!0).forEach(e=>{const t=e.parametersMap,n=t.noticeType,r=t.noticeResidentType,o=t.noticeEndTime,a=t["ui-sref"],i=e.children&&e.children.length?e.id:a;q(i,n,r,o)})},[t]),Object(i.useEffect)(()=>{U[0]&&U[0]!==g[0]&&b(U)},[U[0]]),Object(i.useEffect)(()=>{if(!r.id||!r.path)return;const e=Object(ht.g)();if(e.includes("null")||e.includes("undefined"))return;const t=R.find(t=>t.appName===e);t&&u(t.uiSref)},[r.id,r.path,R]);const x=({key:e,num:t,noticeType:n="number",cbEventName:r})=>{"number"===n?A(n=>At(At({},n),{},{[e]:{num:t,cbEventName:r}})):"point"===n&&C(n=>At(At({},n),{},{[e]:{num:t,cbEventName:r}}))};Object(i.useEffect)(()=>(s.a.on("_update-menu-notice",x),()=>{s.a.off("_update-menu-notice",x)}),[]),wt(()=>{},t);const H=Object(i.useCallback)(({key:e})=>{u(e);const t=R.find(t=>t.appName===e);n(e,null==t?void 0:t.name),I[e]&&I[e].cbEventName&&s.a.emit("os",I[e].cbEventName),T[e]&&T[e].cbEventName&&s.a.emit("os",T[e].cbEventName)},[R,I,T]),B=()=>{w&&!_&&m(!1)},G=()=>{w&&!_&&m(!0)},q=(e,t,n,r)=>{if("ALWAYS"!==n)return;if(!r)return;const o="text"===t||"point"===t,a=p.s.getItem("menuNotice",{local:o});if(a?Number(a[e]):0)return;lt()().isAfter(r)?p.s.setItem("menuNotice",At(At({},a),{},{[e]:1}),{local:o}):p.s.setItem("menuNotice",At(At({},a),{},{[e]:Date.now()}),{local:o})},F=(e,t,n,r)=>{if(r){if(lt()().isSameOrAfter(r))return!1}if("MESSAGE"===n||I[e]||T[e])return!!I[e]||!!T[e];if("ONCE"===n){const n=p.s.getItem("menuNotice",{local:"text"===t||"point"===t});return!n||!n[e]}if("ALWAYS"===n){const n=p.s.getItem("menuNotice",{local:"text"===t||"point"===t}),r=n?Number(n[e]):0;return!r||lt()().isBefore(r+6048e5)}return!1},W=(e,t,n)=>{if("ONCE"===n){const n=p.s.getItem("menuNotice",{local:"text"===t||"point"===t});if(n&&n[e])return;if(n&&!n[e])return void p.s.setItem("menuNotice",At(At({},n),{},{[e]:Date.now()}),{local:"text"===t||"point"===t});p.s.setItem("menuNotice",{[e]:Date.now()},{local:"text"===t||"point"===t})}else"MESSAGE"===n&&p.s.removeItem("menuNotice-"+e)},V=e=>{const t=L[e];h.a.log("MENU_ITEM",{menu_name:t})},K=Object(i.useCallback)(e=>{e.length?1===e.length?(b(e),V(e[0])):(b(e.slice(-1)),V(e.slice(-1)[0])):b([])},[]),Y=Object(i.useCallback)(()=>j(!0),[]),z=Object(i.useCallback)(()=>j(!1),[]);Object(i.useEffect)(()=>{if(!w)return;const e=document.querySelector(".napos-menu-container");return e&&e.addEventListener("mouseenter",B),e&&e.addEventListener("mouseleave",G),()=>{e&&e.removeEventListener("mouseenter",B),e&&e.removeEventListener("mouseleave",G)}},[w]),Object(i.useEffect)(()=>{const e=k<=1280;w!==e&&(m(e),v(e))},[k]);const Q=w&&f&&!_,$=Object(i.useMemo)(()=>[l],[l]);return c.a.createElement("div",{className:`${Et.a.container} napos-menu-container ${(!f||_)&&"showSearch"}`},c.a.createElement("div",{className:"iframe-mask",style:{opacity:w&&!f?1:0}}),c.a.createElement(ct,{show:!f||_,menus:N,onClick:n,onFocus:Y,onBlur:z}),c.a.createElement(a.a,{className:Et.a["napos-navmenu"],inlineIndent:30,mode:"inline",inlineCollapsed:Q,defaultSelectedKeys:$,selectedKeys:$,defaultOpenKeys:U,openKeys:g,onClick:H,onOpenChange:K},t.map(e=>{const t=e.parametersMap,n=t.noticeType,r=t.noticeResidentType,o=t.noticeEndTime,a=t.noticeText,i=void 0===a?"新":a;if(e.children&&e.children.length){var s,l,u,p,d;const t=F(e.id,n,r,o),a=t&&"text"===n,h=t&&("point"===n||(null===(s=T[e.id])||void 0===s?void 0:s.num)),f=t&&"number"===n&&(null===(l=I[e.id])||void 0===l?void 0:l.num)>0;return c.a.createElement(Rt,{icon:c.a.createElement(c.a.Fragment,null,Q&&a&&c.a.createElement(X.a,{text:i,color:"#ff4d4f",offset:[0,-6]},c.a.createElement(kt,{type:"icon"+e.icon})),Q&&h&&c.a.createElement(X.a,{dot:!0,offset:[0,6]},c.a.createElement(kt,{type:"icon"+e.icon})),Q&&f&&c.a.createElement(X.a,{count:f&&(null===(u=I[e.id])||void 0===u?void 0:u.num),className:"badge-num"},c.a.createElement(kt,{type:"icon"+e.icon})),(!Q||Q&&!a&&!h&&!f)&&c.a.createElement(kt,{type:"icon"+e.icon})),key:e.id,title:!Q&&c.a.createElement("span",{onClick:()=>W(e.id,n,r)},c.a.createElement("span",null,null===(p=e.name)||void 0===p?void 0:p.replace(/_/g,"")),a&&c.a.createElement(Ze.a,{color:"#fee"},i),h&&c.a.createElement(Ze.a,{className:"dot",color:"#ff4d4f"}),f&&c.a.createElement(Ze.a,{className:"number",color:"#fee"},null===(d=I[e.id])||void 0===d?void 0:d.num))},e.children.map(e=>{var t,n,r,o;const a=e.parametersMap,i=a.noticeType,s=a.noticeResidentType,l=a.noticeEndTime,u=a["ui-sref"],p=a.noticeText,d=F(u,i,s,l),h=d&&"text"===i,f=d&&("point"===i||(null===(t=T[u])||void 0===t?void 0:t.num)),m=d&&"number"===i&&(null===(n=I[u])||void 0===n?void 0:n.num)>0;return c.a.createElement(Nt,{key:u,onClick:()=>W(u,i,s)},c.a.createElement("span",null,null===(r=e.name)||void 0===r?void 0:r.replace(/_/g,"")),h&&c.a.createElement(Ze.a,{color:"#fee"},p),f&&c.a.createElement(Ze.a,{className:"dot",color:"#ff4d4f"}),m&&c.a.createElement(Ze.a,{className:"number",color:"#fee"},null===(o=I[u])||void 0===o?void 0:o.num))}))}{var h,f,m,y;const t=e.parametersMap["ui-sref"],a=F(t,n,r,o),s=a&&"text"===n,l=a&&("point"===n||(null===(h=T[t])||void 0===h?void 0:h.num)),u=a&&"number"===n&&(null===(f=I[t])||void 0===f?void 0:f.num);return c.a.createElement(Nt,{key:t,onClick:()=>W(t,n,r)},c.a.createElement(kt,{type:"icon"+e.icon}),!Q&&c.a.createElement("span",null,null===(m=e.name)||void 0===m?void 0:m.replace(/_/g,"")),s&&c.a.createElement(Ze.a,{color:"#fee",style:{opacity:1,maxWidth:"none"}},i),l&&c.a.createElement(Ze.a,{className:"dot",color:"#ff4d4f",style:{opacity:1,maxWidth:"none"}}),u&&c.a.createElement(Ze.a,{className:"number",color:"#fee",style:{opacity:1,maxWidth:"none"}},null===(y=I[t])||void 0===y?void 0:y.num))}})))};var Lt=c.a.memo(Mt,p.g),Dt=(n(460),n(250)),Ut=n(883),xt=n(2),Ht=n.n(xt),Bt=n(96),Gt=n.n(Bt);function qt(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,a=void 0;try{for(var i,c=e[Symbol.iterator]();!(r=(i=c.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){o=!0,a=e}finally{try{r||null==c.return||c.return()}finally{if(o)throw a}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Ft(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ft(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ft(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}const Wt=(e,t)=>{if(!t)return e;try{const n=new RegExp(t,"ig");return e.toString().replace(n,e=>`<span class="highlight">${e}</span>`)}catch(t){return e}},Vt=({order:e,onOrderClick:t,keyword:n})=>{return c.a.createElement("div",{className:Gt.a["order-card"],onClick:()=>t(e)},c.a.createElement("header",{className:Gt.a["order-card__header"]},c.a.createElement("span",{className:Ht()({[Gt.a["order-card__sn"]]:!0,[Gt.a["order-card__sn--highlight"]]:n===String(e.daySn)})},"#",e.daySn),c.a.createElement("span",null,e.statusDesc)),c.a.createElement("div",{className:Gt.a["order-card__content"]},c.a.createElement("p",null,c.a.createElement("span",{className:Gt.a["order-card__user"]},e.consigneeName),c.a.createElement("span",{className:Gt.a["order-card__phone"],dangerouslySetInnerHTML:{__html:Wt(""+e.endNum,n)}}),c.a.createElement("span",{className:Gt.a["order-card__separator"]},"|"),c.a.createElement("span",{className:Gt.a["order-card__income"]},"实收￥",(r=e.income,o=2,null===r?"--":r.toFixed(o)))),c.a.createElement("p",null,e.consigneeAddress),c.a.createElement("p",{dangerouslySetInnerHTML:{__html:Wt("订单号 "+e.id,n)}})));var r,o},Kt=({order:e,onOrderClick:t,keyword:n})=>{const r=qt(e.activeTime.split("-"),3),o=r[1],a=r[2];return c.a.createElement("div",{className:Gt.a.orderList},c.a.createElement("header",null,o,"/",a," 订单"),e.searchOrder.map(e=>c.a.createElement(Vt,{order:e,key:e.id,onOrderClick:t,keyword:n})))};var Yt=c.a.memo(Kt),zt=n(108),Qt=n.n(zt);function $t(e,t,n,r,o,a,i){try{var c=e[a](i),s=c.value}catch(e){return void n(e)}c.done?t(s):Promise.resolve(s).then(r,o)}function Jt(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var a=e.apply(t,n);function i(e){$t(a,r,o,i,c,"next",e)}function c(e){$t(a,r,o,i,c,"throw",e)}i(void 0)}))}}function Xt(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,a=void 0;try{for(var i,c=e[Symbol.iterator]();!(r=(i=c.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){o=!0,a=e}finally{try{r||null==c.return||c.return()}finally{if(o)throw a}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Zt(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Zt(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Zt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}const en=we.a.Search,tn="app.shop.order.searchings";let nn=0;var rn;!function(e){e[e.beforeSearching=0]="beforeSearching",e[e.searching=1]="searching",e[e.result=2]="result",e[e.emptyResult=3]="emptyResult"}(rn||(rn={}));const on=c.a.createElement("div",{style:{textAlign:"center"}},c.a.createElement(_.a,{tip:"搜索中..."})),an=e=>c.a.createElement("div",{className:Qt.a.dashboard},e.map(e=>c.a.createElement("div",{className:Qt.a.dashboard__panel,key:e.name},c.a.createElement("p",null,Dt.a[e.name]),c.a.createElement("ul",null,e.subLabels.map(e=>c.a.createElement(Ze.a,{className:Qt.a.dashboard__tag,onClick:()=>(e=>{const t=JSON.stringify({searchType:e.type,keyWord:e.name,searchValue:e.type});s.a.go(tn,{searchInfo:t})})(e)},e.name))))));function cn(e){const t=JSON.stringify({searchType:"orderId",keyWord:e.id,searchValue:null});s.a.go(tn,{searchInfo:t})}const sn=(e,t)=>{const n=e.map(e=>e.searchOrder.length).reduce((e,t)=>e+t,0);return c.a.createElement("div",{className:Qt.a["search-result"]},c.a.createElement("p",null,"为您找到“",t,"”相关订单",n,"个"),c.a.createElement("ul",{className:Qt.a.orders,key:"searchedOrders"},e.map(e=>c.a.createElement("li",{key:e.activeTime},c.a.createElement(Yt,{order:e,onOrderClick:cn,keyword:t})))))},ln=()=>{const e=Xt(Object(i.useState)(rn.beforeSearching),2),t=e[0],n=e[1],r=Xt(Object(i.useState)(""),2),o=r[0],a=r[1],l=Xt(Object(i.useState)([]),2),d=l[0],f=l[1],m=Xt(Object(i.useState)([]),2),y=m[0],g=m[1];Object(Ut.a)(()=>{o&&O(o)},300,[o]);const b=Object(i.useMemo)(()=>{return new Map([[rn.beforeSearching,an(y)],[rn.searching,on],[rn.result,sn(d,o)],[rn.emptyResult,(e=o,c.a.createElement("p",{className:Qt.a["no-result"]},"未找到“",e,"”相关订单"))]]);var e},[o,d,y]),O=function(){var e=Jt((function*(e){nn+=1;const t=nn,r=Xt(yield Object(p.t)(u.j.getSearchedOrders,{fuzzyPhrase:e}),2),o=r[0],a=r[1];if(t===nn&&!a){const e=o.length;n(0===e?rn.emptyResult:rn.result),f(o)}}));return function(t){return e.apply(this,arguments)}}(),w=function(){var e=Jt((function*(){if(h.a.log("ORDER_SEARCH_CLK"),y.length)return;const e=Xt(yield Object(p.t)(u.j.getSearchLabels,{}),2),t=e[0];e[1]||g(t.searchLabels)}));return function(){return e.apply(this,arguments)}}();return c.a.createElement("div",{className:Qt.a.orderSearcher},c.a.createElement(S.a,{trigger:"focus",placement:"bottom",content:b.get(t),overlayClassName:Qt.a.overlay},c.a.createElement(en,{placeholder:"支持订单号、流水号、手机号搜索",onFocus:w,onChange:e=>{const t=e.target.value,r=(void 0===t?"":t).trim();a(r),0!==r.length?n(rn.searching):n(rn.beforeSearching)},className:Qt.a.search,onSearch:()=>{const e=JSON.stringify({searchType:"fuzzyPhrase",keyWord:o,searchValue:null});s.a.go(tn,{searchInfo:e})},maxLength:19})))};var un=c.a.memo(ln,p.g),pn=n(119),dn=n.n(pn);function hn(e,t,n,r,o,a,i){try{var c=e[a](i),s=c.value}catch(e){return void n(e)}c.done?t(s):Promise.resolve(s).then(r,o)}function fn(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,a=void 0;try{for(var i,c=e[Symbol.iterator]();!(r=(i=c.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){o=!0,a=e}finally{try{r||null==c.return||c.return()}finally{if(o)throw a}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return mn(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return mn(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function mn(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}const yn=we.a.Search;let gn=0;var bn;!function(e){e[e.beforeSearching=0]="beforeSearching",e[e.searching=1]="searching",e[e.result=2]="result",e[e.emptyResult=3]="emptyResult"}(bn||(bn={}));const On=c.a.createElement("div",{className:dn.a.dashBoard},"请输入完整订单号进行搜索"),wn=c.a.createElement("div",{className:dn.a.center},c.a.createElement(_.a,{tip:"搜索中..."})),vn=c.a.createElement("div",{className:dn.a["no-result"]},"没有搜索到相关订单"),Sn=(e,t)=>{const n=e.map(e=>e.searchOrder.length).reduce((e,t)=>e+t,0),r=e=>{const t=JSON.stringify({searchType:"orderId",keyWord:e.id,searchValue:null});s.a.go("app.chainshop.order.searching",{searchInfo:t})};return c.a.createElement("div",{className:dn.a["search-result"]},c.a.createElement("p",null,"为您找到“",t,"”相关订单",n,"个"),c.a.createElement("ul",{className:dn.a.orders,key:"searchedOrders"},e.map(e=>c.a.createElement("li",{key:e.activeTime},c.a.createElement(Yt,{order:e,onOrderClick:r,keyword:t})))))},_n=()=>{const e=fn(Object(i.useState)(bn.beforeSearching),2),t=e[0],n=e[1],r=fn(Object(i.useState)(""),2),o=r[0],a=r[1],l=fn(Object(i.useState)([]),2),d=l[0],f=l[1];Object(Ut.a)(()=>{o&&y(o)},300,[o]);const m=Object(i.useMemo)(()=>new Map([[bn.beforeSearching,On],[bn.searching,wn],[bn.result,Sn(d,o)],[bn.emptyResult,vn]]),[o,d]),y=function(){var e,t=(e=function*(e){gn+=1;const t=gn,r=fn(yield Object(p.t)(u.j.getSearchedOrdersForChain,e),2),o=r[0],a=r[1];t===gn&&(a||(n(null==o?bn.emptyResult:bn.result),f(null==o?[]:[o])))},function(){var t=this,n=arguments;return new Promise((function(r,o){var a=e.apply(t,n);function i(e){hn(a,r,o,i,c,"next",e)}function c(e){hn(a,r,o,i,c,"throw",e)}i(void 0)}))});return function(e){return t.apply(this,arguments)}}(),g=Object(i.useCallback)(()=>{h.a.log("ORDER_SEARCH_CLK")},[]);return c.a.createElement("div",{className:dn.a.chainOrderSearcher},c.a.createElement(S.a,{trigger:"focus",placement:"bottom",content:m.get(t),overlayClassName:dn.a.overlay},c.a.createElement(yn,{onFocus:g,placeholder:"请输入完整的订单号",onChange:e=>{const t=e.target.value,r=(void 0===t?"":t).trim();a(r),0!==r.length?n(bn.searching):n(bn.beforeSearching)},className:dn.a.search,onSearch:()=>{if(19!==o.length)return void j.b.error("请输入完整订单号");const e=JSON.stringify({searchType:"orderId",keyWord:o,searchValue:null});s.a.go("app.chainshop.order.searching",{searchInfo:e})},maxLength:19})))};var jn=c.a.memo(_n,p.g),En=n(882),In=n(881),An=n(880),Pn=n(879),Tn=n(878),Cn=n(216),kn=n(247),Nn=n(78),Rn=n(80),Mn=n.n(Rn);function Ln(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Dn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ln(Object(n),!0).forEach((function(t){Un(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ln(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Un(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function xn(e,t,n,r,o,a,i){try{var c=e[a](i),s=c.value}catch(e){return void n(e)}c.done?t(s):Promise.resolve(s).then(r,o)}function Hn(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var a=e.apply(t,n);function i(e){xn(a,r,o,i,c,"next",e)}function c(e){xn(a,r,o,i,c,"throw",e)}i(void 0)}))}}function Bn(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,a=void 0;try{for(var i,c=e[Symbol.iterator]();!(r=(i=c.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){o=!0,a=e}finally{try{r||null==c.return||c.return()}finally{if(o)throw a}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Gn(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Gn(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Gn(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}const qn=e=>["SUCCESS","COMPLETE"].includes(e),Fn=["UGC","STATS"],Wn={UGC:{getTasks:u.b.getUgcTasks,getTasksNew:u.b.getUgcTasks,getTaskById:u.b.getUgcTaskByTaskId,getTaskByIdNew:u.b.getUgcTaskByTaskId},STATS:{getTasks:u.b.getStatsTasks,getTasksNew:u.b.getStatsTasksNew,getTaskById:u.b.getStatsTaskByTaskId,getTaskByIdNewParam:u.b.getStatsTaskByTaskIdNew}},Vn=({shopInfo:e,loading:t})=>{const n=Bn(Object(i.useState)(!0),2),r=n[0],o=n[1],a=Bn(Object(i.useState)(!1),2),s=a[0],l=a[1],u=Bn(Object(i.useState)([]),2),d=u[0],h=u[1],f=Object(i.useRef)([]),m=Bn(Object(i.useState)(null),2),y=m[0],g=m[1],b=Bn(Object(i.useState)(null),2),O=b[0],w=b[1],v=Bn(Object(i.useState)(!1),2),S=v[0],j=v[1],I=Object(i.useRef)([]),A=Object(i.useRef)(!1),P=Object(i.useRef)(!0);P.current=null==t||t;const T=e=>{let t=[],n=[];const r=Object(p.j)(["shopId"]).shopId,o=function(){var e=Hn((function*(e){var o;j(!0);const a=Bn(yield Object(p.t)(null===(o=Wn[e])||void 0===o?void 0:o.getTasksNew,null==r?void 0:r.toString()),2),i=a[0],c=a[1];j(!1),!c&&i&&(t=[...t,...i],n=[...n,...i.filter(e=>!N(e)).map(t=>Dn(Dn({},t),{},{actionType:e}))],0!==t.length&&(h(t),f.current=t,l(!0)),0!==n.length&&(I.current=n,w(5e3)))}));return function(t){return e.apply(this,arguments)}}();(e?[e].concat(Fn.filter(t=>t!==e)):Fn).map(e=>o(e))};Object(i.useEffect)(()=>{const e=(e,t)=>{l(!0),C(e,t)};return Cn.a.registerMethod("common.download",C),Nn.a.on("stats.single.orders.download",t=>{e(t.downloadTaskId,"STATS")}),Nn.a.on("stats.chain.orders.download",t=>e(t.downloadTaskId,"STATS")),Nn.a.on("comment.chain.orders.download",t=>e(t,"UGC")),()=>{Nn.a.off("stats.single.orders.download"),Nn.a.off("stats.chain.orders.download"),Nn.a.off("comment.chain.orders.download")}},[]),Object(i.useEffect)(()=>{P.current&&!A.current||(A.current=!0,T())},[e]),Object(kn.a)(()=>{I.current.forEach(({id:e,actionType:t})=>{C(e,t)})},O);const C=function(){var e=Hn((function*(e,t){const n=Object(p.j)(["shopId"]).shopId,r=Bn("STATS"===t?yield Object(p.t)(Wn[t].getTaskByIdNewParam,{taskId:e,userId:""+n}):yield Object(p.t)(Wn[t].getTaskByIdNew,e),2),o=r[0];if(!r[1]&&o){const n=o.id,r=o.status,a=I.current.findIndex(e=>e.id===n),i=f.current;if(-1===a){const e=Dn(Dn({},o),{},{actionType:t});I.current=[e,...I.current],i.unshift(e)}if(N(o)){I.current=I.current.filter(e=>e.id!==n);const t=i.findIndex(t=>t.id===e);i[t]=o,qn(r)&&g(o)}h(i),f.current=i,I.current&&0!==I.current.length?w(5e3):w(null)}}));return function(t,n){return e.apply(this,arguments)}}(),N=e=>{const t=e.status;return qn(t)||"FAILED"===t},R=e=>{if(!e)return;let t=document.getElementById("dcsv");t||(t=document.createElement("a"),t.id="dcsv",t.style.display="none",document.body.appendChild(t)),t.setAttribute("href",e),t.addEventListener("click",e=>e.stopPropagation()),t.click(),g(null)};return c.a.createElement(c.a.Fragment,null,s&&c.a.createElement("div",{className:Mn.a.downloadFile},c.a.createElement("div",{className:Mn.a.header},c.a.createElement("span",{className:Mn.a.headerTitle},(()=>{if(!d.length)return"暂无下载内容";const e=d.filter(e=>"FAILED"===e.status);if(e.length)return`出现${e.length}个问题`;return d.every(e=>N(e))?"已完成导出":"正在导出..."})()),c.a.createElement("div",{className:Mn.a.icon},c.a.createElement("div",{onClick:()=>o(!r),className:Mn.a.arrow},r?c.a.createElement(En.a,null):c.a.createElement(In.a,null)),c.a.createElement("div",{onClick:()=>l(!1),className:Mn.a.close},c.a.createElement(An.a,null)))),r&&c.a.createElement("div",{className:Mn.a.body},c.a.createElement(_.a,{spinning:S},c.a.createElement(c.a.Fragment,null,c.a.createElement("div",{className:Mn.a.bodyTitle},c.a.createElement("span",null,(()=>{const e=0!==d.length?d.filter(e=>"FAILED"===(e||{}).status):d;return e.length?`导出过程中, 出现了 ${e.length} 个问题`:"导出过程中，你仍可以正常操作其他页面。完成后将自动下载。"})())),c.a.createElement("div",{className:Mn.a.itemsWrapper},0!==d.length&&d.map(e=>c.a.createElement("div",{className:Mn.a.item,key:e.id},c.a.createElement("div",{className:Mn.a.itemContent},("WAITING"===e.status||"RUNNING"===e.status)&&c.a.createElement(Pn.a,null),qn(e.status)&&c.a.createElement(k.a,{style:{color:"#52c41a"}}),"FAILED"===e.status&&c.a.createElement(se.a,{style:{color:"#ff4d4f"}}),c.a.createElement("div",{className:Mn.a.itemTitle},e.taskName)),qn(e.status)&&c.a.createElement(Tn.a,{onClick:()=>R(e.link),className:Mn.a.download})))))))),c.a.createElement(E.a,{title:"导出完毕",visible:!!y,okText:"确认下载",cancelText:"取消",onOk:()=>{R((null==y?void 0:y.link)||""),g(null)},onCancel:()=>g(null)},c.a.createElement("div",null,(null==y?void 0:y.link)&&c.a.createElement("a",{href:null==y?void 0:y.link},null==y?void 0:y.taskName)," 已经导出完毕",(null==y?void 0:y.expireTime)&&c.a.createElement("span",null,"该文件将在"," ",lt()(y.expireTime).format("YYYY-MM-DD HH:mm:ss")," ","时过期, 请及时下载"))))};var Kn=c.a.memo(Vn,p.g),Yn=(n(840),n(498)),zn=(n(842),n(189)),Qn=n(483),$n=n.n(Qn),Jn=n(500);function Xn(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,a=void 0;try{for(var i,c=e[Symbol.iterator]();!(r=(i=c.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){o=!0,a=e}finally{try{r||null==c.return||c.return()}finally{if(o)throw a}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Zn(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Zn(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Zn(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}const er=e=>{const t=[];return e.forEach(e=>{const n=.2*e.title.length;t.push(n)}),t},tr=e=>{const t=[];return e.forEach(e=>{const n=.2*e.title.length;t.push(1e3*n-150)}),t},nr=e=>{const t=e.list,n=e.clickNotice,r=Xn(Object(i.useState)([...er(t)]),1)[0],o=Xn(Object(i.useState)([...tr(t)]),1)[0];Object(i.useEffect)(()=>{t.forEach(e=>{ee.a.setNotified(e.arenaMessageId),h.a.log("touch_xiaohuangtiao",{gzh_message_id:e.arenaMessageId},"EXP")})},[t]);return c.a.createElement(c.a.Fragment,null,c.a.createElement("div",{className:"text-loop-marquee"},c.a.createElement(Jn.a,{interval:o,mask:!0,className:"text-loop-wrap"},t.map((e,t)=>c.a.createElement("div",{style:{width:"100%"},key:e.arenaMessageId},c.a.createElement("div",{className:"text-loop-item "+r[t],onClick:()=>((e,t)=>{h.a.log("touch_xiaohuangtiao",{gzh_message_id:e.arenaMessageId,position:t},"CLK"),n(e)})(e,"TEXT")},e.title))))))};var rr=c.a.memo(nr,p.g);n(853);function or(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,a=void 0;try{for(var i,c=e[Symbol.iterator]();!(r=(i=c.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){o=!0,a=e}finally{try{r||null==c.return||c.return()}finally{if(o)throw a}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return ar(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ar(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ar(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function ir(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function cr(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ir(Object(n),!0).forEach((function(t){sr(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ir(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function sr(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const lr=(e,t,n,r)=>{h.a.log(e,cr({gongzhonghao_id:t.tab,gzh_message_id:t.arenaMessageId},r),n)},ur=Nn.a.OLD_ACTIONS.RestaurantAction.openReachUrl,pr=e=>e.filter(e=>{const t=A()(e,"remindForm.remindPCList.0.remindPositionPC");return["PC_INNER_POPUP","PC_SYSTEM_PUSH","PC_INNER_PUSH","NOTICE_BAR"].includes(t)}).map(e=>{const t=A()(e,"remindForm.remindPCList.0")||{},n=t.remindPolicyPC,r=t.remindPositionPC,o=t.remindContentPC,a=o.remindContentType,i=o.imageUrl,c=A()(e,"actions.actionList.0",{}),s=c.pcUrl,l=c.description,u="COUNT_DOWN_DISPLAY"===n;return cr(cr({},e),{},{showAction:!!s||Boolean(e.content),actionUrl:s,actionTitle:l,forceRead:u,remindPosition:r,remindPolicy:n,remindContentType:a,remindImageUrl:i})}),dr=(e,t)=>e.toString().length<=t?e:e.split("").slice(0,t).join("")+"...";var hr;!function(e){e.INTERNAL_ACTION_TOGGLE_SHOP_STATE="INTERNAL_ACTION_TOGGLE_SHOP_STATE",e.INTERNAL_EVENT_SHOW_BUSY_SETTING="INTERNAL_EVENT_SHOW_BUSY_SETTING"}(hr||(hr={}));const fr=()=>{var e,t;const n=or(Object(i.useState)(null),2),r=n[0],o=n[1],a=or(Object(i.useState)(!1),2),l=a[0],d=a[1],h=or(Object(i.useState)(!1),2),f=h[0],m=h[1],y=Object(i.useRef)(null),g=or(Object(i.useState)([]),2),b=g[0],O=g[1],w=or(Object(i.useState)([]),2),S=w[0],_=w[1],E=or(Object(i.useState)([]),2),I=E[0],A=E[1],P=Object(i.useRef)(null),T=Object(i.useRef)(null),C=or(Object(i.useState)([]),2),k=C[0],N=C[1],R=Object(i.useRef)({}),M=Object(ve.useParams)(),L=(e,t)=>{t&&lr("touch_push_qiang_button",e);const n=I,r=b.filter(t=>t.arenaMessageId!==e.arenaMessageId);I.length>0?O(Array.prototype.concat(r,n.shift())):O(r),zn.a.close(e.arenaMessageId)},D=(e,t=!1,n=!0)=>{ee.a.setNotified(e),t&&ee.a.setRead(e);const r=(p.s.getItem("pollingNotices")||[]).filter(t=>t.arenaMessageId!==e);p.s.setItem("pollingNotices",r),n&&o(null)},U=e=>[e.filter(e=>["PC_SYSTEM_PUSH","PC_INNER_POPUP"].includes(e.remindPosition||"")),e.filter(e=>"PC_INNER_PUSH"===e.remindPosition),e.filter(e=>"NOTICE_BAR"===e.remindPosition)],x=e=>{if(!e.length)return;const t=e.slice().shift();o(t);const n=t.remindPosition,a=t.remindImageUrl,i=t.remindContentType;if("PC_SYSTEM_PUSH"===n)window.chat&&window.chat.invoke("pc.notify.startFlashWindow");else if("PC_INNER_POPUP"===n){const e=!!a&&"IMAGE"===i;lr(e?"touch_Popup_picture":"touch_Popup_details",t,"EXP"),d(e),y.current.scrollHeight<=y.current.offsetHeight&&(m(!0),lr("touch_Popup_details_bottom",r||{}),D(t.arenaMessageId,!0,!1))}},H=e=>{const t=b.slice(),n=e.filter(e=>"ENFORCE_READING_STABLE"===e.remindPolicy),r=e.filter(e=>"ENFORCE_READING_STABLE"!==e.remindPolicy);if(t.length<=0)for(r.length>0&&t.push(r.shift());t.length<4;){const e=n.shift();if(!e)break;t.push(e)}else{if("ENFORCE_READING_STABLE"===t[0].remindPolicy){for(r.length>0&&t.unshift(r.shift());t.length<4;){const e=n.shift();if(!e)break;t.push(e)}for(;t.length>=5;)n.unshift(t.pop())}}A(n),_(r),O(t)},B=e=>{N(e)},G=e=>{if(!e)return;const t=e.actionUrl,n=e.arenaMessageId,r=e.showAction;t?q(t):r&&n&&F(n),D(n),o(null),d(!1)},q=Object(i.useCallback)(e=>{ur(e)},[]),F=Object(i.useCallback)(e=>{const t=Object(p.j)(["isChain"]).isChain?"app.chainshop.notice":"app.shop.notice";s.a.go(t,{detail:e})},[]),W=Object(i.useCallback)(e=>{const t=k.filter(t=>t.arenaMessageId!==e.arenaMessageId);N(t),F(e.arenaMessageId),D(e.arenaMessageId)},[k]),V=(e,t)=>{lr("touch_popup_details_button",e,"CLK",{position:t}),"ACTION"===t?G(e):D(e.arenaMessageId)},K=(e,t)=>{if(t)return lr("touch_push_ruo",t),void G(t);if(!e)return;const n=S,r=I,o=b.slice(1);if(P.current&&(clearTimeout(P.current),P.current=null),n.length>0){const e=n.shift();O(Array.prototype.concat(e,o)),_(n),ee.a.setNotified(e.arenaMessageId)}else T.current=null,zn.a.close("softPush"),I.length>0?(O(Array.prototype.concat(o,r.shift())),A(r)):O(o)},Y=e=>{p.s.setItem("pollingNotices",e),(e=>{const t=e||p.s.getItem("pollingNotices")||[],n=pr(t);if(n.length){const e=or(U(n),3),t=e[0],r=e[1],o=e[2];x(t),H(r),B(o)}})(e)},z=e=>{const t=e.remindPolicy;ee.a.setNotified(e.arenaMessageId);const n="ENFORCE_READING_STABLE"!==t;if(n){if(P.current)clearTimeout(P.current),P.current=null;else{const t=setTimeout(()=>{T.current=e.arenaMessageId,K(e.arenaMessageId)},3e4);P.current=t}T.current=e.arenaMessageId}R.current[e.arenaMessageId]||(R.current=cr(cr({},R.current),{},{[e.arenaMessageId]:1}),lr(n?"touch_push_ruo":"touch_push_qiang",e,"EXP")),zn.a.open({key:n?"softPush":e.arenaMessageId,className:Ht()("notice-inner-push",{"notice-inner-push-soft":n,hasImage:!!e.remindImageUrl}),message:c.a.createElement("div",{className:"header-text"},e.title),description:n?c.a.createElement("p",{className:"notice-inner-push-body"},e.summary?dr(e.summary,60):""):c.a.createElement(c.a.Fragment,null,c.a.createElement("p",{className:"notice-inner-push-body"},e.summary?dr(e.summary,60):""),c.a.createElement("div",{className:"notice-inner-push-footer"},c.a.createElement("span",{className:"btn btn-default",onClick:()=>L(e,!0)},"忽略"),(null==e?void 0:e.showAction)&&c.a.createElement("span",{className:"btn btn-primary",onClick:()=>(e=>{lr("touch_push_qiang_button",e,"CLK",{position:"按钮"}),L(e),G(e)})(e)},(null==e?void 0:e.actionTitle)||"立即处理"))),icon:e.remindImageUrl?c.a.createElement("img",{src:e.remindImageUrl,alt:e.title}):null,duration:null,closeIcon:null,onClick:n?()=>K(e.arenaMessageId,e):void 0,btn:null})};Object(i.useEffect)(()=>{r?P.current&&(clearTimeout(P.current),P.current=null):b.forEach(e=>z(e))},[b,r]),Object(i.useEffect)(()=>{const e=Object(p.j)(["shopId"]).shopId,t=setTimeout(()=>{e&&u.h.polling(e),ee.a.init()},15e3);Nn.a.on("crystal.notice.url",ur);const n=ee.a.onLinkClicked(e=>ur(e.pcUrl)),r=ee.a.onReaded(e=>{console.log("这里需要去除的队列的这项, 重新计算弹窗, push, 小黄条",e)});let o=()=>{};const a=setTimeout(()=>{o=ee.a.noticePolling(Y)},15e3);return()=>{o(),r(),n(),Nn.a.off("crystal.notice.url",ur),P.current&&clearInterval(P.current),clearTimeout(t),clearTimeout(a)}},[]);const Q=()=>{if(!P.current){const e=setTimeout(()=>{K(T.current)},1e4);P.current=e}},$=()=>{P.current&&(clearTimeout(P.current),P.current=null)},J=()=>{const e=document.getElementsByClassName("notice-inner-push-soft")[0];return!!e&&(e.addEventListener("mouseout",Q,!1),"mouseover"in e||e.addEventListener("mouseover",$,!1),!0)};return Object(i.useEffect)(()=>{const e=e=>{const t=or(pr([e]),1)[0];o(t)};return s.a.on("order.warning_message",e),J()||setTimeout(()=>{J()},2e3),()=>{s.a.off("order.warning_message",e);const t=document.getElementsByClassName("notice-inner-push-soft")[0];t&&(t.removeEventListener("mouseout",Q,!1),t.removeEventListener("mouseover",$,!1))}},[r,T.current]),c.a.createElement(c.a.Fragment,null,k.length>0&&c.a.createElement("div",{className:"notice-global-bar"},c.a.createElement(Yn.a,{banner:!0,message:c.a.createElement(rr,{list:k,clickNotice:W}),icon:c.a.createElement("img",{src:$n.a})})),r&&c.a.createElement("div",{className:"notice-modal"},l?c.a.createElement("div",{className:"notice-modal-image show"},c.a.createElement("span",null,r.remindImageUrl&&c.a.createElement("img",{onClick:()=>{return lr("touch_Popup_picture",e=r,"CLK",{position:"图片"}),void G(e);var e},src:r.remindImageUrl+"?imageMogr2/thumbnail/280x350!/format/webp",alt:r.title}),r.forceRead?c.a.createElement("i",{className:"notice-modal-badge"},c.a.createElement("span",null,"必读")):c.a.createElement("span",{onClick:()=>{return lr("touch_Popup_picture",e=r,"CLK",{position:"关闭"}),void D(e.arenaMessageId);var e}},"×"))):c.a.createElement("div",{className:"notice-modal-container show"},r.forceRead?c.a.createElement("i",{className:"notice-modal-badge"},c.a.createElement("span",null,"必读")):c.a.createElement("span",{onClick:()=>V(r,"CLOSE")},"×"),r.title&&c.a.createElement("div",{className:"notice-modal-title"},r.title),c.a.createElement("div",{className:"notice-modal-content"},r.content&&c.a.createElement("div",{className:"notice-modal-content-text",dangerouslySetInnerHTML:(X=r.content,{__html:X}),onScroll:e=>((e,t)=>{var n,r;const o=null!==(n=null==y||null===(r=y.current)||void 0===r?void 0:r.offsetHeight)&&void 0!==n?n:0;e.target.scrollTop+o>=e.target.scrollHeight&&(m(!0),lr("touch_Popup_details_bottom",t,"EXP"))})(e,r),ref:y}),r.forceRead&&!f?c.a.createElement("div",{className:"notice-modal-content-tip"},"滑动屏幕，看完重要信息，才可点击关闭"):c.a.createElement("div",{className:"notice-modal-content-tip-no"})),r.arenaMessageId?c.a.createElement("div",{className:"notice-modal-content-buttons"},c.a.createElement(v.a,{className:"notice-modal-content-btn",onClick:()=>V(r,"KNOW"),disabled:r.forceRead&&!f,shape:"round"},"我知道了"),r.showAction&&c.a.createElement(v.a,{className:"notice-modal-content-btn-primary",type:"primary",onClick:()=>V(r,"ACTION"),disabled:r.forceRead&&!f,shape:"round"},r.actionTitle||"查看详情")):null,!r.arenaMessageId&&(null==r||null===(e=r.actions)||void 0===e||null===(t=e.actionList)||void 0===t?void 0:t.length)>0?c.a.createElement("div",{className:"notice-modal-content-buttons"},r.actions.actionList.map((e,t)=>{var n;return c.a.createElement(v.a,{key:t,type:"#1989FA"===(null==e||null===(n=e.textColor)||void 0===n?void 0:n.toUpperCase())?"primary":void 0,className:"notice-modal-content-btn",onClick:t=>((e,t)=>{t.stopPropagation();const n=e.type,r=void 0===n?"":n,a=e.pcUrl;"REDIRECT_URL"===r&&(a===hr.INTERNAL_ACTION_TOGGLE_SHOP_STATE?s.a.emit("os","shop.toggleState",{visible:!0}):a===hr.INTERNAL_EVENT_SHOW_BUSY_SETTING?(["order__processing","order__querying","order__searchings"].includes(M.path)||s.a.go("app.shop.order.processing"),window._OSAdaptor.broadcast("order.showBusySetting")):"app.shop.resume"===a?u.k.openShop().then(()=>{s.a.emit("os","socket.shop.open")}).catch(e=>{j.b.error(null==e?void 0:e.message)}):ur(a)),o(null)})(e,t),disabled:r.forceRead&&!f,shape:"round"},e.actionTitle)})):null)));var X};var mr=c.a.memo(fr,p.g),yr=(n(854),n(495));const gr=()=>c.a.createElement("div",{className:"menu-skeleton"},Array(10).fill(null).map((e,t)=>c.a.createElement(yr.a,{key:t,avatar:{size:"small",shape:"square"},title:!1,paragraph:{rows:2,width:[120,120]}})));var br=c.a.memo(gr),Or=n(485),wr=n.n(Or),vr=n(161),Sr=n.n(vr);class _r extends c.a.Component{constructor(e){var t,n,r;super(e),r=()=>{Object(d.c)("crash","reload"),location.reload()},(n="refresh")in(t=this)?Object.defineProperty(t,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[n]=r,this.state={errorInfo:null}}static getDerivedStateFromError(e){return{errorInfo:e}}componentDidCatch(e,t){Object(d.c)("crash","start",{error:e,errorInfo:t}),setTimeout(()=>{this.refresh()},3e3)}render(){return this.state.errorInfo?c.a.createElement("div",{className:Sr.a.center},c.a.createElement("div",{className:Sr.a.image},c.a.createElement("img",{className:Sr.a.img,src:wr.a,alt:"发生了些错误"})),c.a.createElement("div",{className:Sr.a.title},"发生了些错误"),c.a.createElement("div",{className:Sr.a.description},"请尝试刷新, 稍后重试"),c.a.createElement("div",{className:Sr.a.footer},c.a.createElement(v.a,{type:"primary",onClick:this.refresh},"点我刷新"))):this.props.children}}var jr=_r,Er=(n(856),n(492));function Ir(e,t,n,r,o,a,i){try{var c=e[a](i),s=c.value}catch(e){return void n(e)}c.done?t(s):Promise.resolve(s).then(r,o)}function Ar(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var a=e.apply(t,n);function i(e){Ir(a,r,o,i,c,"next",e)}function c(e){Ir(a,r,o,i,c,"throw",e)}i(void 0)}))}}function Pr(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,a=void 0;try{for(var i,c=e[Symbol.iterator]();!(r=(i=c.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){o=!0,a=e}finally{try{r||null==c.return||c.return()}finally{if(o)throw a}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Tr(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Tr(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Tr(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}const Cr=E.a.confirm,kr=Er.a.RangePicker,Nr=({onChange:e,visible:t,onClose:n})=>{const r=Pr(Object(i.useState)([null,null]),2),o=r[0],a=r[1],s=Pr(Object(i.useState)(!1),2),l=s[0],d=s[1],h=function(){var e=Ar((function*(){const e=Pr(yield Object(p.t)(u.k.getCurrentVocation,{}),2),t=e[0];if(!e[1]&&t){d(!0);const e=t.fromDate,n=t.toDate;a([lt()(e),lt()(n)])}else d(!1),a([null,null])}));return function(){return e.apply(this,arguments)}}();Object(i.useEffect)(()=>{t&&h()},[t]);const f=function(){var t=Ar((function*(){Pr(yield Object(p.t)(u.k.clearVocation,{}),2)[1]||(j.b.success("删除歇业保护成功"),e(),h())}));return function(){return t.apply(this,arguments)}}(),m=c.a.createElement(c.a.Fragment,null,!l&&c.a.createElement(v.a,{onClick:()=>{l?Cr({title:"确认删除歇业设置",icon:c.a.createElement(P.a,null),content:"确定删除歇业设置，立即恢复营业",okText:"确认删除",okType:"danger",cancelText:"暂不删除",onOk(){f(),n()},onCancel(){n()}}):n()}},"我知道了"));return c.a.createElement(c.a.Fragment,null,c.a.createElement(E.a,{title:"歇业设置",footer:m,visible:t,onCancel:()=>n()},c.a.createElement(c.a.Fragment,null,c.a.createElement("div",{style:{marginBottom:"10px"}},l?"PC端老功能即将下线，您在PC端设置的歇业期会继续生效，但不产生保护效果。PC端不再支持歇业日期更改，您可在APP端操作。\n              PC端设置的歇业期不支持删除，如您到期希望继续营业，请直接将门店开启营业，歇业期将被自动删除。（如何判断是否为PC端设置的歇业期：PC端显示，APP端未显示）":"”假期歇业“功能已升级为”歇业保护“，您可在 APP 端查看详情并设置（路径：门店设置-歇业保护）。"),l&&c.a.createElement(kr,{placeholder:["开始日期","结束日期"],disabledDate:e=>{const t=o[0]&&e.diff(o[0],"days")>30;return o[1]&&o[1].diff(e,"days")>30||t||e<lt()().add(-1,"days").endOf("day")},value:o,onCalendarChange:e=>a(e)}))))};var Rr=c.a.memo(Nr,p.g),Mr=n(487),Lr=n.n(Mr);function Dr(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,a=void 0;try{for(var i,c=e[Symbol.iterator]();!(r=(i=c.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){o=!0,a=e}finally{try{r||null==c.return||c.return()}finally{if(o)throw a}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Ur(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ur(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ur(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var xr=()=>{const e=Dr(Object(i.useState)(" 加载资源中..."),2),t=e[0],n=e[1],r=Object(i.useRef)(null),o=Object(i.useRef)(null),a=Object(i.useRef)(null),s=Object(i.useRef)(null),l=!!localStorage.getItem("reloaded");return Object(i.useEffect)(()=>{const e=Date.now();return r.current=setTimeout(()=>{n(" 资源加载...");const t=Date.now()-e;window.tracker&&window.tracker.report({category:109,msg:"加载耗时超过1s",wl_avgv1:t>0?t:0}),clearTimeout(r.current)},1e3),o.current=setTimeout(()=>{n(" 网络较慢, 正在加载资源...");const t=Date.now()-e;window.tracker&&window.tracker.report({category:109,msg:"加载耗时超过2s",wl_avgv1:t>0?t:0}),clearTimeout(o.current)},2e3),a.current=setTimeout(()=>{n(" 网络异常, 请尝试手动刷新...");const t=Date.now()-e;window.tracker&&window.tracker.report({category:109,msg:"加载耗时超过3s",wl_avgv1:t>0?t:0}),clearTimeout(a.current)},3e3),s.current=setTimeout(()=>{n(` 网络异常, ${l?"即将为":"请"}您手动刷新...`);const t=Date.now()-e;window.tracker&&window.tracker.report({category:109,msg:"加载耗时超过5s"+(l?"自动刷新":""),wl_avgv1:t>0?t:0}),clearTimeout(s.current),l&&(localStorage.setItem("reloaded","1"),location.reload())},5e3),()=>{const t=Date.now()-e;(t<1e3||t>5e3)&&window.tracker&&window.tracker.report({category:109,msg:"加载耗时",wl_avgv1:t>0?t:0,sampleRate:.01}),clearTimeout(r.current),clearTimeout(o.current),clearTimeout(a.current),clearTimeout(s.current)}},[]),c.a.createElement(_.a,{className:Lr.a["global-center"],delay:300,tip:t})},Hr=n(169),Br=n.n(Hr),Gr=n(228),qr=n.n(Gr);function Fr(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,a=void 0;try{for(var i,c=e[Symbol.iterator]();!(r=(i=c.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){o=!0,a=e}finally{try{r||null==c.return||c.return()}finally{if(o)throw a}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Wr(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Wr(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Wr(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Vr(e,t,n,r,o,a,i){try{var c=e[a](i),s=c.value}catch(e){return void n(e)}c.done?t(s):Promise.resolve(s).then(r,o)}const Kr=function(){var e,t=(e=function*(e){const t=e.hasEverOpen,n=e.createdRecently;let r=!1,o=!1,a=!1,i="";if(!t&&n){const e=Fr(yield Object(p.t)(u.k.showTaskGuide),2),t=e[0];e[1]||(r=t.showGuide,r&&(window.showNewShopIntro=r,window._OSAdaptor.broadcast("switchToShopDashboardForce")),window.localStorage.getItem("newShopIntro")?a=!0:o=!0,i="app.shop.taskCenter")}return{showNewShopIntro:r,firstTimeShow:o,nonFirstTimeShow:a,targetState:i}},function(){var t=this,n=arguments;return new Promise((function(r,o){var a=e.apply(t,n);function i(e){Vr(a,r,o,i,c,"next",e)}function c(e){Vr(a,r,o,i,c,"throw",e)}i(void 0)}))});return function(e){return t.apply(this,arguments)}}(),Yr=e=>{const t=(null==e?void 0:e.basis)||{},n=t.hasEverOpen,r=t.createdRecently,o=Fr(Object(i.useState)(null),2),a=o[0],l=o[1];Object(i.useEffect)(()=>{Object(p.l)(n)||Object(p.l)(r)||Kr({hasEverOpen:n,createdRecently:r}).then(l)},[n,r]);const u=Object(i.useCallback)(()=>{(null==a?void 0:a.targetState)&&s.a.go(a.targetState),window.localStorage.setItem("newShopIntro",Date.now().toString()),l(null)},[a]);return a&&c.a.createElement(c.a.Fragment,null,(null==a?void 0:a.showNewShopIntro)&&(null==a?void 0:a.firstTimeShow)&&c.a.createElement(Br.a,{visible:!0,footer:null,className:qr.a.modal,width:382,closable:!1,centered:!0},c.a.createElement("img",{src:"https://img.alicdn.com/tfs/TB1pRq2sRBh1e4jSZFhXXcC9VXa-1528-1218.png",alt:"",height:"304"}),c.a.createElement(v.a,{type:"default",shape:"round",onClick:u,className:qr.a.btn1},"去完成")),(null==a?void 0:a.showNewShopIntro)&&(null==a?void 0:a.nonFirstTimeShow)&&c.a.createElement(Br.a,{visible:!0,footer:null,className:qr.a.modal,width:728,closable:!1,style:{top:"calc(100vh - 188px)"}},c.a.createElement("img",{src:"https://img.alicdn.com/tfs/TB1_45G3eH2gK0jSZJnXXaT1FXa-3641-690.png",alt:"",height:"138"}),c.a.createElement(v.a,{type:"default",shape:"round",onClick:u,className:qr.a.btn2},"去完成")))};var zr=c.a.memo(Yr,p.g)},108:function(e,t,n){e.exports={"order-searcher":"order-searcher__HvCuI8m40Vy1fgwIC4pux",orderSearcher:"order-searcher__HvCuI8m40Vy1fgwIC4pux",overlay:"overlay__n2ixFf9TJGJoXw5x4h3XQ",orders:"orders__1IvUERCim-6ST8nybHvjcl",search:"search__10jAWvnY6ImQuR1_hw-QMH",dashboard:"dashboard__1HHgIlM1GwtnqlQyio8p09",dashboard__panel:"dashboard__panel__MzKTLDtZfGaTW-EmEiXzk",dashboard__tag:"dashboard__tag__OofRbIsvTyDuzLpr0nnYI","no-result":"no-result__1NVb2f4eNFOzwo1xwA5x-J",noResult:"no-result__1NVb2f4eNFOzwo1xwA5x-J","search-result":"search-result__1FgG6Alkkm_hDJRmeVrNhF",searchResult:"search-result__1FgG6Alkkm_hDJRmeVrNhF"}},11:function(e,t,n){"use strict";n.d(t,"c",(function(){return s})),n.d(t,"b",(function(){return l})),n.d(t,"a",(function(){return u}));n(29),n(20),n(17);var r=n(30),o=n(21),a=n(40);function i(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}const c=!!localStorage.getItem("trace_debug");function s(e,t,n={}){if(window.tracker){var s;const l=n||{},u=l.groupId,p=l.error,d=i(l,["groupId","error"]),h=["socket_new","melody_print","signature"];if("CHAIN"===(null===(s=window.logParams)||void 0===s?void 0:s.loginShopType)&&h.includes(e))return;const f=[u,e,t].filter(e=>e).join(":"),m=Object(a.b)(),y={},g={category:100,msg:f,c1:u,c2:e,c3:t,c4:p?Object(a.f)(p):void 0,c5:Object(o.p)(m),bl3:Object(o.p)(d),bl4:Object(o.p)(y)};if((r.b||c)&&(p&&Object(a.e)(p),Object(a.g)("id:",e,"value:",t,g),!window.tracker))return;window.tracker&&window.tracker.report(g)}}function l(e,t){if(window.tracker){var n;const s=t||{},l=s.w_succ,u=s.wl_avgv1,p=s.startTime,d=s.name,h=s.error,f=s.params,m=s.response,y=i(s,["w_succ","wl_avgv1","startTime","name","error","params","response"]);if(1===l)return;const g=((null==h?void 0:h.message)||"").includes("browser env should not invoke chat"),b=null!=l?l:h&&!g?0:1;if(1===b)return;const O="CHAIN"===(null===(n=window.logParams)||void 0===n?void 0:n.loginShopType),w=["ArenaAction.printOrder","PrintAction","OrderAction","SoundAction","ClientService","RestaurantStore.canSignature","ArenaAction.broadcastOrderEvent","ArenaAction.haveEnabledPrinter2"].map(e=>null==d?void 0:d.includes(e));if(O&&d&&w)return;const v=Object(a.b)(),S=Object(a.c)(),_=h?Object(a.f)(h):void 0,j=Object(o.p)(f),E=Object(o.p)(m),I=Object(o.p)(v),A=Object(o.p)(y),P=Object(o.p)(S),T={CHAT:106,FOS:107,MOS_STORE:108,MOS_ACTION:108}[e],C=null!=u?u:p?Date.now()-p:void 0,k={category:T,msg:d,c1:e,c2:null==h?void 0:h.message,c3:j,c4:E,c5:I,bl1:j,bl2:E,bl3:A,bl4:P,bl5:_,w_succ:b,wl_avgv1:C};if((r.b||c)&&(h&&Object(a.e)(h),Object(a.g)("logItem","name",d,k,e),!window.tracker))return;window.tracker&&window.tracker.report(k)}}const u=(e,t={})=>{const n=t.scene,r=(t.error||{}).message,o=Date.now()-e;window.tracker&&window.tracker.report({w_succ:null==t?void 0:t.w_succ,wl_avgv1:o>0?o:0,category:110,msg:r?`${n}:${r}`:null,c1:n,c2:r,c3:(null==t?void 0:t.compInitTime)?Date.now()-(null==t?void 0:t.compInitTime):void 0,bl1:r})}},114:function(e,t,n){"use strict";n.d(t,"c",(function(){return o})),n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return i})),n.d(t,"d",(function(){return c}));var r=n(30);const o={DAILY:"https://help.daily.elenet.me/?scene=napos-pc",ALTC:"https://help.daily.elenet.me/?scene=napos-pc",PPE:"https://ppe-help.ele.me/?scene=napos-pc",PROD:"https://help.ele.me/?scene=napos-pc",INTERNAL_PROD:"https://help.ele.me/?scene=napos-pc",GRAY:"https://help.ele.me/?scene=napos-pc"}[r.e],a={DAILY:"https://client-api.daily.elenet.me",ALTC:"https://client-api.altc.elenet.me",PPE:"https://client-api.ele.me",PROD:"https://client-api.ele.me",INTERNAL_PROD:"https://client-api.ele.me",GRAY:"https://client-api.ele.me"}[r.e],i={DAILY:"https://shadow.daily.elenet.me/crayfish/",ALTC:"https://shadow.daily.elenet.me/crayfish/altc-",PPE:"https://shadow.elemecdn.com/crayfish/ppe-",PROD:"https://shadow.elemecdn.com/crayfish/",INTERNAL_PROD:"https://shadow.elemecdn.com/crayfish/",GRAY:"https://shadow.elemecdn.com/crayfish/"}[r.e],c={DAILY:"https://im.daily.elenet.me/napos",ALTC:"https://im.daily.elenet.me/napos",PPE:"https://ppe-im.ele.me/napos",PROD:"https://im.ele.me/napos",INTERNAL_PROD:"https://im.ele.me/napos",GRAY:"https://im.ele.me/napos"}[r.e]},119:function(e,t,n){e.exports={"chain-order-searcher":"chain-order-searcher__255V-z39um_Zh8EyNyQwx0",chainOrderSearcher:"chain-order-searcher__255V-z39um_Zh8EyNyQwx0",overlay:"overlay__1ZoCTVTRB5G6Z1SUddwmTh",orders:"orders__2HWCId_Oy4bVOQpok8yHtT",search:"search__1MTnCsvhM9msB-hvaF8vj6",center:"center__2Y9GItK5zdtGDNeC0Vipax",dashBoard:"dashBoard__3L9N1J3BxEo6mtqPv7SK9p","no-result":"no-result__19xMO41tJAyXR39m6lkUwg",noResult:"no-result__19xMO41tJAyXR39m6lkUwg","search-result":"search-result__3aJJ7sYIc6hwm0gq8euXZG",searchResult:"search-result__3aJJ7sYIc6hwm0gq8euXZG"}},12:function(e,t,n){"use strict";n.d(t,"g",(function(){return y})),n.d(t,"d",(function(){return g})),n.d(t,"a",(function(){return b})),n.d(t,"e",(function(){return O})),n.d(t,"h",(function(){return w})),n.d(t,"i",(function(){return v})),n.d(t,"c",(function(){return S})),n.d(t,"f",(function(){return _}));n(55),n(29),n(20),n(48),n(17);var r=n(118);n.d(t,"b",(function(){return r.a}));var o=n(1),a=n(11),i=n(173),c=n(30);function s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?s(Object(n),!0).forEach((function(t){u(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function u(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function p(e,t,n,r,o,a,i){try{var c=e[a](i),s=c.value}catch(e){return void n(e)}c.done?t(s):Promise.resolve(s).then(r,o)}function d(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var a=e.apply(t,n);function i(e){p(a,r,o,i,c,"next",e)}function c(e){p(a,r,o,i,c,"throw",e)}i(void 0)}))}}const h=()=>{const e="GRAY"===c.e?r.b.PROD:r.b[c.e];return c.b||c.g?e:void 0},f=()=>{const e=h(),t=window.logParams||Object(o.j)(["shopId","ksid","loginShopId"]),n=t.shopId,r=t.ksid,i=t.loginShopId,c=["/logined","/login","/password-reset","/ksid-login","/auth"].includes(location.pathname);return c||r||a.c&&Object(a.c)("ksid_null","getConfig"),c||n||a.c&&Object(a.c)("shopId_null","getConfig"),{loginShopId:i,shopId:n,ksid:r,env:e}},m=()=>{const e=f();return{shopId:e.shopId,ksid:e.ksid,env:e.env,appName:"melody"}};r.d.setDefaultConfig(m);const y=r.d;r.c.setDefaultConfig(m);const g=r.c,b=g.create({module:"arena",host:"app"});b.use([function(){var e=d((function*(e,t){if(Object(i.a)())try{(yield window.chat.invoke("pc.system.alisignature",JSON.stringify(e.request.params))).forEach((t,n)=>{e.request.options.headers[n]=t})}catch(e){Object(a.c)("signature","fail",{error:e})}try{e.request.options.credentials="include",yield t()}catch(e){throw e}}));return function(t,n){return e.apply(this,arguments)}}(),function(){var e=d((function*(e,t){var n;null==(null===(n=window)||void 0===n?void 0:n.risk_appid)&&(window.risk_appid="10002");const r=window.SecEnv,o={};null!=r&&""!==r&&(void 0!==r["bx-uab"]&&(o["bx-ua"]=r["bx-uab"].uab||""),void 0!==r["bx-umt"]&&(o["bx-umidtoken"]=r["bx-umt"].umidToken||""),void 0!==r.wsg&&(o["x-mini-wua"]=r.wsg.miniwua||"",o["x-umt"]=r.wsg.umt||""));try{e.request.options.headers=l(l({},e.request.options.headers),o)}catch(e){}try{yield t()}catch(e){throw e}}));return function(t,n){return e.apply(this,arguments)}}()]),b.setDefaultConfig(m);const O=g.create({module:"nevermore",host:"app"});O.setDefaultConfig(m);const w=g.create({module:"shop",host:"app"});w.setDefaultConfig(m);const v=g.create({module:"newshop_opt",host:"app"});v.setDefaultConfig(m);const S=g.create({module:"",host:"message"});S.use([function(){var e=d((function*(e,t){e.request.options.url=e.request.options.url.replace(/\/\/invoke/,"/invoke");try{yield t()}catch(e){throw e}}));return function(t,n){return e.apply(this,arguments)}}()]),S.setDefaultConfig(()=>{const e=f(),t=e.loginShopId,n=e.ksid;return{shopId:t,env:e.env,appName:"melody",metas:{acctType:"SHOP",app:"NAPOS",token:n}}});const _=g.create({module:"open-shop",host:"api"});_.use([function(){var e=d((function*(e,t){e.request.options.url=e.request.options.url.replace(/open-shop-api/,"open-shop");try{yield t()}catch(e){throw e}}));return function(t,n){return e.apply(this,arguments)}}()]),r.a.setDefaultConfig(()=>({env:h()}))},138:function(e,t,n){"use strict";n.d(t,"b",(function(){return c})),n.d(t,"a",(function(){return s}));n(17);var r=n(360),o=n(30),a=n(1),i=n(91);const c=()=>{try{const e=Object(a.j)(["loginShopId","loginShopType"]),t=e.loginShopId,n=e.loginShopType,i=t?""+t:"",c="CHAIN"===n?"chain":"single",s=Math.random().toString(36).slice(-8),l=location.host.includes("test.")?s:i;r.c({appKey:o.c?"9yPURfLV":"K2qTvf4l",user:{id:l,name:l,type:14},env:"prod",variables:{shopType:c},enableLocation:!1})}catch(e){window.tracker&&window.tracker.reportError(e)}},s=e=>{r.b.incrementBy(i.e[e],1)}},140:function(e,t,n){e.exports={"shop-switcher":"shop-switcher__16S8WD9aMCGB9BpqgnOX3g",shopSwitcher:"shop-switcher__16S8WD9aMCGB9BpqgnOX3g",icon:"icon__3Qtxb4SvtK4bm7HE2bbBVF",right:"right__e4RTYGmXElvOxKosbV9Bc","shop-name":"shop-name__1ygd6GUmZ59dEVOgtpp9Fv",shopName:"shop-name__1ygd6GUmZ59dEVOgtpp9Fv","cascader-wrapper":"cascader-wrapper__9FzMlSBsn_Lb6aRTqfDyr",cascaderWrapper:"cascader-wrapper__9FzMlSBsn_Lb6aRTqfDyr","item-row":"item-row__1g6pFZoNtqp_sfBMdn1YP7",itemRow:"item-row__1g6pFZoNtqp_sfBMdn1YP7","overlay-content":"overlay-content__3ArmrcpCPD0fsra9dNQtZc",overlayContent:"overlay-content__3ArmrcpCPD0fsra9dNQtZc","clk-area":"clk-area__VEpAX_WIlS9-beNk5giiK",clkArea:"clk-area__VEpAX_WIlS9-beNk5giiK"}},15:function(e,t,n){"use strict";n.d(t,"d",(function(){return i})),n.d(t,"c",(function(){return c.b})),n.d(t,"k",(function(){return l})),n.d(t,"i",(function(){return p})),n.d(t,"f",(function(){return d.b})),n.d(t,"a",(function(){return m})),n.d(t,"j",(function(){return y.b})),n.d(t,"h",(function(){return b})),n.d(t,"b",(function(){return w})),n.d(t,"e",(function(){return S})),n.d(t,"g",(function(){return _}));var r=n(1),o=n(12);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var i=new class{constructor(){a(this,"loginByUsername",e=>o.a.fetch({service:"LoginService",method:"loginByUsername",params:e,config:{metas:{AsuraId:r.b.getAsuraId(),fire_ua:r.b.getFireUa(),fire_umid:r.b.getFireUmid()}}})),a(this,"loginByMobile",e=>o.a.fetch({service:"LoginService",method:"loginByMobile",params:e,config:{metas:{AsuraId:r.b.getAsuraId(),fire_ua:r.b.getFireUa(),fire_umid:r.b.getFireUmid()}}})),a(this,"refreshCaptchaCode",e=>o.a.fetch({service:"LoginService",method:"refreshCaptchaCode",params:e,config:{metas:{fire_ua:r.b.getFireUa(),fire_umid:r.b.getFireUmid()}}})),a(this,"sendVerifyCode",e=>o.a.fetch({service:"LoginService",method:"sendVerifyCode",params:e,config:{metas:{fire_ua:r.b.getFireUa(),fire_umid:r.b.getFireUmid()}}})),a(this,"sendRiskVerifyCode",e=>o.a.fetch({service:"RiskLoginService",method:"sendVerifyCode",params:e})),a(this,"loginByRiskMobile",e=>o.a.fetch({service:"RiskLoginService",method:"loginByMobile",params:e})),a(this,"getLoginQRCode",()=>o.a.fetch({service:"QRCodeService",method:"getLoginQRCode",params:{}})),a(this,"checkLoginQRCode",e=>o.a.fetch({service:"QRCodeService",method:"checkLoginQRCode",params:{uuid:e}})),a(this,"loginOut",()=>o.a.fetch({service:"LoginService",method:"logout",params:{}}))}},c=n(172);function s(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var l=new class{constructor(){s(this,"getShopView",()=>{const e=Object(r.j)(["shopId"]).shopId;return o.h.fetch({params:{shopId:e},service:"queryShop",method:"getShopView"})}),s(this,"getShop",()=>{const e=Object(r.j)(["shopId"]).shopId;return o.h.fetch({service:"queryShop",method:"getShop",params:{shopId:[e]}})}),s(this,"openShop",()=>{const e=Object(r.j)(["shopId"]).shopId;return o.h.fetch({service:"setShop",method:"openShop",params:{shopId:e}})}),s(this,"getOpenShopGuide",()=>{const e=Object(r.j)(["shopId"]).shopId;return o.h.fetch({service:"queryShop",method:"getOpenShopGuide",params:{shopId:e}})}),s(this,"updateShopBusyLevel",({busyLevel:e,closeReason:t,reasonType:n})=>{const a=Object(r.j)(["shopId"]).shopId;return o.h.fetch({service:"setShop",method:"updateShopBusyLevel",params:{shopId:a,busyLevel:e,closeReason:t,reasonType:n}})}),s(this,"delayCloseShop",({closeReason:e,reasonType:t})=>{const n=Object(r.j)(["shopId"]).shopId;return o.h.fetch({service:"setShop",method:"closeShop",params:{shopId:n,reason:"BUSY",remark:"",closeReason:e,reasonType:t}})}),s(this,"countOrder",()=>{const e=Object(r.j)(["shopId"]).shopId;return o.e.fetch({service:"OrderService",method:"countOrder",params:{shopId:e,orderFilter:"BOOKING_ORDER",condition:{bookingOrderType:"ALL"}}})}),s(this,"checkCrmEntry",()=>o.d.fetch({module:"arena",service:"CrmOpenService",method:"checkCrmEntry",params:{}})),s(this,"getCurrentVocation",()=>{const e=Object(r.j)(["shopId"]).shopId;return o.h.fetch({service:"shopVocation",method:"getCurrentVocation",params:{shopId:e}})}),s(this,"saveVocation",({fromDate:e,toDate:t})=>{const n=Object(r.j)(["shopId"]).shopId;return o.h.fetch({service:"shopVocation",method:"saveVocation",params:{shopId:n,fromDate:e,toDate:t}})}),s(this,"clearVocation",()=>{const e=Object(r.j)(["shopId"]).shopId;return o.h.fetch({service:"shopVocation",method:"clearVocation",params:{shopId:e}})}),s(this,"queryShopStatusViewDetail",()=>{const e=Object(r.j)(["shopId"]).shopId;return o.h.fetch({params:{shopId:e},service:"QueryShopService",method:"queryShopStatusViewDetail"})}),s(this,"queryShopStatusView",()=>{const e=Object(r.j)(["shopId"]).shopId;return o.h.fetch({params:{shopId:e},service:"QueryShopService",method:"queryShopStatusView"})}),s(this,"queryCloseReason",()=>{const e=Object(r.j)(["shopId"]).shopId;return o.h.fetch({params:{shopId:e},service:"QueryShopService",method:"queryCloseReason"})}),s(this,"getAllShops",()=>o.h.fetch({params:{},service:"queryShop",method:"getAllShops"})),s(this,"showTaskGuide",()=>{const e=Object(r.j)(["shopId"]).shopId;return o.i.fetch({params:{shopId:e},service:"ShopGuideService",method:"showTaskGuide"})})}};function u(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var p=new class{constructor(){u(this,"getKeeperByUsername",e=>o.a.fetch({service:"ResetPasswordV2Service",method:"getKeeperByUsername",params:e})),u(this,"startReset",e=>o.a.fetch({service:"ResetPasswordV2Service",method:"startReset",params:e})),u(this,"sendVerifyCode",e=>o.a.fetch({service:"ResetPasswordV2Service",method:"sendVerifyCode",params:e})),u(this,"refreshCaptcha",e=>o.a.fetch({service:"ResetPasswordV2Service",method:"refreshCaptchaCode",params:e})),u(this,"checkVerifyCode",e=>o.a.fetch({service:"ResetPasswordV2Service",method:"checkVerifyCode",params:e})),u(this,"checkIdCard",e=>o.a.fetch({service:"ResetPasswordV2Service",method:"checkIdCard",params:e})),u(this,"checkBankCard",e=>o.a.fetch({service:"ResetPasswordV2Service",method:"checkBankCard",params:e})),u(this,"setNewPassword",e=>o.a.fetch({service:"ResetPasswordV2Service",method:"setNewPassword",params:e}))}},d=n(105);function h(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const f={closeReasonInfo:"https://shadow.elemecdn.com/crayfish/melody.shop.ele.me/shop-close-reasons",signatureWhiteListUrl:"https://shadow.elemecdn.com/crayfish/melody.shop.ele.me/signatureWhiteList"};var m=new class{constructor(){h(this,"get",e=>fetch(f[e]).then(e=>e.json())),h(this,"signatureWhiteListUrl",()=>o.b.get({url:"melody/signatureWhiteList"})),h(this,"getFaqList",()=>o.b.get({url:"melody/faq"})),h(this,"getMenuIconId",()=>o.b.get({url:"melody-plus/iconfont-id"}))}},y=n(250),g=n(8);var b=new class{constructor(){var e,t,n;n=e=>o.d.fetch({module:"arena",service:"PushService",method:"polling",params:{shopId:e}}).then(e=>(g.a.emit("os","PushService.polling",e),e)),(t="polling")in(e=this)?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}};function O(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var w=new class{constructor(){O(this,"getUgcTasks",()=>o.d.fetch({module:"ugc",service:"ExportRatingTaskService",method:"queryExportRatingTasks",params:{}})),O(this,"getUgcTaskByTaskId",e=>o.d.fetch({module:"ugc",service:"ExportRatingTaskService",method:"getExportRatingTask",params:{taskId:e}})),O(this,"getStatsTasks",()=>o.d.fetch({module:"stats",service:"DownloadService",method:"queryDownloadTasks",params:{}})),O(this,"getStatsTasksNew",e=>o.d.fetch({module:"stats",service:"DownloadDataService",method:"queryHistoryList",params:{userId:e}})),O(this,"getStatsTaskByTaskId",e=>o.d.fetch({module:"stats",service:"DownloadService",method:"getDownloadTaskDetail",params:{downloadTaskId:e}})),O(this,"getStatsTaskByTaskIdNew",({taskId:e,userId:t})=>o.d.fetch({module:"stats",service:"DownloadDataService",method:"getTask",params:{request:{userId:t,taskId:e}}}))}};function v(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var S=new class{constructor(){v(this,"getCommentNotice",()=>{const e=Object(r.j)(["shopId","shopType"]),t=e.shopId,n=e.shopType;return o.d.fetch({module:"ugc",service:"shopRating",method:"countNewShopRating",params:{shopId:"SHOP"===n&&t?Number(t):void 0,isChainShop:"CHAIN"===n}})}),v(this,"setLastCheckCommentDate",()=>{const e=Object(r.j)(["shopId","shopType"]),t=e.shopId,n=e.shopType;return o.d.fetch({module:"ugc",service:"shopRating",method:"setLastCheckCommentDate",params:{shopId:"SHOP"===n&&t?t:void 0,isChainShop:"CHAIN"===n}})})}};new class{constructor(){var e,t,n;n=e=>o.d.fetch({module:"arena",service:"KeeperGrayService",method:"inGray",params:e}),(t="inGray")in(e=this)?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}};var _=new class{getMessageList(e){return o.c.fetch({service:"ShopMessageService",method:"getShopMessageList",params:{req:{limit:e.limit,offset:e.offset,tabId:e.tab,readStat:e.readStat}}})}pollingNotify(){return o.c.fetch({service:"MessageV2Service",method:"pollingNotify",params:{}})}getAllUnReadCount(){return o.c.fetch({service:"ShopMessageService",method:"getAllUnReadCount",params:{}})}setReadStatus(e){return o.c.fetch({service:"ShopMessageService",method:"setReadStatus",params:{messageId:e}})}setNotified(e){return o.c.fetch({service:"MessageService",method:"setNotified",params:{messageId:e}})}}},160:function(e,t,n){e.exports={radioCard:"radioCard__20JQm3yjxZVR0oRuGwRhja",cardRadio:"cardRadio__HIK_EVUJHFfdmcN8yZ9r1",logined:"logined__2PTBVAgt7PjnjVcCh8trBs",card:"card__3Vhh7f6qR2TNiPi743fQkW",img:"img__3Hqf6hqi0t6antg7Km6RVR",content:"content__3yHzoy6zndMkUkJm1qPivu",info:"info__2VNf99KkCOQQAEgjKJjYlF"}},161:function(e,t,n){e.exports={center:"center__1M0b1PdU39HBA7OgdwWTEG",image:"image__H_b89Gog36GAird7OQJjg",img:"img__GLIzFrEzpRu77ZgQGk-Bh",title:"title__2NrXmsk4e5pBqMWmCoah-V",description:"description__3NZKWTkhULzA-RP8TXJmZ6",footer:"footer__i16gjNjptLSs8s9KjJir"}},172:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(1),o=n(12);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}let i,c;!function(e){e.ROOT="ROOT",e.GROUP="GROUP",e.LEAF="LEAF"}(i||(i={})),function(e){e.BRAND_CENTER="BRAND_CENTER",e.STANDARD="STANDARD",e.ROOT="ROOT"}(c||(c={}));t.b=new class{constructor(){a(this,"getRestaurantTree",()=>{const e=Object(r.j)(["loginShopId"]).loginShopId;return o.d.fetch({module:"shop",service:"shop",method:"getRestaurantTree",params:{restaurantIds:[e]}})}),a(this,"getKeeper",()=>o.d.fetch({module:"arena",service:"KeeperService",method:"getKeeper",params:{}}))}}},173:function(e,t,n){"use strict";n.d(t,"b",(function(){return s}));n(48),n(17);var r=n(1),o=n(11),a=n(15);function i(e,t,n,r,o,a,i){try{var c=e[a](i),s=c.value}catch(e){return void n(e)}c.done?t(s):Promise.resolve(s).then(r,o)}const c={_ids:[],_isGrey:!1,get ids(){return this._ids},set ids(e){this._ids=e},get isGrey(){return this._isGrey},set isGrey(e){this._isGrey=e}};t.a=()=>{const e=window.navigator.userAgent.match(/ID\/(.+)$/),t=e&&e[1],n=+localStorage.loginShopId,r=c.ids,o=r.includes(t)||r.includes(n);return!c.isGrey&&window.isClient&&window.isOverV509Client&&!o};const s=function(){var e,t=(e=function*(){if(window.isOverV509Client=Object(r.v)(window.clientVersion,"5.0.9"),window.isOverV509Client)try{const e=yield a.a.signatureWhiteListUrl(),t=e.deviceOrShopIds,n=void 0===t?[]:t,r=e.isGrey,o=void 0!==r&&r;c.ids=n,c.isGrey=o}catch(e){Object(o.c)("signature","load_white_fail",{error:e})}},function(){var t=this,n=arguments;return new Promise((function(r,o){var a=e.apply(t,n);function c(e){i(a,r,o,c,s,"next",e)}function s(e){i(a,r,o,c,s,"throw",e)}c(void 0)}))});return function(){return t.apply(this,arguments)}}()},174:function(e,t,n){"use strict";n(41),n(17),n(20),n(42),n(29);function r(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,a=void 0;try{for(var i,c=e[Symbol.iterator]();!(r=(i=c.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){o=!0,a=e}finally{try{r||null==c.return||c.return()}finally{if(o)throw a}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return o(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return o(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}t.a={getCurrentProfile:()=>window.chat.invoke("pc.profile.getCurrentProfile"),removeCurrentProfile:()=>window.chat.invoke("pc.profile.removeCurrentProfile"),updateCurrentProfile:e=>window.chat.invoke("pc.profile.updateCurrentProfile",{updateInfo:e}),launchProfile:e=>window.chat.invoke("pc.profile.launchProfile",{id:e}),getProfiles:()=>window.chat.invoke("pc.profile.getProfiles"),addProfile:e=>window.chat.invoke("pc.profile.addProfile",{addInfo:e}).then(e=>e),updateProfile:(e,t)=>window.chat.invoke("pc.profile.updateProfile",[e,t]),removeProfile:e=>window.chat.invoke("pc.profile.removeProfile",{id:e}),getClientVersion:()=>window.chat.invoke("pc.config.getClientVersion"),closeWindow:()=>window.chat.invoke("pc.window.close"),minimizeWindow:()=>window.chat.invoke("pc.window.minimize"),maximizeWindow:()=>window.chat.invoke("pc.window.maximize"),isMaxWindow:()=>window.chat.invoke("pc.window.isMaxWindow"),isMaximize(e){window.chat.on("pc.window.isMaximize",e)},resize(e){window.chat.on("pc.window.resize",e)},launchDefaultBrowser(e){if(e)return window.chat.invoke("pc.system.launchDefaultBrowser",{url:e})},startFlashWindow:()=>window.chat.invoke("pc.notify.startFlashWindow"),stopFlashWindow:()=>window.chat.invoke("pc.notify.stopFlashWindow"),callSwitchToFront:()=>window.chat.invoke("pc.system.callSwitchToFront"),getVersionSync(){const e=r(window.navigator.userAgent.match(/Rajax\/1 PC\/1 (Windows\/[^/]+) Napos\/([^/]+) ID\/[a-zA-Z0-9-]{36}$/)||[],3);return[e[1],e[2]]},getClientBootInfo(){var e,t;const n=(null===(e=window.nw)||void 0===e||null===(t=e.App)||void 0===t?void 0:t.dataPath)||"";return{dataPath:n,isFirst:n.includes("UserData_0")}}}},175:function(e,t,n){"use strict";n.d(t,"b",(function(){return d}));n(55),n(29),n(20),n(48),n(17);var r=n(26),o=n(104);function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){c(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function c(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function s(e,t,n,r,o,a,i){try{var c=e[a](i),s=c.value}catch(e){return void n(e)}c.done?t(s):Promise.resolve(s).then(r,o)}function l(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var a=e.apply(t,n);function i(e){s(a,r,o,i,c,"next",e)}function c(e){s(a,r,o,i,c,"throw",e)}i(void 0)}))}}let u;!function(e){e.volume="volume"}(u||(u={}));const p={volume:{type:u.volume,value:1}},d={networkDisconnect:{name:r.a.networkDisconnect,type:1,times:1,priority:110,optionTypes:[1],optionTimes:[0,1,10]},printerDisconnect:{name:r.a.printerDisconnect,type:1,times:1,priority:100,optionTypes:[1],optionTimes:[0,1,10]},newOrder:{name:r.a.newOrder,type:1,times:10,priority:90,optionTypes:[0,1],optionTimes:[0,1,3,10]},autoProcess:{name:r.a.autoProcess,type:1,times:1,priority:80,optionTypes:[0,1],optionTimes:[0,1,3]},printError:{name:r.a.printError,type:1,times:1,priority:70,optionTypes:[1],optionTimes:[0,1]},othersConfirmOrder:{name:r.a.othersConfirmOrder,type:1,times:1,priority:60,optionTypes:[1],optionTimes:[0,1]},exception:{name:r.a.exception,type:1,times:3,priority:50,optionTypes:[1],optionTimes:[0,1,3,10]},cancel:{name:r.a.cancel,type:1,times:3,priority:40,optionTypes:[1],optionTimes:[0,1,3,10]},systemCancel:{name:r.a.systemCancel,type:1,times:3,priority:100,optionTypes:[1],optionTimes:[0,1,3,10]},booking:{name:r.a.booking,type:1,times:3,priority:30,optionTypes:[1],optionTimes:[0,1,3,10]},refund:{name:r.a.refund,type:1,times:3,priority:20,optionTypes:[1],optionTimes:[0,1,3,10]},urge:{name:r.a.urge,type:1,times:3,priority:15,optionTypes:[1],optionTimes:[0,1,3,10]},businessOrder:{name:r.a.businessOrder,type:1,times:1,priority:10,optionTypes:[1],optionTimes:[0,1,3]},ugcReminder:{name:r.a.ugcReminder,type:1,times:1,priority:120,optionTypes:[1],optionTimes:[0,1,3]},diningOutReminder:{name:r.a.diningOutReminder,type:1,times:1,priority:9,optionTypes:[1],optionTimes:[0,1,3]},IM_NEW_MSG:{name:r.a.IM_NEW_MSG,type:1,times:1,priority:6,optionTypes:[1],optionTimes:[0,1,3]},IM_COM_MSG:{name:r.a.IM_COM_MSG,type:0,times:1,priority:5,optionTypes:[0],optionTimes:[0,1]},IM_IMPORTANT_MSG_NOREPLY:{name:r.a.IM_IMPORTANT_MSG_NOREPLY,type:1,times:1,priority:7,optionTypes:[1],optionTimes:[0,1,3]}},h=function(){var e=l((function*(){const e=yield o.a.getSounds(),t=i({},d);return e.forEach(e=>{t[e.name]=i(i({},t[e.name]),e)}),t}));return function(){return e.apply(this,arguments)}}(),f=o.a.updateSounds,m=function(){var e=l((function*(){const e=yield o.a.getOptions(),t=i({},p);return e.forEach(e=>{t[e.type]=i(i({},t[e.type]),e)}),t}));return function(){return e.apply(this,arguments)}}(),y=o.a.updateOptions;t.a={getSoundSettings:h,updateSoundSettings:f,getOptionSettings:m,updateOptionsSettings:y}},190:function(e,t,n){e.exports={"print-state":"print-state__33aURYrCmzPuL7NSNGBgGF",printState:"print-state__33aURYrCmzPuL7NSNGBgGF",connected:"connected__2HL6SRa8cUqv9Z66fw_eYq",noConnected:"noConnected__1iGRfsIaQWDJsS15z2l8Mp"}},201:function(e,t,n){"use strict";n.d(t,"b",(function(){return c}));n(20),n(17);var r=n(103),o=n.n(r);const a=!!window.__napos__sendToBrowser__;const i=document.domain.split(".").slice(-2).join("."),c=(e,t)=>{o.a.set(e,t,{expires:7,domain:i})};t.a={isClient:a,setSessionData:function(e,t){"string"!=typeof e?Object.keys(e).forEach(t=>sessionStorage.setItem(t,e[t])):t&&sessionStorage.setItem(e,t)},getSessionData:e=>sessionStorage.getItem(e),removeSessionData:e=>sessionStorage.removeItem(e),clearSessionData:()=>sessionStorage.clear(),setLocalData:function(e,t){"string"!=typeof e?Object.keys(e).forEach(t=>localStorage.setItem(t,e[t])):null!=t&&localStorage.setItem(e,t)},getLocalData:e=>localStorage.getItem(e),removeLocalData:e=>localStorage.removeItem(e),clearLocalData:()=>localStorage.clear(),openNewTab:e=>{window.open(e)},getAsuraId:function(){return window.uabModule?window.uabModule.getUA():void 0},getFireUa:function(){return window.fyOBJ?window.fyOBJ.getUA():void 0},getFireUmid:function(){return(window.fyOBJ||{}).umidToken}}},21:function(e,t,n){"use strict";n.d(t,"m",(function(){return p})),n.d(t,"s",(function(){return d})),n.d(t,"r",(function(){return h})),n.d(t,"i",(function(){return m})),n.d(t,"h",(function(){return y})),n.d(t,"g",(function(){return g})),n.d(t,"p",(function(){return b})),n.d(t,"o",(function(){return O})),n.d(t,"b",(function(){return w})),n.d(t,"n",(function(){return v})),n.d(t,"f",(function(){return S})),n.d(t,"k",(function(){return _})),n.d(t,"d",(function(){return j})),n.d(t,"c",(function(){return E})),n.d(t,"e",(function(){return I})),n.d(t,"a",(function(){return A})),n.d(t,"q",(function(){return P})),n.d(t,"j",(function(){return T})),n.d(t,"t",(function(){return C})),n.d(t,"l",(function(){return k}));n(55),n(29),n(48),n(109);var r=n(45),o=(n(385),n(20),n(17),n(254)),a=n(11);function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function c(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){s(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function l(e,t,n,r,o,a,i){try{var c=e[a](i),s=c.value}catch(e){return void n(e)}c.done?t(s):Promise.resolve(s).then(r,o)}function u(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var a=e.apply(t,n);function i(e){l(a,r,o,i,c,"next",e)}function c(e){l(a,r,o,i,c,"throw",e)}i(void 0)}))}}const p=(e={},t=!0)=>Object.entries(e).filter(([,e])=>null!=e).reduce((e,[n,r])=>`${e?e+"&":""}${n}=${t?encodeURIComponent(r):r}`,"");function d(e){return Object.prototype.toString.call(e).slice(8,-1)}function h(e,t,n){return f.apply(this,arguments)}function f(){return(f=u((function*(e,t,n){try{return[yield e(t),null]}catch(e){return m(e,n),[null,e]}}))).apply(this,arguments)}const m=(e,t)=>{if(!["RISK_BLOCK"].includes(null==e?void 0:e.code))switch(r.b&&r.b.error((null==e?void 0:e.message)||"未知错误"),null==e?void 0:e.code){case"UNAUTHORIZED":case"LOGIN_REQUIRED":case"INVALID_SELF_DIST_RESTAURANT_D":Object(a.c)("to_login","interface",{error:e}),!t&&v()}};function y(e){const t=window.location.search,n=new RegExp(`(^|&)${e}=([^&]*)(&|$)`,"i"),r=t.substr(1).match(n);return null!=r?unescape(r[2]):null}function g(){const e={},t=location.href.match(/[?&]([^=&#]+)=([^&#]*)/g);return t&&t.forEach(t=>{const n=t.split("="),r=n[0].substr(1),o=n[1];e[r]=o}),e}function b(e,t){if(null==e)return"";if("string"==typeof e)return e;try{return JSON.stringify(e,function(){const e=[],t=[];return function(n,r){if("object"==typeof r&&null!==r){const o=e.indexOf(r);if(-1!==o)return`[Circular ${t[o]}]`;e.push(r),t.push(n||"root")}return r}}(),t)}catch(e){return Object(a.c)("utils_fail","stringify",{error:e}),""}}function O(e){if(null==e)return e;if("string"!=typeof e)return e;if(e.match(/^\d+$/))return Number(e);if(!/^\{.*\}$/.test(e)&&!/^\[.*\]$/.test(e))return e;try{return JSON.parse(e)}catch(t){return console.log("safeParse error",t),Object(a.c)("utils_fail","parse",{error:t}),e}}const w=e=>{if(!e)return e;if("function"==typeof e)return e;try{return JSON.parse(JSON.stringify(e))}catch(e){Object(a.c)("utils_fail","clone_deep",{error:e})}};function v(){const e=o.b.location,t=e.pathname,n=e.search,r=e.hash,a=/\/login/g.test(t)?"":"?from="+encodeURIComponent(t+n+r);location.href=`${location.origin}/login${a}`}function S(e,t){if(!t)return e;if("object"!=typeof e)return;const n=t.split(".");return S(e[n[0]],n.slice(1).join("."))}function _(e){if("object"==typeof e&&null!==e){if("function"==typeof Object.getPrototypeOf){const t=Object.getPrototypeOf(e);return t===Object.prototype||null===t}return"[object Object]"===Object.prototype.toString.call(e)}return!1}function j(e){return new Promise(t=>setTimeout(t,e))}function E(e,t,n=!1){if(e===t)return!0;if("object"==typeof e&&null!=e&&"object"==typeof t&&null!=t){if(Object.keys(e||{}).length!==Object.keys(t||{}).length)return!1;for(const r in e){if(!Object.prototype.hasOwnProperty.call(t,r))return!1;if(!E(e[r],t[r]))return n&&console.log("key is diff",r,e[r],t[r]),!1}return!0}return!1}function I(e,t="children",n=!1){return e.reduce((e,r)=>r[t]&&r[t].length?[...e,...r[t].map(e=>c(c({},e),{},{parentId:r.id})).concat(n?r:[])]:[...e,r],[])}const A=(e,t)=>{e&&(e.classList.toString().includes(t)||e.setAttribute("class",`${e.classList} ${t}`))},P=e=>e?"string"==typeof e?e:Object.keys(e).reduce((t,n)=>`${t?t+"&":t}${n}=${e[n]}`,""):"",T=e=>null==e;function C(e,t){const n=t.replace(/\./g,"");return e.replace(/\./g,"")>=n}const k=e=>new Promise(t=>{if("function"==typeof e){const n=e();"Promise"===d(n)?n.then(t):t(n)}else t(e)})},227:function(e,t,n){e.exports={toolBarWrapper:"toolBarWrapper__3tJSqR9WPTI1GwW1vTiaN8",leftBlock:"leftBlock__NfHGfpq9bBfWAzxZpGjjc",tabSwitch:"tabSwitch__31gi31GWbvaK_Mu1cKv7Se",rightBlock:"rightBlock__1JTuU72ZwK2m7UZphBNgcr"}},228:function(e,t,n){e.exports={modal:"modal__3Yr5Ou8v5bqvyigzGU-Sg2",btn1:"btn1__3WtzYBHeGkTUEkb9cY835w",btn2:"btn2__pfSpJijzgXNMW5cdKGCmE"}},247:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return i})),n.d(t,"d",(function(){return _}));var r=n(0);var o=(e,t)=>{const n=i(e);Object(r.useEffect)(()=>{if(null!==t){const e=setInterval(()=>{n&&n()},t);return()=>clearInterval(e)}},[t,n])};var a=e=>Object(r.useReducer)((e=>(t,n)=>{switch(n){case"negation":return!t;case"rest":return e;default:throw new Error("Unexpected action")}})(e),e);var i=function(e){const t=Object(r.useRef)();return Object(r.useEffect)(()=>{t.current=e}),t.current};n(55),n(29),n(20),n(17);var c=n(479),s=n.n(c),l=n(480),u=n.n(l),p=n(114),d=n(1),h=n(8),f=n(26),m=n(46),y=n.n(m);function g(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function b(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?g(Object(n),!0).forEach((function(t){O(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):g(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function O(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const w=p.a+"/api/line/access",v={im:"IM_PC_PUSH_TOPIC"},S=b(b(b({},{shopStatusChange:"shop.status.change",shopCommon:"shop.shop.common"}),{unprocess:"order.order.unprocess",confirm:"order.order.confirm",reject:"order.order.reject",user_cancel:"order.order.user_cancel",cs_cancel:"order.order.cs_cancel",food_prepared:"order.order.food_prepared",exception:"order.order.exception",clearFailOrder:"order.order.settle_invalid",systemCancel:"order.order.system_cancel",deliveryStatusChanged:"order.status.changed",arbitratingUpdate:"order.order.arbitracting",ugcReminder:"napos.ugc.noreply",exclaimOrder:"napos.order.new_claim",businessOrder:"order.order.company_pickup",warningMessage:"napos.order.warning_message",riderReport:"napos.order.rider_report",shopBusyChange:"shop.busy.change"}),v);var _=()=>{const e=Object(d.j)(["shopId","ksid","loginShopType"]),t=e.shopId,o=void 0===t?"":t,a=e.ksid,i=void 0===a?"":a,c=e.loginShopType,l=d.b.isClient;Object(r.useEffect)(()=>{if("SHOP"!==c)return void d.s.setItem("not-load-order",!0);let e=null;const t={appId:"napos",token:i,rid:o};if(l)e=s()(w,t);else{const r=n(818);e=u()(r,w,t)}e.on(S.warningMessage,e=>{const t=Object(d.j)(["isChain"]).isChain;e&&!t&&h.a.emit("os","order.warning_message",(e=>{const t=(e||{}).data;if(null!==y()(e,"data",null))return{messageId:0,templateName:y()(t,"template.templateName","RICH_CONTENT_TEMPLATE"),arenaMessageId:"",title:y()(t,"templateData.title",""),summary:y()(t,"templateData.content",""),content:y()(t,"templateData.content",""),remindForm:{remindPCList:[{remindPositionPC:"PC_INNER_POPUP",remindPolicyPC:"NO_POLICY",remindContentPC:{remindContentType:"TITLE_SUMMARY",title:y()(t,"templateData.title",""),summary:y()(t,"templateData.content",""),imageUrl:null,hasContent:!0,totalTime:0}}]},actions:{actionList:y()(t,"templateData.buttons",[]).map(e=>({pcUrl:e.pcLink,actionTitle:e.text,textColor:e.textColor,type:e.type})),feedBackActionList:[]},acctId:0,appSystem:"NAPOS",beginDate:"",endDate:"",readStat:"UNREAD",shopList:null,imageUrl:"",tab:"",tabObject:{description:"",tab:""}}})(e))}),e.on(S.unprocess,e=>{window._OSAdaptor.broadcast("order.unprocess",e)}),e.on(S.confirm,e=>{window._OSAdaptor.broadcast("order.confirm",e)}),e.on(S.reject,()=>{window._OSAdaptor.broadcast("order.reject")}),e.on(S.user_cancel,()=>{window._OSAdaptor.broadcast("order.user_cancel")}),e.on(S.cs_cancel,()=>{window._OSAdaptor.broadcast("order.cs_cancel")}),e.on(S.food_prepared,()=>{window._OSAdaptor.broadcast("order.food_prepared","wsMessage")}),e.on(S.exception,()=>{window._OSAdaptor.broadcast("order.exception")}),e.on(S.clearFailOrder,e=>{window._OSAdaptor.broadcast("order.clear_fail_order",e)}),e.on(S.systemCancel,e=>{window._OSAdaptor.broadcast("order.system_cancel",e)}),e.on(S.deliveryStatusChanged,e=>{window._OSAdaptor.broadcast("order.deliveryStatusChanged",e)}),e.on(S.shopStatusChange,e=>{const t="socket.shop."+("open"===e.type?"open":"closed");h.a.emit("os",t,e),window._OSAdaptor.broadcast(t,e)}),e.on(S.arbitratingUpdate,()=>{window._OSAdaptor.broadcast("order.arbitratingUpdate")}),e.on(S.ugcReminder,e=>{e.shopId===String(o)&&f.b.activate(f.a.ugcReminder)}),e.on(S.exclaimOrder,e=>{window._OSAdaptor.broadcast("order.exclaimOrder",e)}),e.on(S.businessOrder,()=>{f.b.activate(f.a.businessOrder)}),e.on(S.shopCommon,e=>{window._OSAdaptor.broadcast("order.common",e)}),e.on(S.riderReport,e=>{window._OSAdaptor.broadcast("shop.riderReport",e);const t=(e||{}).riderReportType;"SHOP_CLOSE"!==t&&"COOK_SLOW"!==t||f.b.activate(f.a.diningOutReminder)}),e.on(S.shopBusyChange,e=>{window._OSAdaptor.broadcast("shop.busyChange",e)}),e.on(v.im,e=>{console.log("IM_PC_PUSH_TOPIC",e),window._OSAdaptor.broadcast(v.im,e);const t=(e||{}).msgTag;if("IMPORTANT_MSG_NOREPLY"===t){if(localStorage.getItem("im.closeImportantUnread"))return}if(["NEW_MSG","COM_MSG","IMPORTANT_MSG_NOREPLY"].includes(t)){const e="IM_"+t;f.a[e]&&f.b.activate(f.a[e])}if("AT_NAPOS"===t){const e="IM_IMPORTANT_MSG_NOREPLY";f.a[e]&&f.b.activate(f.a[e])}});return()=>{var t;d.s.setItem("not-load-order",!0),(null===(t=e)||void 0===t?void 0:t.off)&&(e.off(S.warningMessage),e.off(S.unprocess),e.off(S.confirm),e.off(S.reject),e.off(S.user_cancel),e.off(S.cs_cancel),e.off(S.food_prepared),e.off(S.exception),e.off(S.clearFailOrder),e.off(S.systemCancel),e.off(S.deliveryStatusChanged),e.off(S.shopStatusChange),e.off(S.arbitratingUpdate),e.off(S.ugcReminder),e.off(S.exclaimOrder),e.off(S.businessOrder),e.off(S.shopCommon),e.off(S.riderReport),e.off(v.im))}},[])}},249:function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return a}));const r=window.navigator.userAgent,o=()=>r.toLowerCase().includes("window"),a=()=>{if(o()){if(window.isClient)return(()=>{const e={"4.0":"95","4.10":"98","5.0":"2000",5.1:"XP",5.2:"Server 2003","6.0":"Vista",6.1:"7",6.2:"8",6.3:"8.1","10.0":"10"},t=r.match(/windows\/([^/]+)\s/i),n=t&&t[1];if(n){const t=n.replace("_x64","");return e[t]||t}})()||null;{let t=null;const n=[{s:"Windows 10",r:/(Windows 10.0|Windows NT 10.0)/},{s:"Windows 8.1",r:/(Windows 8.1|Windows NT 6.3)/},{s:"Windows 8",r:/(Windows 8|Windows NT 6.2)/},{s:"Windows 7",r:/(Windows 7|Windows NT 6.1)/},{s:"Windows Vista",r:/Windows NT 6.0/},{s:"Windows Server 2003",r:/Windows NT 5.2/},{s:"Windows XP",r:/(Windows NT 5.1|Windows XP)/},{s:"Windows 2000",r:/(Windows NT 5.0|Windows 2000)/},{s:"Windows ME",r:/(Win 9x 4.90|Windows ME)/},{s:"Windows 98",r:/(Windows 98|Win98)/},{s:"Windows 95",r:/(Windows 95|Win95|Windows_95)/},{s:"Windows NT 4.0",r:/(Windows NT 4.0|WinNT4.0|WinNT|Windows NT)/},{s:"Windows CE",r:/Windows CE/},{s:"Windows 3.11",r:/Win16/}].find(e=>e.r.test(r));var e;if(n)t=(null===(e=/Windows (.*)/.exec(n.s))||void 0===e?void 0:e[1])||null;return t}}return null}},250:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r,o=n(1),a=n(12);function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}!function(e){e.LIABILITY_SEARCH="LIABILITY_SEARCH"}(r||(r={}));const c={[r.LIABILITY_SEARCH]:"按取消单判责搜订单"};t.b=new class{constructor(){i(this,"getSearchLabels",()=>{const e=Object(o.j)(["shopId"]).shopId;return a.e.fetch({module:"fulfill/weborder/getWebClientSettings",service:"OrderWebService",method:"getWebClientSettings",params:{shopId:e},invoke:!1})}),i(this,"getSearchedOrders",({fuzzyPhrase:e})=>{const t=Object(o.j)(["shopId"]).shopId;return a.e.fetch({module:"fulfill/weborder/searchBriefOrder",service:"OrderWebService",method:"searchBriefOrder",params:{fuzzyPhrase:e,shopId:t},invoke:!1})}),i(this,"getSearchedOrdersForChain",e=>{const t=Object(o.j)(["shopId"]).shopId;return a.e.fetch({module:"fulfill/weborder/getBriefOrderByOrderId",service:"OrderWebService",method:"getBriefOrderByOrderId",params:{orderId:e,shopId:t},invoke:!1})})}}},254:function(e,t,n){"use strict";n.d(t,"b",(function(){return y}));var r=n(0),o=n.n(r),a=n(57),i=n(497),c=n(106),s=n(463);Object(s.a)(void 0,!0);const l=o.a.lazy(()=>n.e(8).then(n.bind(null,868))),u=o.a.lazy(()=>n.e(5).then(n.bind(null,869))),p=o.a.lazy(()=>n.e(6).then(n.bind(null,870))),d=o.a.lazy(()=>Promise.all([n.e(0),n.e(3)]).then(n.bind(null,873))),h=o.a.lazy(()=>Promise.all([n.e(0),n.e(10),n.e(7)]).then(n.bind(null,874))),f=o.a.lazy(()=>n.e(4).then(n.bind(null,871))),m=o.a.lazy(()=>Promise.all([n.e(0),n.e(2)]).then(n.bind(null,872))),y=Object(i.a)();t.a=()=>o.a.createElement(c.d,null,o.a.createElement(r.Suspense,{fallback:o.a.createElement(c.e,null)},o.a.createElement(a.Router,{history:y},o.a.createElement(a.Switch,null,o.a.createElement(a.Route,{path:"/login",component:d}),o.a.createElement(a.Route,{path:"/logined",component:f}),o.a.createElement(a.Route,{path:"/ksid-login",component:m}),o.a.createElement(a.Route,{path:"/auth",component:m}),o.a.createElement(a.Route,{path:"/password-reset",component:h}),o.a.createElement(a.Route,{path:["/app/chain/:id/:path","/app/shop/:id/:path","/app/shop/:path","/app"],component:u}),o.a.createElement(a.Route,{exact:!0,path:"/",component:l}),o.a.createElement(a.Redirect,{from:"*",to:"/"}),o.a.createElement(a.Route,{path:"/404",component:p})))))},26:function(e,t,n){"use strict";n.d(t,"a",(function(){return m}));n(41),n(42),n(55),n(29),n(386),n(543),n(48),n(20),n(17);var r=n(348),o=n(1),a=n(11),i=n(104),c=n(175);function s(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,a=void 0;try{for(var i,c=e[Symbol.iterator]();!(r=(i=c.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){o=!0,a=e}finally{try{r||null==c.return||c.return()}finally{if(o)throw a}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return l(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return l(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function l(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function u(e,t,n,r,o,a,i){try{var c=e[a](i),s=c.value}catch(e){return void n(e)}c.done?t(s):Promise.resolve(s).then(r,o)}function p(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var a=e.apply(t,n);function i(e){u(a,r,o,i,c,"next",e)}function c(e){u(a,r,o,i,c,"throw",e)}i(void 0)}))}}function d(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function h(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?d(Object(n),!0).forEach((function(t){f(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):d(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function f(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}let m;!function(e){e.networkDisconnect="networkDisconnect",e.printerDisconnect="printerDisconnect",e.newOrder="newOrder",e.autoProcess="autoProcess",e.booking="booking",e.exception="exception",e.cancel="cancel",e.systemCancel="systemCancel",e.refund="refund",e.urge="urge",e.othersConfirmOrder="othersConfirmOrder",e.printError="printError",e.businessOrder="businessOrder",e.diningOutReminder="diningOutReminder",e.ugcReminder="ugcReminder",e.IM_NEW_MSG="IM_NEW_MSG",e.IM_COM_MSG="IM_COM_MSG",e.IM_IMPORTANT_MSG_NOREPLY="IM_IMPORTANT_MSG_NOREPLY"}(m||(m={}));let y=[],g=null,b=null,O=null,w=1,v={};function S(e){if("string"==typeof e)return{name:e,repeat:3,priority:50,beeper:new r.Howl({src:[window.GLOBAL_ORDER_SOUND[e].prefix+window.GLOBAL_ORDER_SOUND[e].sound[0]],volume:w})};{const t=e.name,n=e.repeat,o=void 0===n?3:n,a=e.priority,i=void 0===a?50:a,c=e.beepType,s=void 0===c?0:c;return{name:t,repeat:o,priority:i,beeper:new r.Howl({src:[window.GLOBAL_ORDER_SOUND[t].prefix+window.GLOBAL_ORDER_SOUND[t].sound[s]],volume:w})}}}const _=()=>{let e=1;return Object(i.b)().then(t=>(t.forEach(t=>{const n=t.type,r=t.value;"volume"===n&&(e=r)}),[e]))},j=()=>{const e=Object.keys(c.b).map(e=>{const t=c.b[e];return{[e]:S({name:e,priority:t.priority,beepType:t.type,repeat:t.times})}}).reduce((e,t)=>h(h({},e),t));return Object(i.c)().then(t=>(t.forEach(t=>{const n=t.name,r=t.type,o=void 0===r?1:r,i=t.times,s=void 0===i?0:i,l=S({name:n,priority:c.b[n].priority,repeat:s,beepType:o});l||Object(a.c)("sound_init","config_empty",{name:n}),e[n]=l}),[e]))},E=(e,t)=>e.config.priority-t.config.priority;function I(e){return e.reduce(function(){var e=p((function*(e,t){const n=t.name;return yield e,g=null,yield Object(o.h)(1e3),O&&O===n?(O=null,Promise.reject(new Error("A sound is playing but no beeper is beeping"))):(e=>{const t=e.beeper;return t.play(),g=e,new Promise((e,n)=>{t.once("end",e),t.once("playerror",e),t.once("stop",e=>n(new Error(e+" is stopped")))})})(t)}));return function(t,n){return e.apply(this,arguments)}}(),Promise.resolve())}function A(){return(A=p((function*(e){e&&e.volume&&(w=e.volume),y=[];try{const e=yield _(),t=s(e,1)[0];w=t;const n=yield j(),r=s(n,1)[0];return v=r,[v,w]}catch(e){return Object(a.c)("sound_init","fail",{error:e}),!1}}))).apply(this,arguments)}function P(e){return-1!==y.findIndex(t=>t.config.name===e)||b&&b===e?Promise.resolve(!0):new Promise((t,n)=>{v[e]||Object(a.c)("sound_activate","load_config_fail",{name:e}),y.push({config:v[e],resolve:t,reject:n}),y.sort(E),function e(){if(0===y.length||b)return null;{const t=y.shift(),n=t.config,r=t.resolve,o=t.reject;if(!n)return Object(a.c)("sound_activate","load_config_fail",{scene:"iterSoundQueue"}),void e();const i=n.repeat,c=n.name,s=new Array(i).fill(n);b=c,I(s).then(r).catch(o).finally(()=>{b=null,e()})}}()})}function T(){return y=[],b?new Promise(e=>{g?(g.beeper.stop(),g.beeper.once("end",()=>e(void 0))):(O=b,e(void 0))}):Promise.resolve()}t.b={config:v,init:function(e){return A.apply(this,arguments)},activate:P,kill:function(e){const t=y.findIndex(t=>t.config.name===e);if(-1!==t){const e=y.splice(t,1);return y.sort(E),Promise.resolve(e[0].config)}return new Promise(t=>{b&&b===e?g?(g.beeper.stop(),g.beeper.once("end",()=>t(g))):(O=e,t(`Sound ${e} has been killed`)):t(void 0)})},killAll:T,testPlay:function(e){return T().then(()=>P(e)).then((...e)=>console.log(...e,"kill")).catch(e=>{throw console.error("testPlay Error",e),e})}}},274:function(e,t,n){e.exports={shopHelp:"shopHelp__LrdNpGfYhhpb6gPvIbrPe",helpIframe:"helpIframe__R_wpdyqSOx9wljyLXcAjz",drawerTitle:"drawerTitle__1_cuJYcvWQmFcF8MWLbd8G"}},30:function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return a})),n.d(t,"g",(function(){return l})),n.d(t,"f",(function(){return p})),n.d(t,"c",(function(){return d})),n.d(t,"d",(function(){return h}));n(20),n(17),n(383);const r=location.host,o=location.host.includes(":");let a,i;!function(e){e.DAILY="daily",e.ALTC="altc",e.PPE="ppe",e.INTERNAL_PROD="production",e.PROD="production",e.GRAY="gray"}(a||(a={})),function(e){e.DAILY="daily",e.ALTC="daily",e.PPE="pre",e.INTERNAL_PROD="prod",e.PROD="prod",e.GRAY="prod"}(i||(i={}));const c=(e=>{if(Object.values(a).includes(e))return"production"===e?"PROD":e.toUpperCase()})(localStorage.getItem("env")),s=[{host:/.+:.+/,env:"LOCAL"},{host:/\.daily.*\.elenet\.me/,env:"DAILY"},{host:/\.altc.*\.elenet\.me/,env:"ALTC"},{host:/^ppe-.*\.ele(net)?\.me/,env:"PPE"},{host:/^(?!ppe-)[^.]+(\.faas)?\.elenet\.me/,env:"INTERNAL_PROD"},{host:/^(?!ppe-)[^.]+(\.faas)?(\.shop)?\.ele\.me/,env:"PROD"},{host:/^(?!ppe-)[^.]-gray+(\.faas)?(\.shop)?\.ele\.me/,env:"GRAY"}].find(e=>e.host.test(r))||{env:"LOCAL"},l=location.host.includes("elenet.me");let u="PROD";u="LOCAL"===s.env?c||"DAILY":l&&c||s.env;const p=a[u]||"production",d=(i[u],"production"===p||"gray"===p),h="melody.shop.ele.me"===location.host;t.e=u},32:function(e,t,n){"use strict";n(55),n(29),n(20),n(17);var r=n(30),o=n(1),a=n(21),i=n(91),c=n(92);function s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function l(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function u(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function p(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?u(Object(n),!0).forEach((function(t){d(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):u(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function d(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const h=i.d.spmA,f=i.d.spmBMap;t.a={log:function(e,t,n){if(!e||!i.b[e])return;const u=window.logParams||Object(o.j)(["shopType","shopId","loginShopTypeV2"]),p=u.shopType,d=u.shopId,h=u.loginShopTypeV2,f=i.b[e],m=f.logkey,y=f.reqMethod,g=f.gmkey,b=n||(void 0===g?"EXP":g),O=d?String(d):"",w=["SAN_DIAN","SHOP"].includes(h)?h:p,v=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?s(Object(n),!0).forEach((function(t){l(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({restaurant_id:O,restaurant_type:w,curShopId:O,curType:w,loginType:h,client:window.isClient?"client":"browser"},t);if(!r.d){if(["MENU_ITEM_OLD","MENU_ITEM"].includes(e))return;return void console.warn("non-prod not send log",m,b,v,y)}Object(c.b)(m,b,{restaurant_id:O,restaurant_type:w,loginShopType:h,gokey:t});const S=(v?Object(a.q)(v):"")+"&_g_encode=utf-8";window.goldlog&&window.goldlog.record(m,b,S,y)},sendPV:(e,t={})=>{const n=window.goldlog_queue||(window.goldlog_queue=[]),a=f[e]||"";if(""===a)return;if(!r.d)return void console.warn("non-prod not send log",h,a);n.push({action:"goldlog.setPageSPM",arguments:[h,a]});const s=window.logParams||Object(o.j)(["shopType","shopId","loginShopTypeV2"]),l=s.shopType,u=s.shopId,d=s.loginShopTypeV2,m=["SAN_DIAN","SHOP"].includes(d)?d:l;Object(c.c)(i.a[e]),n.push({action:"goldlog.sendPV",arguments:[{is_auto:!1},p({restaurant_id:u,restaurant_type:m,curShopId:u,curType:m,loginType:d,client:window.isClient?"client":"browser"},t)]})}}},344:function(e,t,n){"use strict";n.d(t,"a",(function(){return ae}));n(48),n(55),n(41),n(17),n(20),n(42),n(29),n(162);var r=n(83),o=(n(109),n(45)),a=n(434),i=n.n(a),c=n(0),s=n.n(c),l=n(57),u=n(106),p=n(15),d=n(105),h=n(354),f=n(87),m=n(1),y=n(84),g=n(40),b=n(11),O=n(32),w=n(247),v=n(8),S=n(78),_=e=>{const t=location.pathname.match(/app\/chain\/([0-9]+)\//),n=t&&t[1];if("0"===n||n!==e){const t=new RegExp(`(.+)/app/chain/${n}/(.+)`);history.replaceState(null,"",window.location.href.replace(t,`$1/app/chain/${e}/$2`))}},j=n(456),E=n(58),I=(n(316),n(139)),A=n(359),P=n(114);var T=n(138),C=n(355),k=n.n(C);function N(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,a=void 0;try{for(var i,c=e[Symbol.iterator]();!(r=(i=c.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){o=!0,a=e}finally{try{r||null==c.return||c.return()}finally{if(o)throw a}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return R(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return R(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function R(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function M(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function L(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}let D=null;const U=(e,t,n)=>{O.a.log(e,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?M(Object(n),!0).forEach((function(t){L(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):M(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},t),n)},x=()=>{console.log("[survey]: incrementSensorBy MELODY_LEAVE_PC_IM"),Object(T.a)("MELODY_LEAVE_PC_IM")};var H=e=>{const t=e.shopId,n=N(Object(c.useState)(0),2),r=n[0],o=n[1],a=N(Object(c.useState)(!1),2),i=a[0],l=a[1],u=Object(c.useRef)(!1),p=Object(c.useRef)(!1),d=Object(c.useRef)(null),h=Object(c.useRef)(null);Object(c.useEffect)(()=>{let e=null;const t=(t={})=>i?new Promise((n,r)=>{e=e=>{e.errMsg?r(new Error(e.errMsg)):(D.showIm(),n())},D.on("im.createConvRes",e),D.emit("im.createConv",{orderId:t.orderId,scene:t.scene},!0)}):Promise.reject(new Error("您未开启在线联系，请点击去开启"));return v.a.registerMethod("go-im-conversation",t),window.goImConv=t,()=>{e&&D.off("im.createConvRes",e)}},[i]),Object(c.useEffect)(()=>{const e=e=>{const t=d.current;if(!t)return;if(!u.current)return;p.current=!0;const n=e.pageX-t.offsetWidth/2,r=e.pageY-t.offsetHeight/2;t.setAttribute("style",`left:${n}px; top:${r}px`);const o=document.getElementById("imEntryMask");o&&"visible"!==o.style.visibility&&(o.style.visibility="visible")};return document.addEventListener("mousemove",e),()=>document.removeEventListener("mousemove",e)},[]),function(e,t=300){Object(c.useEffect)(()=>{let n=null;const r=()=>{clearTimeout(n),n=setTimeout(e,t)};return window.addEventListener("resize",r),()=>{window.removeEventListener("resize",r)}},[])}(()=>{const e=d.current;e&&e.setAttribute("style","left:90%; top:90%")},300),Object(c.useEffect)(()=>(D=A.b.create(),D.createIm({minWidth:800,isShow:!1,url:P.d,moveable:{resizable:!0}}).mount(),()=>{D.destroyIm()}),[]),Object(c.useEffect)(()=>{U("IM_ENTRY_EXP",{restaurant_id:t})},[]),Object(c.useEffect)(()=>{if(!D)return;const e=m.s.getItem("ksid",{local:!0,cookie:!0});return D.emit(A.a.SET_COOKIE,{auth:{ksid:e,"current-shop-id":t}}),()=>{D.hiddenIm()}},[t]);Object(c.useEffect)(()=>{const e=e=>{o(e)};return D&&D.on("im.unreadCount",e),()=>{D&&D.off("im.unreadCount",e)}},[]),Object(c.useEffect)(()=>(D&&D.on("im.sdk.close",x),()=>{D&&D.off("im.sdk.close",x)}),[]),Object(c.useEffect)(()=>{const e=e=>{l(e)};return D&&D.on("im.statusChange",e),()=>{D&&D.off("im.statusChange",e)}},[]),Object(c.useEffect)(()=>{const e=e=>{e?localStorage.removeItem("im.closeImportantUnread"):localStorage.setItem("im.closeImportantUnread","1")};return D&&D.on("im.importantUnReadChange",e),()=>{D&&D.off("im.importantUnReadChange",e)}},[]),Object(c.useEffect)(()=>{const e=e=>{const t=JSON.stringify({searchType:"orderId",keyWord:e.orderId,searchValue:null});v.a.go("app.shop.order.searchings",{searchInfo:t})};return D&&D.on("im.go-order",e),()=>{D&&D.off("im.go-order",e)}},[]);const f=i?"https://img.alicdn.com/imgextra/i4/O1CN01LvzJj720RW87vSaqC_!!6000000006846-2-tps-116-116.png":"https://img.alicdn.com/imgextra/i4/O1CN01Az3aiq1ikbYEZqpcC_!!6000000004451-2-tps-116-116.png";return s.a.createElement(s.a.Fragment,null,s.a.createElement("div",{className:k.a.imEntry,ref:d,onMouseDown:()=>{u.current=!0,p.current=!1},onMouseUp:()=>{u.current=!1;const e=document.getElementById("imEntryMask");e&&"visible"===e.style.visibility&&(e.style.visibility="hidden")}},s.a.createElement(I.a,{size:"small",offset:[-5,6],style:i?{backgroundColor:"#FA423C"}:{backgroundColor:"#aaa"},count:r},s.a.createElement("div",{className:k.a.imIcon,onClick:()=>{p.current||D&&(U("IM_ENTRY_CLK",{restaurant_id:t}),D.isShow?(D.hiddenIm(),x()):D.showIm())}},s.a.createElement("img",{src:f,alt:"IM"})))),s.a.createElement("div",{id:"imEntryMask",ref:h,style:{position:"fixed",width:"100%",height:"100%",visibility:"hidden",zIndex:149,top:0}}))},B=n(26),G=n(92),q=n(91);const F=(e=location.pathname)=>e.replace(/\/app\/(shop|chain)\/(\d+)\/(.+)/,"$1/id/$3");var W=n(43);var V=()=>{const e=({appName:e,eventName:t,data:n,type:r="MELODY-OS"})=>{"MELODY-OS"===r?window._OSAdaptor.broadcast(t,n):e?v.a.emit(e,t,n):v.a.broadcast(t,n)};Object(c.useEffect)(()=>(v.a.on("forwardEvent",e),()=>{v.a.off("forwardEvent",e)}),[])};var K=()=>{Object(c.useEffect)(()=>(window.chat&&window.chat.on("pc.system.network",e=>{window._OSAdaptor.broadcast("networkAlter",e)}),()=>{window.chat&&window.chat.remove("pc.system.network")}),[])},Y=n(21);var z=()=>{Object(c.useEffect)(()=>(window._OSAdaptor.on("LOGIN_REQUIRED",Y.i),()=>{window._OSAdaptor.off("LOGIN_REQUIRED",Y.i)}),[])},Q=n(94);n(455);function $(e,t,n,r,o,a,i){try{var c=e[a](i),s=c.value}catch(e){return void n(e)}c.done?t(s):Promise.resolve(s).then(r,o)}function J(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var a=e.apply(t,n);function i(e){$(a,r,o,i,c,"next",e)}function c(e){$(a,r,o,i,c,"throw",e)}i(void 0)}))}}function X(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Z(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?X(Object(n),!0).forEach((function(t){ee(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):X(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ee(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function te(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,a=void 0;try{for(var i,c=e[Symbol.iterator]();!(r=(i=c.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){o=!0,a=e}finally{try{r||null==c.return||c.return()}finally{if(o)throw a}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return ne(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ne(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ne(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}const re=()=>"BRAND"===Object(m.j)(["shopType"]).shopType,oe=()=>!!sessionStorage.getItem("hide_wrapper");let ae;window._OSAdaptor=S.a,window.fos=v.a,function(e){e.NAPOS="NAPOS",e.CRM="CRM"}(ae||(ae={}));const ie=e=>{const t=Object(m.j)(["shopType","shopId"]),n=t.shopType,r=void 0===n?"SHOP":n,o=t.shopId;return`/app/${r.toLocaleLowerCase()}/${o}/${e}`},ce=e=>{const t=m.s.getItem("restaurantTree",{session:!0}),a=te(Object(c.useState)([]),2),I=a[0],A=a[1],P=te(Object(c.useState)([]),2),C=P[0],k=P[1],N=te(Object(c.useState)(t||[]),2),R=N[0],M=N[1],L=te(Object(c.useState)(),2),D=L[0],U=L[1],x=te(Object(c.useState)(!0),2),Y=x[0],$=x[1],X=te(Object(c.useState)(Date.now()),1)[0],ee=te(Object(c.useState)(""),2),ne=ee[0],ce=ee[1],se=te(Object(c.useState)(!1),2),le=se[0],ue=se[1],pe=te(Object(c.useState)(!1),2),de=pe[0],he=pe[1],fe=te(Object(c.useState)(ae.NAPOS),2),me=fe[0],ye=fe[1],ge=Object(l.useHistory)(),be=Object(l.useParams)(),Oe=Object(c.useRef)(),we=Object(c.useRef)(!1),ve=te(Object(c.useState)(!1),2),Se=ve[0],_e=ve[1],je=Object(c.useRef)();Object(w.d)(),re()||n.e(11).then((()=>{try{n(1038)}catch(e){Object(b.c)("load_sound","fail",{error:e})}window.GLOBAL_ORDER_SOUND&&B.b.init()}).bind(null,n)).catch(n.oe),V(),K(),z();const Ee=(e,t)=>{const n=location,r=n.pathname,o=n.hash;e!==r+o?(o||v.a.launchApp(null==t?void 0:t.appName,null==t?void 0:t.options),ge.push(e,t)):Object(g.d)("historyPush 重复跳转",e)};Object(c.useEffect)(()=>{Object(j.a)(),O.a.sendPV("main"),Object(T.b)(),Object(G.d)(),Object(G.c)(F())},[]),Object(c.useEffect)(()=>{const e=()=>{};return window.addEventListener("load",e),()=>{window.removeEventListener("load",e)}},[]),Object(c.useEffect)(()=>{let e=!1;v.a.go=(e,t)=>{const n=v.a.currentAppName(),r=(t||{})._onlySync;t=t?i()(t,"_onlySync"):t;if(!v.a.getApp(e))return Object(b.c)("fos","app_null",{appName:e}),void o.b.warning("目标页面无权限或者不存在");const a=Object(W.g)({appName:e,options:t}),c=a.url,s=a.shopId;if(!c)return Object(b.c)("fos","go_url_fail",{appName:e,options:t}),void Object(g.e)("fos.go url获取失败");if(!Object(E.d)(e).shopType)return Object(b.c)("fos","go_type_fail",{appName:e,options:t}),void Object(g.e)("fos.go url获取shopType失败");Object(y.c)({shopId:s}),Ee(c,{appName:e,options:t}),n!==e||r||(Object(b.c)("fos","go_options_diff",{appName:e,options:t}),v.a.launchApp(e,t))},Te("mounted");const t=e=>{const t=()=>{je.current&&clearTimeout(je.current),je.current=setTimeout(()=>{he(!0)},5e3)};"SHOP"===Object(m.j)(["loginShopType"]).loginShopType?"app.shop.order.processing"===(null==e?void 0:e.name)&&t():t()},n=({appName:t})=>{if(t.includes("app.")){if(e)return Object(b.c)("fos","loading_app",{appName:t,scene:"onLaunchNonexistentAppTooFast"}),void o.b.warning("您的点击太快了, 稍后几秒中再试...");Object(b.c)("fos","app_null",{appName:t,scene:"onLaunchNonexistentApp"}),o.b.warning("目标页面无权限或者不存在")}else Object(b.c)("fos","app_invalid",{appName:t,scene:"onLaunchNonexistentApp"}),o.b.warning("目标页面不存在")},r=t=>{e=t.fetching};return v.a.on("fetchApp",r),v.a.on("iframe-loaded",t),v.a.on("launch-nonexistent-app",n),()=>{v.a.go=()=>{},v.a.off("fetchApp",r),v.a.off("iframe-loaded",t),v.a.off("launch-nonexistent-app",n)}},[]),Object(c.useEffect)(()=>{if(!be.id)return;if(we.current)return void Object(g.d)("页面正在加载中... routeParams.id");const e=Object(E.c)().appName;if(!v.a.getApp(e))return Object(b.c)("fos","app_null",{appName:e,scene:"route_id_change"}),void Object(g.e)(`appName ${e} 不存在`);Object(G.d)(),je.current&&clearTimeout(je.current),he(!1),Te("id_change")},[be.id]),Object(c.useEffect)(()=>{if(!be.path)return;if(we.current)return void Object(g.d)("页面正在加载中... routeParams.path");const e=F();O.a.log("SUB_PAGE_OLD",{pathState:e},"EXP"),O.a.log("SUB_PAGE_EXP",{path:e},"EXP");const t=Object(E.c)(),n=t.appName,r=t.options,o=v.a.currentAppName(),a=Object(W.j)(C,n);if(o&&a)return void v.a.suspendApp(o);if(!v.a.getApp(n))return Object(b.c)("fos","app_null",{appName:n,scene:"route_path_change"}),void Object(g.e)(`appName ${n} 不存在`);Object(G.c)(F()),v.a.launchApp(n,r)},[be.path]);const Ie=Object(c.useCallback)(e=>{"NAPOS"===e&&Te("tab_change"),"NAPOS"!==e&&O.a.log("CRM_TAB",{},"CLK"),ye(e)},[]),Ae=function(){var e=J((function*(){const e=yield Object(Q.b)();e&&M(e||[])}));return function(){return e.apply(this,arguments)}}(),Pe=function(){var e=J((function*(){const e=yield Object(Q.f)();U(e)}));return function(){return e.apply(this,arguments)}}(),Te=Object(c.useCallback)(function(){var e=J((function*(e){const t=((e,t,n)=>(r,o)=>{Object(b.a)(e,{w_succ:r,compInitTime:n,scene:t,error:o})})(Date.now(),e,X);$(!0),window.appMainPageLoading=!0,we.current=!0;try{if(!re()){const e=yield Object(Q.a)();e.chainKeeper&&Ae()}const e=Object(m.j)(["shopId","shopType"]),n=e.shopId,r=e.shopType;if(!n||!r)return o.b.error("数据初始化失败, 请刷新重试"),Object(b.c)("app_init_fail","shop-info-null",{shopId:n,shopType:r}),t(0,new Error("shopId or shopType is null")),$(!1),we.current=!1,Object(b.c)("to_login","shop-info-null"),void(location.href=location.origin+"/login");const a=Object(m.j)(["ksid"]).ksid,i="SHOP"!==r?n:null,c="BRAND"===r?n:null;v.a.registerValue("shopId",n),v.a.registerValue("chainId",i),v.a.registerValue("customerId",c),v.a.registerValue("ksid",a),i&&_(i)}catch(e){return Object(b.c)("app_init_fail","get-account",{error:e}),o.b.error("获取账号信息失败, 请刷新重试"),t(0,e),$(!1),we.current=!1,Object(b.c)("to_login","account-fail",{error:e}),void(location.href=location.origin+"/login")}try{const e=yield Object(Q.d)(),n=e.sidebarMenuTree,r=e.noGrayMenuTree,a=e.noGrayMenus,i=e.noGrayApps,c=e.grayMenuList,s=e.grayHideMenuList;Pe(),A(r);const l=Object(W.h)(a);k(l),((e,t)=>{var n;Oe.current&&clearTimeout(Oe.current),v.a.close(),S.a.init(),e.length&&Object(W.k)(e);const r=Object(E.c)(),o=Object(W.j)(t,null!==(n=r.appName)&&void 0!==n?n:"");if(r.appName){const e=v.a.getApp(r.appName);e&&!o?(Object(g.d)("启动路由上的菜单"),v.a.launchApp(e.name,r.options)):Object(b.c)("fos","app_invalid",{appName:r.appName,app:!!e,micro:!!o})}if(!v.a.currentAppName()&&!o){const t=Object(E.g)(),n=v.a.getApp(t)||e[0]||{},r=n.name,o=n.options,a=Object(W.g)({appName:r,options:o},location.search).url;if(!a)return Object(b.c)("fos","go_url_fail",{appName:r,options:o,scene:"scheduleApps"}),void Object(g.d)("获取 URl 失败");Ee(a,{appName:r,options:o})}const a=e.find(e=>"forever"===e.priority);if(a){const e=v.a.getApp(a.name);if(!e)return Object(b.c)("fos","no_resident"),void Object(g.d)("scheduleApps 无常驻菜单");const t=0;Oe.current&&clearTimeout(Oe.current),Oe.current=setTimeout(()=>{v.a.getApp(a.name).isUnloadApp&&(m.s.getItem("not-load-order")||(v.a.loadApp(e.name,Z(Z({},e.options),{},{_loadParamsFromHashQuery:!1})),Oe.current&&clearTimeout(Oe.current)))},t)}})(i,l),$(!1),we.current=!1,t(1),n.length&&Object(Q.c)(n,c,s).then(({finalMenu:e,newApps:t})=>{Object(W.k)(t),A(e)});const u=Object(m.j)(["keeper","isChain"]),p=u.keeper;if(u.isChain||(null==p?void 0:p.chainShop)||null!==(null==p?void 0:p.restaurantUnitType)||_e(!0),!(n&&n.length||r.length))return Object(b.c)("get_menu_fail","empty"),t(0,new Error("menu is empty")),o.b.error("可用菜单为空, 请检查是否已经添加菜单权限"),$(!1),void(we.current=!1)}catch(e){we.current=!1,t(0,e),$(!1),Object(b.c)("app_route","fail",{error:e})}window.appMainPageLoading=!1,re()||Object(m.t)(p.k.checkCrmEntry).then(([e,t])=>{t||(ce(e.redirectUrl||""),ue(e.show))})}));return function(t){return e.apply(this,arguments)}}(),[]),Ce=Object(c.useCallback)((e,t)=>{var n;const r=Object(E.f)(e)||{},o=r.name,a=r.options,i=Object(W.g)({appName:o,options:a}).url;if(!i)return Object(b.c)("menu_clk_fail",t||"",{appName:o,options:a}),void Object(g.e)("url获取失败 handleMenuClick");if(t&&(O.a.log("MENU_ITEM",{menu_name:t,path:e}),"订单处理"===t&&Object(T.a)("MENU_CLK_ORDER")),"顾客评价"===t){const e=Z(Z({},a),{},{_reload:!0});Ee(i,{appName:o,options:e})}else Ee(i,{appName:o,options:a});const c=v.a.currentAppName(),s=q.c[c],l=Object(m.j)(["loginShopType"]).loginShopType===f.a.CHAIN;null==s||null!=s.isChain&&s.isChain!==l||(null===(n=s.exclude)||void 0===n?void 0:n.includes(e))||Object(T.a)(s.action)},[]),ke=Object(c.useCallback)(()=>{const e=v.a.currentAppName(),t=Object(E.e)(),n=t.shopId,r=t.shortPath,o=t.shopTypeLower,a=t.shopType,i=t.stateShopTypeLower;if(!(e&&n&&r&&i))return Object(b.c)("change_shop_fail","before",{shopId:n,shortPath:r,shopTypeLower:o,shopType:a,stateShopTypeLower:i,currentAppName:e}),void Object(g.e)("路由参数有误 shopId, shortPath, shopTypeLower, shopType, stateShopTypeLower",n,r,o,a,i);const c=Object(m.j)(["shopId","shopType"]);if(!c.shopId||!c.shopType)return Object(b.c)("change_shop_fail","after",c),void Object(g.e)("keeper 为空");if(c.shopType!==a){const t=Object(E.b)(c.shopType),r=e.replace(/(app)\.(chainshop|shop)\.(.+)/,`$1.${t.stateShopTypeLower}.$3`);if(v.a.getApp(r)){const e=location.pathname.replace(new RegExp(`${o}/${n}`),`${t.shopTypeLower}/${c.shopId}`),r=location.hash.replace(new RegExp(i),t.stateShopTypeLower);Ee(`${e}${r}`,Z({},Object(E.c)(r)))}else{const e=`/app/${t.shopTypeLower}/${c.shopId}/dashboard`,n="shop"===t.shopTypeLower?"#app.shop.dashboard":"#app.chainshop.dashboard";Ee(`${e}${n}`,{})}}else{const e=c.shopId?String(c.shopId):"",t=location.pathname.replace(new RegExp(n),e),r=location.hash.replace(new RegExp(n),e);Ee(`${t}${r}`,Z({},Object(E.c)(r)))}},[]),Ne=Object(m.j)(["shopId","shopType"]),Re=Ne.shopId,Me=Ne.shopType;return s.a.createElement(r.a,{spinning:Y,size:"large",wrapperClassName:"napos-layout"},!oe()&&s.a.createElement(u.q,{treeData:R,shopInfo:D,entryTabKey:me,crmEntryShow:le,setEntryTabKey:Ie,changeShop:ke,isBrand:re(),isChain:Object(m.j)(["isChain"]).isChain||!1,loading:Y,setLoading:$}),oe()?s.a.createElement("div",{id:"app-container"}):me===ae.NAPOS?s.a.createElement("div",{className:"relative napos-main-container"},Y&&!I.length?s.a.createElement(u.g,null):s.a.createElement(u.f,{data:I,onClick:Ce}),s.a.createElement("div",{id:"app-container"},s.a.createElement("div",{id:"app-container-notice-bar"},!re()&&s.a.createElement(u.j,null)),!Y&&!re()&&Se&&s.a.createElement(u.h,{basis:null==D?void 0:D.basis}),s.a.createElement(h.AppRouter,{NotFoundComponent:s.a.createElement("div",null)},C.map(e=>s.a.createElement(h.AppRoute,{key:e.shortPath,path:ie(e.shortPath),title:e.name,url:e.type===d.a.assets?e.assets:void 0,entry:e.type===d.a.html?e.entry:void 0})))),!re()&&s.a.createElement(u.c,{shopInfo:D,loading:Y})):s.a.createElement("div",{className:"crm-main-container"},s.a.createElement("iframe",{src:ne})),e.children,de&&!Y&&"SHOP"===Me&&s.a.createElement(H,{shopId:Re}))};t.b=s.a.memo(ce)},352:function(e,t,n){e.exports={account:"account__2qUfTjySV1PrHVaTYiFb1p",divider:"divider__2-vWWbmLHHNj3e2Jh6r_Hm","user-name":"user-name__3Bo_YdpMLCoHUS4PKjuapY",userName:"user-name__3Bo_YdpMLCoHUS4PKjuapY"}},355:function(e,t,n){e.exports={imIcon:"imIcon__3Cw6RE9DWr4iNCtm7rzpDn",imEntry:"imEntry__3Qw_CoTCHtRF4KSRMa2Pt"}},356:function(e,t,n){e.exports={container:"container__1UjW0HxKmY4fewaBJbPdjA","napos-navmenu":"napos-navmenu__3293Sk12CcYvhKe5t35vui",naposNavmenu:"napos-navmenu__3293Sk12CcYvhKe5t35vui"}},40:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return i})),n.d(t,"f",(function(){return c})),n.d(t,"d",(function(){return s})),n.d(t,"g",(function(){return l})),n.d(t,"e",(function(){return u}));var r=n(90);const o=()=>{const e=window.navigator.userAgent.match(/ID\/(.+)$/),t=e&&e[1]||void 0,n=window.isClient;return window.deviceId=t,{hasDeviceId:!!t,isClient:n}},a=()=>{const e=r.a.getItem("shopId",{cookie:!0,local:!0});return{loginShopId:r.a.getItem("loginShopId",{local:!0}),shopId:e,deviceId:window.deviceId}},i=()=>({shopName:r.a.getItem("shopName",!0)}),c=e=>{if("string"==typeof e)return e;if(e instanceof Error)try{return JSON.stringify({name:e.name,message:e.message,stack:e.stack})}catch(t){return(null==e?void 0:e.message)||t.message}else try{return JSON.stringify(e)}catch(e){return"unknown error"}},s=(...e)=>{console.log("[NAPOS-PC]:",...e)},l=(...e)=>{console.warn("[NAPOS-PC]:",...e)},u=(...e)=>{console.error("[NAPOS-PC]:",...e)}},43:function(e,t,n){"use strict";n.d(t,"l",(function(){return I})),n.d(t,"d",(function(){return A})),n.d(t,"h",(function(){return P})),n.d(t,"j",(function(){return C})),n.d(t,"f",(function(){return k})),n.d(t,"a",(function(){return N})),n.d(t,"c",(function(){return R})),n.d(t,"b",(function(){return M})),n.d(t,"e",(function(){return L})),n.d(t,"i",(function(){return D})),n.d(t,"k",(function(){return U})),n.d(t,"g",(function(){return x}));n(55),n(29),n(20),n(17);var r=n(105),o=n(1),a=n(40),i=n(8),c=n(58);const s=(e,t)=>e=>{const n=e.type,r=e.path;t(`${window._OSAdaptor.config.appstoreUrl}${r}`),"/appstore/mine"===r&&window._OSAdaptor.broadcast("appstore.mine",{}),"/appstore"===r&&window._OSAdaptor.broadcast("appstore.list",{}),"appstore-mine"===n?window._OSAdaptor.OLD_STORES.RestaurantStore.isChain()?window._OSAdaptor.go("app.chainshop.appstore-mine",{path:r}):window._OSAdaptor.go("app.shop.appstore-mine",{path:r}):window._OSAdaptor.OLD_STORES.RestaurantStore.isChain()?window._OSAdaptor.go("app.chainshop.appstore",{path:r}):window._OSAdaptor.go("app.shop.appstore",{path:r})},l=e=>{window._OSAdaptor.go(".",{path:encodeURIComponent(e)})},u=()=>{window._OSAdaptor.broadcast("goods.reload")},p=function(e){window._OSAdaptor.go(".",{url:encodeURIComponent(e)})},d=(e,{state:t,shopId:n})=>{const r=`${e}${t?"/"+t:""}`,o=r.indexOf("?")>=0?"&shopId="+n:"?shopId="+n;return r+o},h=e=>{window._OSAdaptor.broadcast("bsz-strategy:route-switch",e)},f=e=>{window._OSAdaptor.go(".",{state:e.state,params:e.params,product:e.product})},m=e=>{const t=(e||"").split("/")[3];window._OSAdaptor.go(".",{path:t})},y=e=>{"/app/query"===e&&window._OSAdaptor.go(".")},g=e=>{"/app/processing"===e?window._OSAdaptor.go("app.shop.order.processing"):"/app/query"===e&&window._OSAdaptor.go("app.shop.order.querying")};var b={"app.schainshop.activity.queryBigcoupon":{eventHandler:()=>{window._OSAdaptor.broadcast("reloadPage",{})}},"app.shop.bill":{eventHandler:()=>{window._OSAdaptor.broadcast("fin.switchToBalance",{})},urlHandler:(e,{url:t})=>t?decodeURIComponent(t||""):e},"app.chainshop.billDetail":{urlHandler:(e,{url:t})=>t?decodeURIComponent(t||""):e},"app.shop.billDetail":{urlHandler:(e,{url:t})=>t?decodeURIComponent(t||""):e},"app.chainshop.bill":{urlHandler:(e,{url:t})=>t?decodeURIComponent(t||""):e},"app.shop.enterprise":{urlHandler:(e,{path:t})=>`${e}/#/${(t||"").replace(".","/")}`,eventHandler:({path:e})=>{const t=e=>{window._OSAdaptor.go(".",{path:e.substring(1,e.length)})};window._OSAdaptor.on("path.sync",t);const n=(e||"").replace(".","/");return window._OSAdaptor.broadcast("enterprise.path.sync",{path:n}),()=>{window._OSAdaptor.off("path.sync",t)}}},"app.shop.fnpt":{eventHandler:()=>{window._OSAdaptor.broadcast("switchToFnpt")}},"app.shop.activity.myActivity":{eventHandler:()=>{window._OSAdaptor.broadcast("reloadPage",{})}},"app.chainshop.vipcard":{eventHandler:()=>{window._OSAdaptor.broadcast("reloadPage",{})}},"app.shop.appstore":{eventHandler:(e,t)=>{const n=s(0,t);return window._OSAdaptor.on("app.shop.appstore|appstore.go",n),()=>{window._OSAdaptor.off("app.shop.appstore|appstore.go",n)}}},"app.chainshop.appstore":{eventHandler:(e,t)=>{const n=s(0,t);return window._OSAdaptor.on("app.chainshop.appstore|appstore.go",n),()=>{window._OSAdaptor.off("app.chainshop.appstore|appstore.go",n)}}},"app.shop.appstore-mine":{eventHandler:(e,t)=>{const n=s(0,t);return window._OSAdaptor.on("app.shop.appstore-mine|appstore.go",n),()=>{window._OSAdaptor.off("app.shop.appstore-mine|appstore.go",n)}}},"app.chainshop.appstore-mine":{eventHandler:(e,t)=>{const n=s(0,t);return window._OSAdaptor.on("app.chainshop.appstore-mine|appstore.go",n),()=>{window._OSAdaptor.off("app.chainshop.appstore-mine|appstore.go",n)}}},"app.shop.college":{urlHandler:(e,{articleId:t,categoryId:n})=>`${e}${t?"/article/"+t:""}${n?"/category/"+n:""}`},"app.chainshop.college":{urlHandler:(e,{articleId:t,categoryId:n})=>`${e}${t?"/article/"+t:""}${n?"/category/"+n:""}`},"app.shop.dashboard":{eventHandler:({shopId:e})=>{const t=e=>{e.startsWith("https://melody")&&(window.location.href=e)};return window._OSAdaptor.on("setLocation",t),window._OSAdaptor.broadcast("switchToShopDashboard",{restaurantId:e}),()=>{window._OSAdaptor.off("setLocation",t)}}},"app.shop.feedback":{urlHandler:(e,t)=>{let n="",r=""+e;const o=t.path,a=t.categoryIndex,i=t.issueIndex,c=t.params,s=t.type,l=t.shopId,u=decodeURIComponent(o||""),p=decodeURIComponent(c||"");u&&(r+=""+u,a&&(r+="?categoryIndex="+a,i&&(r+="&issueIndex="+i)));const d=r.lastIndexOf("#")>r.lastIndexOf("?");return n=r.indexOf("&")>-1||r.indexOf("?")>-1?d?`${r}?shopId=${l}`:`${r}&shopId=${l}`:`${r}?shopId=${l}`,p&&(n+="&"+p),"createTicket"===p&&(n=`${window._OSAdaptor.config.feedBackUrl}&shopId=${l}`),"pathModel"===s&&(n=`${e}${u}`),n}},"app.shop.food":{eventHandler:()=>(window._OSAdaptor.on("app.shop.food|path.sync",l),window._OSAdaptor.on("app.shop.food|goods.reloadAll",u),()=>{window._OSAdaptor.off("app.shop.food|path.sync",l),window._OSAdaptor.off("app.shop.food|goods.reloadAll",u)})},"app.chainshop.food":{eventHandler:()=>(window._OSAdaptor.on("app.chainshop.food|path.sync",l),window._OSAdaptor.on("app.chainshop.food|goods.reloadAll",u),()=>{window._OSAdaptor.off("app.chainshop.food|path.sync",l),window._OSAdaptor.off("app.chainshop.food|goods.reloadAll",u)})},"app.chainshop.syncgood":{eventHandler:()=>(window._OSAdaptor.on("app.chainshop.syncgood|path.sync",l),window._OSAdaptor.on("app.chainshop.syncgood|goods.reloadAll",u),()=>{window._OSAdaptor.off("app.chainshop.syncgood|path.sync",l),window._OSAdaptor.off("app.chainshop.syncgood|goods.reloadAll",u)})},"app.shop.menusolution":{eventHandler:()=>(window._OSAdaptor.on("app.shop.menusolution|path.sync",l),window._OSAdaptor.on("app.shop.menusolution|goods.reloadAll",u),()=>{window._OSAdaptor.off("app.shop.menusolution|path.sync",l),window._OSAdaptor.off("app.shop.menusolution|goods.reloadAll",u)})},"app.chainshop.menusolution":{eventHandler:()=>(window._OSAdaptor.on("app.chainshop.menusolution|path.sync",l),window._OSAdaptor.on("app.chainshop.menusolution|goods.reloadAll",u),()=>{window._OSAdaptor.off("app.chainshop.menusolution|path.sync",l),window._OSAdaptor.off("app.chainshop.menusolution|goods.reloadAll",u)})},"app.shop.pack":{eventHandler:()=>(window._OSAdaptor.on("app.shop.pack|url.sync",p),()=>{window._OSAdaptor.off("app.shop.pack|url.sync",p)})},"app.chainshop.pack":{eventHandler:()=>(window._OSAdaptor.on("app.chainshop.pack|url.sync",p),()=>{window._OSAdaptor.off("app.chainshop.pack|url.sync",p)})},"app.shop.vas":{urlHandler:(e,{state:t,product:n,to:r,shopId:o})=>{const a=`${e}${t?"/"+t:""}${n?"/product/"+n:""}${r?"?to="+r:""}`,i=`${a.indexOf("?")>=0?"&":"?"}shopId=${o}`;return a+i},eventHandler:({product:e,_currentSrc:t})=>{const n=h.bind(e);return window._OSAdaptor.on("app.shop.vas|seiya-reload",n),window._OSAdaptor.broadcast("melody-vas:route-switch",t),window._OSAdaptor.on("app.shop.vas|path.sync",f),()=>{window._OSAdaptor.off("app.shop.vas|seiya-reload",n),window._OSAdaptor.off("app.shop.vas|path.sync",f)}}},"app.chainshop.vas":{urlHandler:d,eventHandler:({product:e,_currentSrc:t})=>{const n=h.bind(e);return window._OSAdaptor.on("app.chainshop.vas|seiya-reload",n),window._OSAdaptor.broadcast("melody-vas:route-switch",t),window._OSAdaptor.on("app.chainshop.vas|path.sync",f),()=>{window._OSAdaptor.off("app.chainshop.vas|seiya-reload",n),window._OSAdaptor.off("app.chainshop.vas|path.sync",f)}}},"app.shop.vas.bid":{urlHandler:d,eventHandler:({product:e,_currentSrc:t})=>{const n=h.bind(e);return window._OSAdaptor.on("app.shop.vas.bid|seiya-reload",n),window._OSAdaptor.broadcast("melody-vas:route-switch",t),window._OSAdaptor.on("app.shop.vas.bid|path.sync",f),()=>{window._OSAdaptor.off("app.shop.vas.bid|seiya-reload",n),window._OSAdaptor.off("app.shop.vas.bid|path.sync",f)}}},"app.chainshop.vas.bid":{urlHandler:d,eventHandler:({product:e,_currentSrc:t})=>{const n=h.bind(e);return window._OSAdaptor.on("app.chainshop.vas.bid|seiya-reload",n),window._OSAdaptor.broadcast("melody-vas:route-switch",t),window._OSAdaptor.on("app.chainshop.vas.bid|path.sync",f),()=>{window._OSAdaptor.off("app.chainshop.vas.bid|seiya-reload",n),window._OSAdaptor.off("app.chainshop.vas.bid|path.sync",f)}}},"app.shop.vas.account":{urlHandler:d,eventHandler:({product:e,_currentSrc:t})=>{const n=h.bind(e);return window._OSAdaptor.on("app.shop.vas.account|seiya-reload",n),window._OSAdaptor.broadcast("melody-vas:route-switch",t),window._OSAdaptor.on("app.shop.vas.account|path.sync",f),()=>{window._OSAdaptor.off("app.shop.vas.account|seiya-reload",n),window._OSAdaptor.off("app.shop.vas.account|path.sync",f)}}},"app.chainshop.account":{urlHandler:d,eventHandler:({product:e,_currentSrc:t})=>{const n=h.bind(e);return window._OSAdaptor.on("app.chainshop.account|seiya-reload",n),window._OSAdaptor.broadcast("melody-vas:route-switch",t),window._OSAdaptor.on("app.chainshop.account|path.sync",f),()=>{window._OSAdaptor.off("app.chainshop.account|seiya-reload",n),window._OSAdaptor.off("app.chainshop.account|path.sync",f)}}},"app.chainshop.vas.account":{eventHandler:({product:e,_currentSrc:t})=>{const n=h.bind(e);return window._OSAdaptor.on("app.chainshop.vas.account|seiya-reload",n),window._OSAdaptor.broadcast("melody-vas:route-switch",t),window._OSAdaptor.on("app.chainshop.vas.account|path.sync",f),()=>{window._OSAdaptor.off("app.chainshop.vas.account|seiya-reload",n),window._OSAdaptor.off("app.chainshop.vas.account|path.sync",f)}},urlHandler:(e,{state:t,to:n,params:r,shopId:o})=>{let a=`${e}${t?"/"+t:""}`;n&&(a+="?to="+n),r&&(a+=`${a.indexOf("?")>=0?"&":"?"}${r}`);const i=`${a.indexOf("?")>=0?"&":"?"}shopId=${o}`;return a+i}},"app.shop.vas.adv":{urlHandler:d,eventHandler:({product:e,_currentSrc:t})=>{const n=h.bind(e);return window._OSAdaptor.on("app.shop.vas.adv|seiya-reload",n),window._OSAdaptor.broadcast("melody-vas:route-switch",t),window._OSAdaptor.on("app.shop.vas.adv|path.sync",f),()=>{window._OSAdaptor.off("app.shop.vas.adv|seiya-reload",n),window._OSAdaptor.off("app.shop.vas.adv|path.sync",f)}}},"app.chainshop.vas.adv":{urlHandler:d,eventHandler:({product:e,_currentSrc:t})=>{const n=h.bind(e);return window._OSAdaptor.on("app.chainshop.vas.adv|seiya-reload",n),window._OSAdaptor.broadcast("melody-vas:route-switch",t),window._OSAdaptor.on("app.chainshop.vas.adv|path.sync",f),()=>{window._OSAdaptor.off("app.chainshop.vas.adv|seiya-reload",n),window._OSAdaptor.off("app.chainshop.vas.adv|path.sync",f)}}},"app.chainshop.vas.brand":{urlHandler:(e,{state:t,to:n,params:r,shopId:o})=>{let a=`${e}${t?"/"+t:""}`;"GD"===n&&(a+=r);const i=`${a.indexOf("?")>=0?"&":"?"}shopId=${o}`;return a+i},eventHandler:({product:e,_currentSrc:t})=>{const n=h.bind(e);return window._OSAdaptor.on("app.chainshop.vas.brand|seiya-reload",n),window._OSAdaptor.broadcast("melody-vas:route-switch",t),window._OSAdaptor.on("app.chainshop.vas.brand|path.sync",f),()=>{window._OSAdaptor.off("app.chainshop.vas.brand|seiya-reload",n),window._OSAdaptor.off("app.chainshop.vas.brand|path.sync",f)}}},"app.chainshop.vas.coupon":{urlHandler:d,eventHandler:({product:e,_currentSrc:t})=>{const n=h.bind(e);return window._OSAdaptor.on("app.chainshop.vas.coupon|seiya-reload",n),window._OSAdaptor.broadcast("melody-vas:route-switch",t),window._OSAdaptor.on("app.chainshop.vas.coupon|path.sync",f),()=>{window._OSAdaptor.off("app.chainshop.vas.coupon|seiya-reload",n),window._OSAdaptor.off("app.chainshop.vas.coupon|path.sync",f)}}},"app.shop.order.processing":{eventHandler:()=>(window._OSAdaptor.broadcast("order.switchToProcessing",{}),window._OSAdaptor.on("app.shop.order.processing|path.sync",m),()=>{window._OSAdaptor.off("app.shop.order.processing|path.sync",m)})},"app.chainshop.order.processing":{eventHandler:()=>(window._OSAdaptor.broadcast("order.switchToProcessing",{}),window._OSAdaptor.on("app.chainshop.order.processing|path.sync",m),()=>{window._OSAdaptor.off("app.chainshop.order.processing|path.sync",m)})},"app.shop.order.querying":{eventHandler:()=>(window._OSAdaptor.broadcast("order.switchToQuery",{}),window._OSAdaptor.on("app.shop.order.querying|path.sync",y),()=>{window._OSAdaptor.off("app.shop.order.querying|path.sync",y)})},"app.shop.order.searchings":{eventHandler:()=>(window._OSAdaptor.on("app.shop.order.searchings|path.sync",g),()=>{window._OSAdaptor.off("app.shop.order.searchings|path.sync",g)})},"app.chainshop.order.searching":{eventHandler:()=>(window._OSAdaptor.on("app.chainshop.order.searching|path.sync",g),()=>{window._OSAdaptor.off("app.chainshop.order.searching|path.sync",g)})},"app.chainshop.order.query":{eventHandler:()=>(window._OSAdaptor.broadcast("order.switchToQuery",{}),window._OSAdaptor.on("app.chainshop.order.query|path.sync",y),()=>{window._OSAdaptor.off("app.chainshop.order.query|path.sync",y)})},"app.shop.setting":{eventHandler:()=>{window._OSAdaptor.broadcast("order.switchToSettings",{});const e=e=>{window._OSAdaptor.go(".",{path:encodeURIComponent(e)})};return window._OSAdaptor.on("app.shop.setting|path.sync",e),()=>{window._OSAdaptor.off("app.shop.setting|path.sync",e)}}},"app.shop.shop-info":{urlHandler:(e,{path:t,shopId:n,params:r})=>{const o=decodeURIComponent(t||"");if(-1!==o.indexOf("imageUrl"))return`${window._OSAdaptor.config.melodyShopUrl}/#/app/shop/logo/upload?${o.substring(o.indexOf("&")+1)}`;let a="";switch(o){case"index":case"undefined":case"":a=""+window._OSAdaptor.config.melodyShopSpringUrl;break;case"confirm-cooperation":case"confirm-meituan-time":r&&(a=`${window._OSAdaptor.config.melodyShopUrl}/#/app/shop/${t}?params=${r}`);break;case"userinfo":a=""+window._OSAdaptor.config.melodyShopSpringUrl;break;case"identity":a=window._OSAdaptor.config.melodyBaseUrl+"/shop-identity"}return a=`${a}${a.includes("?")?"&":"?"}shopId=${n}`,a},eventHandler:({action:e,pageType:t})=>{const n=e=>{const t=encodeURIComponent(e);window._OSAdaptor.go(".",{path:t})};window._OSAdaptor.on("app.shop.shop-info|path.sync",n);const r=e=>{window._OSAdaptor.go(".",{path:e})};function o(e={}){window._OSAdaptor.broadcast("goFrontPage",e)}window._OSAdaptor.on("app.shop.shop-info|shopStateChange",r),o({action:e,pageType:t});const a=()=>{o({action:e,pageType:t})};window._OSAdaptor.on("app.shop.shop-info|shop.ready",a);const i=e=>{window._OSAdaptor.go(".",{pageType:e})};return window._OSAdaptor.on("app.shop.shop-info|pageType.sync",i),()=>{window._OSAdaptor.off("app.shop.shop-info|path.sync",n),window._OSAdaptor.off("app.shop.shop-info|shopStateChange",r),window._OSAdaptor.off("app.shop.shop-info|shop.ready",a),window._OSAdaptor.off("app.shop.shop-info|pageType.sync",i)}}},"app.shop.welfare":{eventHandler:()=>{window._OSAdaptor.broadcast("switchToWelfare",{})}},"app.shop.delivery":{eventHandler:()=>{window._OSAdaptor.broadcast("melodyDeliveryReload")}},"app.shop.stats.food":{eventHandler:({path:e})=>{"single/physical"===decodeURIComponent(e||"")&&window._OSAdaptor.broadcast("goods.switchToPhysical",{});const t=e=>{const t=encodeURIComponent(e);window._OSAdaptor.go(".",{path:t})};return window._OSAdaptor.on("app.shop.stats.food|path.sync",t),()=>{window._OSAdaptor.off("app.shop.stats.food|path.sync",t)}},urlHandler:(e,{path:t,shopId:n})=>{let r=`${e}/${decodeURIComponent(t||"")}?shopId=${n}`;const o=window._OSAdaptor.OLD_STORES.RestaurantStore.getCurrentRestaurant();return"NEW_RETAIL"===(o&&o.classificationEnum)&&(r=`${window._OSAdaptor.config.melodyStatsUrl}/app/single/stats/food?shopId=${n}`),r}},"app.shop.taskCenter":{eventHandler:()=>{window._OSAdaptor.broadcast("enterTaskCenterPage")}},"app.shop.alsc-school":{urlHandler:(e,t)=>{const n=t.courseId,r=t.categoryId,o=t.shopId;return n?`${e}course.html?id=${n}&from=naposPC&shopId=${o}`:r?`${e}category.html?id=${r}&from=naposPC&shopId=${o}`:`${e}?from=naposPC&shopId=${o}`}},"app.chainshop.alsc-school":{urlHandler:(e,{courseId:t,categoryId:n})=>t?`${e}course.html?id=${t}&from=naposPC`:n?`${e}category.html?id=${n}&from=naposPC`:e+"?from=naposPC"},"app.shop.notice":{urlHandler:(e,{detail:t,customUrl:n})=>{if(t){const n=e.split("?");return`${n[0]}/${t}?${n[1]}`}return n||e}},"app.chainshop.notice":{urlHandler:(e,{detail:t,customUrl:n})=>{if(t){const n=e.split("?");return`${n[0]}/${t}?${n[1]}`}return n||e}}},O=n(30);n(455);function w(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}function v(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function S(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?v(Object(n),!0).forEach((function(t){_(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):v(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function _(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const j=o.b.isClient,E=(e,t=O.f)=>{const n=Object(o.q)(e.parameters);if("ppe"===t)return n.ppeUrl||e.url.replace(/(https?:\/\/)(.+)\.ele\.me(.*)/,"$1ppe-$2.ele.me$3");if("daily"===t)return e.url;if("altc"===t){const t=e.url.includes("__stable");return n.altcUrl||(t?e.url:"")||e.url.replace(/(https?:\/\/.+)\.faas\.daily.elenet\.me(.*)/,"$1.faas.altc.elenet.me$2").replace(/(https?:\/\/.+)\.daily.elenet\.me(.*)/,"$1.faas.altc.elenet.me$2")}return e.url},I=e=>(["gray","production"].includes(O.f)||e.forEach(e=>{e.childMenus&&e.childMenus.length?e.childMenus.forEach(e=>{e.url=E(e,O.f)}):e.url=E(e,O.f)}),e);const A=e=>e.map(e=>function e(t,n){const r=S({},t);return delete r[n],Array.isArray(t[n])&&t[n].length>0?[r].concat(t[n].map(t=>e(t,n)).reduce((e,t)=>e.concat(t),[])):[r]}(e,"children")).reduce((e,t)=>e.concat(t),[]),P=e=>e.filter(e=>e.parametersMap.type&&T(e.parametersMap.type)).map(e=>{const t=e.name,n=e.parametersMap,o=n.assets,a=void 0===o?"":o,i=n.entry,c=void 0===i?"":i,s=n.shortPath,l=n.type,u=void 0===l?r.a.assets:l,p=n.srefState;return{name:t,srefState:void 0===p?"":p,assets:a.split(","),entry:c,shortPath:s,type:u}}),T=e=>e===r.a.assets||e===r.a.html,C=(e,t)=>-1!==e.findIndex(e=>e.srefState===t),k=(e,t)=>{if(!e||!e.length)return[];const n=t||Object(o.j)(["keeper","shopType"]),r=n.keeper,a=n.shopType;return r?e.map(e=>{const t=Object(o.q)(e.parameters),n=e.childMenus,i=e.iconUrl,c=w(e,["childMenus","iconUrl"]);return!!((e,t)=>{const n=j?"client":"browser",r=t||Object(o.j)(["keeper","shopType"]),a=r.keeper,i=r.shopType;if(!a)return!1;const c=a.chainKeeper,s=a.chainShop,l=a.restaurantUnitType;let u="";c?"SHOP"===i&&(u="switch"):u=s&&l?"chainShop":"shop";const p=e.displayTerminal.includes(n),d="SHOP"!==i||!e.displaySingShopType||e.displaySingShopType.includes(u),h=!O.c||!e.onlyPpe;return e.enabled&&p&&d&&h})(t,{keeper:r,shopType:a})&&S(S({},c),{},{icon:i,parametersMap:t,children:k(n||[],{keeper:r,shopType:a})})}).filter(e=>{var t;return(null==e||null===(t=e.parametersMap)||void 0===t?void 0:t.isCatalog)?e.children.length:e}):[]},N=(e,t)=>e.map(e=>{const n=e.parametersMap.customGray,r=e.id,o=e.children;return n?!!t[r]&&S(S({},e),{},{children:N(o||[],t)}):S(S({},e),{},{children:N(o||[],t)})}).filter(e=>{var t;return(null==e||null===(t=e.parametersMap)||void 0===t?void 0:t.isCatalog)?e.children.length:e}),R=e=>{if(!e||!e.length)return{noGrayMenuTree:[],grayMenuList:[],grayHideMenuList:[],noGrayHideMenuList:[]};const t=[],n=[],r=[],o=e=>e.map(e=>{const a=e.children,i=e.parametersMap,c=!!(null==a?void 0:a.length);return i.isShow?i.customGray?(t.push(e),!1):S(S({},e),{},{children:o(e.children)}):i.customGray?(c?n.push(...a):n.push(e),!1):(c?r.push(...a):r.push(e),!1)}).filter(e=>{var t;return(null==e||null===(t=e.parametersMap)||void 0===t?void 0:t.isCatalog)?e.children.length:e});return{noGrayMenuTree:o(e),grayMenuList:t,grayHideMenuList:n,noGrayHideMenuList:r}},M=e=>{const t=[];return{sidebarMenuTree:e.filter(e=>!!e.parametersMap.isShow||(t.push(...e.children),!1)).map(e=>S(S({},e),{},{children:e.children.filter(e=>!!e.parametersMap.isShow||(t.push(e),!1))})).filter(e=>!e.parametersMap.isCatalog||e.children.length),hideMenuList:t}},L=e=>{const t=e.url,n=e.parametersMap;return{type:n.type,name:""+n.srefState,url:t,priority:n.iframeIsResident?"forever":"temporary",options:{_query:(e=>{const t=Object(c.f)(e);return t&&t.options})(n["ui-sref"])},_options:{cache:n.iframeUseCache,sandbox:n.sandbox,auto_params_sync2_query:n.auto_params_sync2_query},shortPath:n.shortPath}},D=e=>e.map(L).filter(e=>e.name&&e.url&&e.shortPath&&!T(e.type||r.a.iframe)),U=e=>{const t=i.a.getApps().reduce((e,{name:t})=>S(S({},e),{},{[t]:1}),{}),n=e.filter(({name:e})=>!t[e]&&(t[e]=1,!0)).map(e=>S(S({},e),{},{_options:S(S({},b[e.name]),e._options)}));i.a.registerAll(n,!1)},x=({id:e,appName:t,options:n},r)=>{const i=Object(o.j)(["shopId"]).shopId,s=n&&n.restaurantId||e||i;if(!t||!s)return Object(a.e)("getFosGoParam: id or appName empty _id",s||"空","appName",t||"空"),{};const l=Object(c.d)(t);return{url:`/app/${l.shopTypeLower}/${s}/${l.shortPath}${r||""}${Object(c.a)(t,n)}`,shopId:s}}},455:function(e,t,n){},456:function(e,t,n){"use strict";var r=n(1),o=n(84),a=n(11);t.a=()=>{const e=localStorage.getItem("old-shell"),t=localStorage.getItem("shopId"),n=t?Number(t):void 0,i=localStorage.getItem("ksid");if(e&&localStorage.removeItem("old-shell"),e&&localStorage.setItem("new-shell","1"),i&&n)return((e,t,n)=>{try{const i=Object(r.j)(["keeper"]).keeper;i||Object(a.c)(n?"hack_set_keeper":"old_to_new","keeper_null");const c=(i||{}).shopId;Object(o.c)({ksid:e,keeper:i,shopId:t||c})}catch(e){Object(a.c)(n?"hack_set_keeper":"old_to_new","fail",{error:e})}})(i,n,!0);location.href=location.origin+"/login"}},463:function(e,t,n){"use strict";n(41),n(17),n(20),n(42),n(29);function r(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,a=void 0;try{for(var i,c=e[Symbol.iterator]();!(r=(i=c.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){o=!0,a=e}finally{try{r||null==c.return||c.return()}finally{if(o)throw a}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return o(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return o(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}const a=e=>{const t=window.localStorage.getItem("shopId");return/\/__shopId__\//.test(e)&&t?e.replace(/(.+)\/__shopId__\/(.+)/,`$1/${t}/$2`):e};t.a=(e=window.location.href,t)=>{const n=new URL(e),o=n.search,i=n.hash;let c=n.pathname;const s=c.match(/(\/app\/shop\/)([^?#\d]+)/),l=c.match(/(\/app\/shop\/[0-9]+\/)([^/]+\/[^/]+.+)/)||s,u=c.match(/(\/app\/chain-shop\/)(.+)/);if(s&&(c=`${s[1]}__shopId__/${s[2]}`),l||u){let e=c;const n=r(l||u||[],3),p=n[1],d=n[2];if(l)e=p+d.replace(/\//g,"__"),s&&(e=`${p}__shopId__/${d.replace(/\//g,"__")}`);else{const t=0;e=`/app/chain/${window.localStorage.getItem("shopId")||t}/${d.replace(/\//g,"__")}`}const h=a(location.origin+e+o+i);return t&&history.replaceState(null,"",h),{url:h,noOrigin:e+o+i}}if(e.includes("__shopId__")){const t=c;e=a(location.origin+t+o+i)}return{url:e,noOrigin:c+o+i}}},474:function(e,t,n){e.exports={notice:"notice__2nOqqAH3ctH-oQ7YaeHFbM"}},482:function(e,t,n){e.exports={"menu-search-wrap":"menu-search-wrap__2IW1PScZQwl6uAuU7lk-4z",menuSearchWrap:"menu-search-wrap__2IW1PScZQwl6uAuU7lk-4z"}},483:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAGTElEQVR4Xu2bfYhUVRTAf0dN+qBIIrUvysQSC7MspLJSiihq25w3O/RlJmVRklHUqqmkZOUHVpKJWpRoiOzOe5uxClKhhYaEUmKBgplRUFlmVBjS7px4d9+Mdz533s7sLjOz97+ddz/O+d1zz733nLtCjRepcf3pA9BnATVOoG8J1LgB9J4T1DjjEKYhDAdWSoTm3piMXlkC6jIZWA4MMkorByXKiJoAoC4vA3MzlRWnd6yxxyxAXc5DeBMllmumqxqAetwCRvkxlvLfA8OSf4cFoB6XAauB9yXCuq4un263AHV5GmERyukpIZVWlGX0Y1uXAbgcAc417YVV/rKSCEfDgug2ANrCcBIsBO5LE0pZLFFmaTMTSgLgsQXlTqvvvQhTJMLeMBC6BUDg5X1nd7ElzI/040WZxAfG8ZcIwPTh8h1wqTXGzwxktNTxe7EQygpAPc5BjZd/MkOAjbQzT2IcTP5eDgABBN8PPG6N9584DOxxABrnIYTngauswf9EmSdRVmQKVC4ABoJHA0pTagzha4lwdTEQclqAuqxGjJctvigTMipvDpT/Klcn5QRgILQyiBP8YTnaZonm3nJtebIAaJwmhIbiNc+q2Q7ME4fXCvVRbgAGQgtjSbDbsoRXJJJ96CoMwGMb2bNZDI/DwKfAOnH4vLMGYQGY+spuifFPQbAeM1EWpeokqJMGWvO1ybYAG4CwnXYWdKYMylGJsa/TelaFMAA0ztLAvxxCmNXZxUldPgZuC4bbLQ7XdRVAnUTy0wujcClOULOtcoY4vJVvfHW5GfjM+v6gOGzIVb+wBSSYKA1sL0XRvEKGOAdoM/Ppx0tpfXUcevIegdVjA8r9QZut4nBHxQIwDi7OvQgtaUoMYKjU82vOXcblHmCT9W28OOzMrFsRFpAUWls4mwTHLCXWi8PDea0szi6EccH3JeIws6IBGEvouGOkTpTANHF4N6cVxHnGXMFNQw5IlJEVD8Do4jIJ8AJldojDTTkBeAxG+QE41XwfwEip54Bdt6KWgC24umbbvTL4rUEc4nkg7Ee5PPhWLw4fVQcAj4Uoc4wyQqtEqMuzDLYi3B58mykOS6oDgMuNwI5AmcPinIwupVlKnDUm+tzhB96QKM9VB4BNnEkbf6WUGcBZUs/fmVagLo3A4uD3rF2jYn2AmdA4+5FgfQtjckWD1COC4gYAtojDXVVhATUPQLu2BNaKw9SqsAAt1gm6vAM8FuwWSyVifEKqVKwPUHsbhM3icHeec4Ad35guDiurA0D6QSjvdVfj/IRwgVE6x+22Ii0g7Wao7JMoo3PO/iaG0MYvqW/tDJYYv1W0BZgboeIfb4cEh5vZErVCYJZ26vECGpz8quUypC5fQhDiEvxY8CSZSFtOC3DZBVVyHQ4ivn5A5KJA2RMM5MJ8WSB1uQbYY4Gp3IBIkPhYC1aCtZ0RdqYp6wicHkbbKE4qPJZWtbOocKyzCGwu0yvmt1BRYRc/lX5J0O8xlFslSs6EizkhdqTo/BC9n6U6jjI+X/3CAGAnwnLa0z1nIQWLDaKGBODH8m4APqGdyRKzPHsOYdQ16fIngq1vgTQwP5/MnQEoZjLT6yh7fGjisL5Q4zAAzKw2M6EYuOoxFeW9YIc4SIJxErNSZhlCdUdqrGMI4XXaaJQYfqosq4QFUMxMaBOj6M+3Vt2C+YMOMXObUPjkqJmmrASpfwxtlKiVrwvGKzcA7Yj/nQyRK11LjhZDOl+d4ITmp9Lsk5kfxm7MjNyWE4B6zEDNs7uk9ZWWHi8JQhND6c8y4IG0foS3OYVGqeN4ck2X8kQm2be6JjvkvztMluPicEaxOpT1hYg9qLrMBl7NEMTfVab7kZtSLUA/ZBQJVqFWSFzZI1GuLVb5vD4gTAeF6mqcOsRYg/0K9BAJHjXtSnkl5vEFyvXW+H5afkpY2bvNAlIm2sSwYEn4yYxkOUI/niJxMpYf+p2gyzfAFcBRlLkSNXt/6NLtAFIg4qzwzd+S8F/gtOTfXQDwiDkaCzvDPo2zKfUYAOP4POag5u1gVgkLIPRU52nQowAMBNes/zXGA1ilZgAEEPzYvA/hfMOglp7LW85xLP15NojX1dY/TJRr/Zajnx73AeUQupx99AEoJ81K7KvPAipx1sopc81bwP9OWNpf7fgU/QAAAABJRU5ErkJggg=="},485:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAKAAAACgCAMAAAC8EZcfAAAC61BMVEUAAAChwMmlydymyd2ix9uZusutydyQpa6nyt2ny9umyt2szt6lyt6mxtioy+CpzuCQpK+fxtGoy9+ozN+oy92ozN6+1uWozeGqzuGQpa/X5+6QpbBtiqGQpa+QpK6Rpa+Qpa8/XGORpa6Tp7GQpK6RpbCpyNmQpa+Rpa+QpK6QpK7S4uuQpK6Nn6jU3eOQpK6Qpa+QpK6Ppa+Rpa/U5OyTo6ys0OPL4OuRpK6Rpa+HoayQo66Qpa5Lq/CSprGzxc3T4+rT4+vU5OvU5OyVrbqRpK1AXGO0xs6yxM3U5OuQpK7T4+uxxMyrws2QpK6PpK3U5Ouzxs70xbbS4enT4uv8yLc5SEtOk8M2T1W0x8/V5ez9yrrU5Os/W2O1x89UcHrU5OuzxMzS4uquw8vU5Ov4yLj3yrzU5OuyxMs+UFXV5ey0xs7T4urS4+myxMzU5ezU4+uzxMzU5OvV5eyyxMzT5OpbreuVrbnU5Or+y7tdreqZtcVPSUZNqu9Nq+7+y7rT5Ov3xrayw8uavMxLXGBhr+lTZWjH4vE4NzfZx8o0MzPU5Os2NDNCPj3S4+lHZW1piJNYq+ljsOjuwbNhruqrlIyfs7z9yrqzxMxSrO0+OzrIo5b6y7v8yrv9ybyEb2l7aGHF1t2kiH9UrvBTrOxigYyTtdp1fHzT4+r////8/Pz6+vr4+Pj29vayxMxFqfI9WWD09PTS4+rW5ewyMzPc7POZr7qbsbyVqrSvwspAqPKSp7GYrbjZ6fGXrLZGrPe4ytM8Vlzf6/C0x8/9y7uUqLORpa+2ydG6zNTa6/LX5+72+vz/0cDr8PLb6O0+WmFIsPrY6O+xw8zk6+/u8fPB0Nfy8/PL5/trufPP2t/w9vnp8vh7wvbu8/VdtPM5pPDI1dtGY23l7vJRrvL/1sXW3+O+4fun1/nE09pMo+JKirNIfJzc7fZ4s+TqwrZGcYbd5eeju9dImtXPsKXFqqFlcHK2vc9sdXd3Z2JKXFFVAAAAqHRSTlMAAxQpDwwHWEQzLRclGjAbpRI+NR9BCjhHyv5iB+pO8JT8c/rUsjwm+sGJHtwTEeW6nnr37kBQQTOsbi0Z+fTYZVnc1m0d5+a9tYF7cExGOfLwUzEpHhj9+fj18MbCrqyokVAu58+mkIJ2cFZJNyjiz8m/rJ6ak4qFfHFU/OLPtaSYZGFZQisn9d7U0cW2n5KRhVFDM/Xs4qWenIBjWTH84sO/t6WkWkrJe8hxAAAOxElEQVR42uyYz0vbYBjHn7harOs2bKsb/QN6KXiSeeyqhzl0MNGLQ0TnYKKb7oeDHccuOwx23nW3tLaBJuTgIRDaQ9JKC7WtsIkgg4HH/Ql73sTXV5s366HJ8JDPJVu9fHie9/s+TwIBAQEBAQEBAQEBAQEBAQEBAf1xc3Eym80+e5WGa0g6+2J5R1Y0TWuKE283r5lj+sGjCU3VkqKNoqnPZ8NwXRh79m5C1RRRlBFRURQRHzX17TUp4vjml2bVshMb5frPg0LhoFivyaKoTi3C/+LmtutfZneqTcuufHyQQ/IWhTIaVv+boTAzf8ulejtqjeg16sTO1tsj2Iavx+G/sGWYn3je2ekq0RPLP3M2zG+vpIjY5a/gL483SBQHM4Y+IwDEH8NlFh7VmpbeQc7hh5ASis0s+ElkvrOBjzldkua3YX3emLsU3dknVdJc1OP4IXVLcMrPJg9kdKmyBbceViTJ3Ehk9ErlwnBhWSXJbdDm0njYfoS2SFBnwTfCK6ZUMR6mdnXJkKQlokkNhc0nGuopx3k3v2LhRCQkn6fBLzbQb16qSEhGkvAfho7CpOfpVTIzaHe5fsViW/S5hJ8MSX+zvaZje3fDM/jQZ1awkmj4alq1yoda/PNXJOAZJNSmxsAPMCDY3nXSZyMzAHMm2o4I2HRJWpkg7W0cuPhRwRYKEprPwA9uZYzKErlWRt4Y+Fhf0jMJ8iup5Cn6/crn3PuLlEqNc8HqKvhAeAZLNmerpsj/32A1kXUSlcMz5STXw48eQRKTm+A9a6ZkfhOAkUgAYey7jk3e/9HLr0Q7zHrsfUBCnNn7qHp2SAx/9/ArHSkiRX0BXpMiAdnm+WF8zX1qSP1y3X7IL1mkNF+HAfE+IA5CxE9udKght36sgBTlSRo8DoiOAeH8vkr8yrmiTrvM6ocwPwRPIKP2EsDrgOyCA+G95YfXS12SaFLQjudXp25+DJNPFZwZg+DgQ9X2Q/4c2oZ5F7+jhnxF8KOnAVnCgCTAwYOkYvsRfuxTQ6cfbTBDWwavWN/aIgEZBQeTT5OYjzxNxhk1dPrRBjNqXi2Fg7tLuoFLCycg6SkN1wM2fgvmeZf38g6/tiJfFVQm0h6loyMhOicg4Ueq5cdoV2zD024/dgAZ8gJ4QWK+IiHmGicgGGCRLM+MFgpahoU95kcoUz+GMulNPCw/jDB085IE5Dh3ld/7zJD5kYA4qHkzjbftmpgrjpfzaQ33q1z3gnBKDYsF6ndU+iVyaGY9W7EQfQu6eK/SADM/pNChhqUC+tEAc6g+AE/Yzpi6aawJjgaLIgsIW6DzbeP8HHaOCud+iq+CMDD3bc2xJIyTBnMX1HxLkqhh0faTuYJaFnxkFhvc4vmhIQaFGjI/bkj84/NEUlbcXkD2flwYtqkfj0nwj69qV4PzOeqHFDsXhi13P3kRfGPhqSKX+fWzaOvnQTF5emzUeY8wAISPOEMOOH50wBVa1sw7dPHz8d19OALI4hPl6hXtWLAKZDk87MiiO9pb8J7Q0CAgL1RR2WN2vAW1iEE5c7fz6TOmEIsCMr5TYwV0XfBPmR9fcNN7v3gcCFmNnUB+/dj4cCc52b9Qt1/K/mW1Kpd71a9FPfwLcSgSS40AYzAVt/3Gnyflk3/7HeH61wNtWYC+uHPvxkh0NMy2q6FhtiYoeXc/Ot16oH6AvhgbIjde/AYtZ3zoFoSGBXsMsw7z8ovtJX4+H8FExCpbCmyiw2G8Y2zdVRUzzPcj1BsOPe41HYK+iFqCoRhc6nEULJY1+cTV76hH+Tz7uDUyJBDN+EXLh7HHFsJ0Tf7p9oXX7fT58MYUuRuG8OiA7TQyPBShk1OYqskn/C9Y7YZM/XpmOAx9ItwevRG7OzgWupm4HRu9HYILXjflY6dfodguc7vr37ofvR9LxWKxVCQ6IMAl3uE93e3H1XOnOT0O/TL2t10zj3EhjAL4N3Sm2Kqr26peuz30UHqsRVXFtYTEEXfcccYVQtx33FfcxC1uEulS245OtdmkM4Ky668VZ4QQd9z+9GZGKYqyg/7hl2x2djeb/va9733vfd9WWk2GMCDdtA+npS/8Tl66zOn9vQCKpNWkcpSe3uy0mhywAAhegF17mXN2srxyy0/SMLcGjr7LtCdw5XaNC9+Jm5fADvR+iQYTKpndGrUw9INOmbMaTiSnApcvX74QOPqrdkDJNFRZsFp1q/7oTDeZvfdlOfobnK10hYiq5jaUYT+cJDrD/4V/kws9JqLKgEsU1aRVfroKZjY4+3t+DRpU6kIhp25uPRmBMmBC+5LAb/m1qVx9VCEy/lvGDCj5Zb8L4Pf36DU18ItRPN90OPqrNJ86oKRB5n5XBvVCf5teYyadPR/ILHyBTnXQPyCnLfsevAs/sQuUDJi6tcCL/g2N2gxrd7Sk5Erge3bnzzddOBHVDunRP0M0cdzC1U0bnC8pOXuhQSDwUSzQ4AK8wfFoj85t2EOwOOJE/xSiUfM2M4dNaT+yaY8BbBc81aPpyPZTpg0540EcRTpdEcoCiCaNeveaOD60tXnvRk0IhLSR2ojHGVShrEEcdSafgklBfag2yhqgIr4R9FocjVGW0Nhh8X4jiCnJbihL6EYqsW8EkS2Uh7KEvJANfStYSBvVKCtQG+nCNIK4nWmBsoIWBjueRhC5Qm6UFbhhsaUT1EatKBvAlNHaLdIUSZGeKTCjLMBcwNAWq978hWArsUdHMqQKCU+fWTt3FmIoc1QkY9FEQwXWluaPgo21tTWRkE7HkB4kOE32v5+7Yu4ONcoYD0lZxGKPJhJs7RTrI55uLkc0BCFtYacojeDNpO/a0xxrMzZsrNGZ2AmhSGXSBaMWxkKFGKXeyw5cSiWpRQKz4/RHxqIMgVo161pDdllHJcVQGjdXMmplUKwXvJn0XZEUXJN5G+kCw4KNj6aSZihdt4+NxIF3p+34nxJclWGOcTvdnZVhF5vZGNUxBXRrNq+sNPyQ6o4EpefcX40gFyTMGlSBnz1k1Uc9tqhBDF+0hrRz4RWUWVtS1iC+eePsjRL0Y7pwy0wVUSKvPahspYVtJo81tHHzqjYKc46QbIrv5f3mbto8fZ4vVh7zHVj6kzai5RJNue1BZytuH8RspMVtpwu5Ehe4mfSJL1iydtWqNfuerfSXx/ws5b4N2I/aCL/VuUkq6myc7CRdaJq0cr/lCbYUdg3em4WApSsTL8L+JOXTv2/YMujhWxxFm8CPFwRDinTxbSZoQkKy4N5uSNuG2NOn/hTKZ6PvYeLPboUakrSl9OJuFE25P0a4lZAZHhjfg7Dp5f5w2J+KrypKTysNt0VrdaQVTD4LmqJKC8kWMGaNiIXMcGJgHzS7nLcKc5Y+HzxdHY3SI45YMfBrHXHhzqD+k6DXoCtSGaJ53LDoQsKx6N4obLOP1/NfvXELFH3T4flFfBNKBz80i8EPg7OxUZ0UzGOtWEOMH7eFAht1b4F6PgSQDVrFsWMX79+C9Te7/O6zxOjvtBFDC1bEhsGzMarlBSHxhu6IFY+6MLWRLBRu1Np2b9Fh3u/WteMPblQcexCOzSe2n4vHIfVpgIMb54dY9EEnLwhPbOL51CMbtDyh2BNPjF55lxO8f/zq7bvXn9wN+2NLidGJeKInSgO8uMoAxQBwcWvBCaqNUb4woHgiLi0pXDPpCZGKP2VL4+7F+7fvPrl2Kww53o7koxKJRWnbCGWykO7Pc42LE9SSRjwZYk3EqrF4kUDsSsTj8bdhny986+KD2w+O3bh94+LV8LwqUN2JUWnC4C1gKMqdcvzUtWIF+XpOGpIM2VJAQeDq9HkQwYrbV2/c9t+4fysc24iIUYl0i1BPMobUFzeF9Nqgy2tI3Zu7OyjaiQRiNwjCMsTnx8IVEL7btyoqIN/lB2HKSaRbhE6SSp2m2NyqIq68L8foQh2lKxKskYDfqGV9QfDqxWMVFcePPfAD86rAT6BJf02RjqYdppbeT8knjJSJsjqgVpIUiV1GhqaFaiZLtsTjr+/079gvBvvg/evXK26wflDHCI2+tyDNtaXdWhAMWZS2bo0RR0uygLGQJsShbqF36iIhyggHe4H8yorfvCsrLe3/KMY2Ov4DKN/Qd1nPxDZ5umtLs8rjIEOkw6MycxeFFMNQWnbP0eYZmVBEZ3V3V3sNAl1lDs4vLi0tLi7u/xgEU4j169+/46vEoiPqr64tDV7uczeb0hKMtLZ26a62kQytVJtVJg0Zoh21VWY2/ZiR7CaMYFkxRykIfsHL/v1L37x69npo3+9cWxJsNqOQTaeFoYygG7Qo87QykVxURyTCMbZsMGEiyAs+/9Iv9pL9ZnH+nXz+sIxhBCHHcXjZKrVkMolEUrWqRCZp2KG2nYpAiqOkxqkvrClqUgWoA4aEljbiBKGutONYEOS48zD2heAjSDxL2brl0ur1FDx17XSH6op69apXl0pr1GAdZTXmzDBSGpdqRE6VHCApKG/lMHTHQBCrpOKy/LJkCFMNYw/vJAXXN69frVq13Fx4B5BiMePIBT3ODwQBcMzpEDFVyalZq2bNmp8FcaI2TGUCCKJ1yRCW3nn00B/j8fUDP56O4o9+IFgvL2KSfi0oqQWCtWS1vhLEVBErIYRg48GfDEvvPH/cD3j0+E5p0q9saPPPggol6c5UkDDrCsyYAIKo72DIctIxSXHSb3DX+p8EFXMKdF3rZSiIE+z/xYQQROqxHUExDWVl+UPn1P8sWG9GVFlPkakgpg96hBGEII4dnJ+fXwYUF+d37NgxnwUehrYEvZQIWiMzpBkLEi0smiIMQEKgXrZk3dChQw+tX+9evHhxh5aAStW1Oef3qYiraZg5aSMYMuV8KyjHjcFCxAoKBSbPabRckVu/WQopgmA4Y4ZC8a2grHrenDQRxAmtrQ7oCQ5G4HVyaskkVaX1FA3r5uZWY+EVFdyG/bWgBORk3wgCGPrzQIeTy0WwDbPGVWvUkAKcHxgCvCEoArwh+LF6cgJi9y/AAAKc5bhIBENBHdAB4JlfdQQBYhj6z3/+85///Oc//xGKD0YW6oU3zJV6AAAAAElFTkSuQmCC"},487:function(e,t,n){e.exports={"global-center":"global-center__1bhWv5tHmI-4C4_6FDdhVJ",globalCenter:"global-center__1bhWv5tHmI-4C4_6FDdhVJ"}},50:function(e,t){e.exports=ReactDOM},507:function(e,t,n){n(508),e.exports=n(866)},57:function(e,t){e.exports=ReactRouterDOM},58:function(e,t,n){"use strict";n.d(t,"f",(function(){return f})),n.d(t,"h",(function(){return m})),n.d(t,"c",(function(){return g})),n.d(t,"d",(function(){return b})),n.d(t,"e",(function(){return O})),n.d(t,"g",(function(){return w})),n.d(t,"a",(function(){return v})),n.d(t,"b",(function(){return S}));n(55),n(41),n(17),n(20),n(42),n(29);var r=n(1);function o(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}function a(e){return h(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||p(e)||u()}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function c(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){s(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function l(e,t){return h(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,a=void 0;try{for(var i,c=e[Symbol.iterator]();!(r=(i=c.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){o=!0,a=e}finally{try{r||null==c.return||c.return()}finally{if(o)throw a}}return n}(e,t)||p(e,t)||u()}function u(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function p(e,t){if(e){if("string"==typeof e)return d(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?d(e,t):void 0}}function d(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function h(e){if(Array.isArray(e))return e}const f=e=>{if((e||"").split("{").length>2){const t=(e||"").split("("),n=t[0];let o=t[1];o=o.replace(")","");return{name:n,options:Object(r.q)(o)}}{const t=l((e||"").split("({"),2),n=t[0],r=t[1];let o;if(r){o=r.replace("})","").replace(/[ "']/g,"").split(/,/g).reduce((e,t)=>{const n=l(t.split(":"),2),r=n[0],o=n[1];return c(c({},e),{},{[r]:o})},{})}return{name:n,options:o}}},m=e=>e,y=e=>e.replace(/\./g,"__"),g=e=>{const t=l((e||window.location.hash).replace("#","").split("?"),2),n=t[0],r=t[1],o=(i=void 0===r?"":r)?(i||"").split("&").map(e=>e.split("=")).reduce((e,[t,n])=>c(c({},e),{},{[t]:n?decodeURIComponent(n):n}),{}):{};var i;const s=a(n.split("/")),u=s[0],p=s.slice(1),d=p.length?"/"+p.join("/"):"";return{appName:u,appPath:d,options:{_path:d,_query:o}}},b=e=>{const t=(e||g().appName).match(/app\.(shop|chainshop)\.([a-zA-Z_-]+(?:\.[a-zA-Z_-]+)?(?:\.[a-zA-Z_-]+)?)/),n=t&&t[1],r=n&&{shop:"shop",chainshop:"chain"}[n],o=r&&r.toUpperCase(),a=t&&t[2];return{stateShopTypeLower:n,subState:a,shopTypeLower:r,shopType:o,shortPath:y(a||"")}},O=e=>{const t=(e||window.location.pathname).match(/\/app\/(shop|chain)\/(\d+)\/([a-zA-Z_-]+)/),n=t&&t[1],r=n&&{shop:"shop",chain:"chainshop"}[n],o=n&&n.toUpperCase(),a=t&&t[3],i=t&&t[2],c=(e=>e.replace(/__/g,"."))(a||"");return{stateShopTypeLower:r,shopTypeLower:n,shopType:o,shortPath:a,subState:c,shopId:i}},w=e=>{const t=O(e);return`app.${t.stateShopTypeLower}.${t.subState}`},v=(e,t)=>{const n=t||{},a=n._path,i=n._query,s=n._queryStr,l=(n._reload,o(n,["_path","_query","_queryStr","_reload"])),u=s||Object(r.o)(c(c({},i),l));return`#${e}${a||""}${u?"?"+u:""}`},S=e=>{const t={CHAIN:"chainshop",SHOP:"shop",BRAND:"chainshop"}[e];return{shopType:e,shopTypeLower:t.replace("chainshop","chain"),stateShopTypeLower:t}}},595:function(e,t){},68:function(e,t,n){"use strict";n(55),n(29),n(20),n(17);var r=n(251),o=n.n(r),a=n(1),i=n(11),c=n(15),s=n(40),l=n(90);function u(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function p(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?u(Object(n),!0).forEach((function(t){d(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):u(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function d(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class h extends o.a{constructor(){super(),d(this,"inited",void 0),d(this,"messageInterval",void 0),d(this,"unreadCountInterval",void 0),d(this,"on",void 0),d(this,"off",void 0),d(this,"getNoticeNum",()=>c.g.getAllUnReadCount().then(e=>null==e?void 0:e.count).catch(()=>0)),d(this,"getMessageList",e=>c.g.getMessageList(p(p({},e),{},{tab:"16"})).then(e=>{const t=e&&e.messageDetailList||[];return l.a.setItem("noticeList",t),t}).catch(()=>[])),this.inited=!1,this.messageInterval=null,this.unreadCountInterval=null}init(){if(this.inited)return;const e=Object(a.j)(["ksid"]).ksid;if(e){if(!e)return Object(i.c)("notice_ksid_null","fail"),void Object(s.e)("ksid 不存在");this.inited=!0,window.addEventListener("message",e=>{const t=e.data;"crystal.event"===t.type&&super.emit(t.eventName,t.data)}),this.getMessageList({limit:5,offset:0,readStat:"UNREAD"})}}noticePolling(e){const t=t=>{e&&e(t),l.a.setItem("pollingNotices",t)};return c.g.pollingNotify().then(t),this.messageInterval||(this.messageInterval=setInterval(()=>{c.g.pollingNotify().then(t)},12e5)),()=>{clearInterval(this.messageInterval)}}onReaded(e){return super.on("message.readed",e),()=>{l.a.setItem("pollingNotices",[]),super.off("message.readed",e)}}onLinkClicked(e){return super.on("message.actionClicked",e),()=>{l.a.setItem("pollingNotices",[]),super.off("message.actionClicked",e)}}setNotified(e){return c.g.setNotified(e)}setRead(e){return c.g.setReadStatus(e)}getInboxUrl(){return""}getInbox(){return null}}t.a=new h},73:function(e,t,n){e.exports={shopState:"shopState__24EReBmbsBEjlwYTDWuYoB",stateText:"stateText__29t4hI5HJ57bejL-XL25LD",icon:"icon__3Sj-4Qaw9NPleddEDzVxvr",mainStatus:"mainStatus__1eGtRFJxDCO6WEwv1vqDap",minorStatuses:"minorStatuses__kU7dx8KKrxahJHhmWXYx5",dropContent:"dropContent__1kiFQEXruArSvYxZizB6Xe",businessHours:"businessHours__3btQ8kHhbWANgRIoCL2xJe",changeText:"changeText__F0Wx19P-xM-LI2BGmO4K-",tips:"tips__2GwCm_doT2rjbiRwjgqpfj",biz:"biz__21WtTwMKKgbqHS9ZEE8bJ0",opener:"opener__vjoItB-eHYkz2E23q2olu",disabled:"disabled__2V2dqiJjZg-Hx8gll22zFM"}},78:function(e,t,n){"use strict";n(41),n(42),n(55),n(29),n(48),n(20),n(17);var r=n(8),o=n(1),a=n(11),i=n(58);function c(e){return"function"==typeof e}function s(e,t){if(!t)return e;if("object"!=typeof e||null===e)return;const n=t.split(".");return s(e[n[0]],n.slice(1).join("."))}function l(e){return"function"==typeof s(e,"then")}const u=e=>`app.${Object(o.j)(["isChain"]).isChain?"chainshop":"shop"}.order.${e||"processing"}`;n(109);var p=n(45),d=n(68),h=n(26),f=n(94),m=e=>{if(!e)return;const t=window.isClient,n=e.startsWith("https://melody.")||e.startsWith("https://ppe-melody.")||e.startsWith("https://melody-plus.")||e.startsWith("https://ppe-melody-plus."),c=e.startsWith("app.")||e.startsWith("https://app.chainshop.")||e.startsWith("https://app.shop."),s=e.includes("__open_in_client__");if(e.includes("https://melody.faas.ele.me")&&(e=e.replace("https://melody.faas.ele.me","https://melody.shop.ele.me"),Object(a.c)("reach_url","old_url",{url:e})),n)console.warn("please do not use this way"),window.location.href=(e=>{const t=window.localStorage.getItem("shopId"),n=/\/__shopId__\//.test(e)&&t;return Object(a.c)("reach_url",n?"shopId_placeholder":"with_shell_url",{_url:e}),n?e.replace(/(.+)\/__shopId__\/(.+)/,`$1/${t}/$2`):e})(e);else if(c){const t=Object(i.f)(e);if(!t)return void Object(a.c)("reach_url","appState_fail",{url:e});Object(a.c)("reach_url","appState",{url:e});const n=t.name,c=t.options;let s=n;if(s.includes("__shopType__")){const e=Object(o.j)(["isChain"]).isChain;s=n.replace("__shopType__",e?"chainshop":"shop")}r.a.go(s,c)}else if(s){const t=Object(o.j)(["isChain"]).isChain?"app.chainshop.notice":"app.shop.notice";Object(a.c)("reach_url","openInClient",{url:e.replace("__open_in_client__","")}),r.a.go(t,{customUrl:e})}else t?(Object(a.c)("reach_url","launchDefaultBrowser",{url:e}),window.chat&&window.chat.invoke("pc.system.launchDefaultBrowser",{url:e})):(Object(a.c)("reach_url","openInNewTab",{url:e}),window.open(e))};var y={ArenaAction:{getBaseKeeper:()=>new Promise(e=>{e(Object(o.j)(["keeper"]).keeper)}),printOrder:(e,t,n)=>r.a.invoke({service:u(),method:"printOrder",payload:{order:e,autoConfirm:t,alreadyInFailDB:n}}),setAutoProcess:e=>e,melodyRoute:(e,t,n)=>{window._OSAdaptor&&window._OSAdaptor.go(e,t,n)},getReminderOrderCountObj:()=>{try{return r.a.invoke({service:u(),method:"getReminderOrderCountObj"})}catch(e){return Object(a.c)("order_app_non_ready","getReminderOrderCountObj"),{cancel:0,exception:0,refund:0,booking:0,remind:0}}},getNewOrderCount:()=>{try{return r.a.invoke({service:u(),method:"getNewOrderCount"})}catch(e){return Object(a.c)("order_app_non_ready","getNewOrderCount"),0}},broadcastOrderEvent:()=>Promise.resolve("请尽快将订单逻辑迁移出去"),getClientVersion:()=>Promise.resolve(window.clientVersion),getOthersConfig:()=>window.chat&&window.chat.invoke("pc.config.getConfig"),setOthersConfig:e=>window.chat&&window.chat.invoke("pc.config.setConfig",e),setAutoDelivery:e=>{window._OSAdaptor.broadcast("settings.autoDelivery",e)},haveEnabledPrinter2:()=>o.d.haveAvailablePrinter(),reload:()=>{window.location.reload()},routeBySteps(e){window.history.go(e)},getShopTags(){var e,t;return(null===(e=(t=window)._getTagId)||void 0===e?void 0:e.call(t))||{}}},CommentAction:{},LoginAction:{isClientEnv:()=>window.isClient},LoginProfileAction:{},NoticeAction:{setNotified:e=>d.a.setNotified(e),setReaded:e=>d.a.setRead(e)},PayNoticeAction:{},PrintAction:{getGlobalPrintSettings:()=>o.d.getGlobalPrintSettings(),updateGlobalPrintSettings:e=>o.d.updateGlobalPrintSettings(e),getPrinters:()=>o.d.getPrinters(),enablePrinter:e=>o.d.enablePrinter(e),disablePrinter:e=>o.d.disablePrinter(e),updatePrinter:(e,t)=>o.d.updatePrinter({id:e,printSettings:t}),getPrinterSettingsMode:()=>Promise.resolve("advance"),launchDeviceManager:()=>window.chat&&window.chat.invoke("pc.system.launchDeviceManager"),launchPrinterPanel:()=>window.chat&&window.chat.invoke("pc.system.launchPrinterPanel"),clearGlobalPrintSettings:()=>o.d.clearGlobalPrintSettings().then(e=>(e&&p.b.info("修复成功！"),e))},ProfileAction:{},OrderAction:{queryPollingV2(e){r.a.emit(u(),"order.queryPolling",e)},transferNoticeOrderCount:e=>(r.a.emit("os","transferNoticeOrderCount",e),e),getClientVersion:()=>Promise.resolve(window.clientVersion),routeToFeedback(e){location.href=e}},RestaurantAction:{getReferApp:()=>Promise.resolve(sessionStorage.refer_app),fetchRestaurantView:()=>Object(f.e)().then(e=>{if(!e)throw Error("Shell is not ready or current is chain");return e}),fetchRestaurantTree:()=>Object(f.b)(),openClient:e=>{window.chat&&window.chat.invoke("pc.system.launchDefaultBrowser",{url:e})},openService:e=>{window.isClient?window.chat&&window.chat.invoke("pc.system.launchDefaultBrowser",{url:e}):null==window.windowObjectReference||window.windowObjectReference.closed?window.windowObjectReference=window.open(e,"_blank","width=800,height=600",!1):window.windowObjectReference.focus()},openReachUrl(e){m(e)}},SoundAction:{activate:e=>h.b.activate(e),getOption:()=>o.e.getOptionSettings(),getSettings:()=>o.e.getSoundSettings(),updateSettings:e=>o.e.updateSoundSettings(e).then(()=>(h.b.init(),!0)),updateOption:e=>o.e.updateOptionsSettings(e).then(()=>(h.b.init(),!0)),remove:e=>h.b.kill(e),testPlay:e=>h.b.testPlay(e)},StatsAction:{},UgcAction:{},ClientService:{aliSignature:(e,t)=>window.chat&&window.chat.invoke("pc.system.alisignature",e,t),invoke:(e,t)=>window.chat&&window.chat.invoke(e,t),stopFlashWindow:()=>window.chat&&window.chat.invoke("pc.notify.stopFlashWindow"),startFlashWindow:()=>window.chat&&window.chat.invoke("pc.notify.startFlashWindow"),callSwitchToFront:()=>window.chat&&window.chat.invoke("pc.system.callSwitchToFront"),haveAvailablePrinter:()=>o.d.haveAvailablePrinter(),getAvailablePrinters:()=>o.d.getAvailablePrinters(),printOrderByTpl:e=>o.d.printOrderByTpl(e),parsePNG:e=>o.d.parsePNG(e)}},g=n(21),b=n(30),O=n(173),w={RestaurantStore:{getKsid:()=>Object(o.j)(["ksid"]).ksid,isChain:()=>{const e=Object(o.j)(["keeper","loginShopId","keeperId"]),t=e.keeper,n=e.loginShopId,r=e.keeperId,a=(t||{}).chainKeeper;return a?{id:r,restaurantUnitIds:[n]}:a},isMulti:()=>!1,getCurrentRestaurant:()=>{const e=Object(o.j)(["isChain","shopId"]),t=e.isChain,n=e.shopId;return t?null:{id:n}},getChainRestaurantId:()=>{const e=Object(o.j)(["keeper"]).keeper||{},t=e.chainKeeper,n=e.shopId;return t?n:null},getEnv:()=>"gray"===b.f?"production":b.f,getRestaurantView:()=>{if(Object(o.j)(["isChain"]).isChain)return null;const e=Object(o.j)(["shopId"]).shopId,t=o.s.getItem("shopViewMap");return Object(g.f)(t||{},""+e)},canSignature:()=>Object(O.a)(),getChainChildId:()=>Object(o.j)(["shopId"]).shopId,getAllShops:()=>{if(Object(o.j)(["isChain"]).isChain)return null;const e=Object(o.j)(["shopId"]).shopId,t=o.s.getItem("shopViewMap");return Object(g.f)(t||{},e+".basis")},getRestaurantTree:()=>Object(f.b)(),getAllPhotos:()=>[],getShopVideoDevice:()=>({}),getFoodSafetyLevel:()=>({}),getChainShopGray:()=>!0,getLoginShopName:()=>localStorage.getItem("loginShopName"),useNewTaskIntro:()=>window.showNewShopIntro},ArenaStore:{getBaseKeeper:()=>Object(o.j)(["keeper"]).keeper,isClientEnv:()=>window.isClient,getAutoProcessInfo:e=>[Object(g.o)(localStorage.getItem(e+"autoConfirm")),Object(g.o)(localStorage.getItem(e+"autoDelivery"))],getAutoDeliveryInfo:()=>r.a.invoke({service:u(),method:"getAutoDeliveryInfo"}),getPermissions:()=>{const e=Object(o.j)(["keeper"]).keeper;return{permissions:Object(g.f)(e||{},"permissionCodes")||[]}},getUrlQuery:()=>Object(g.g)(),getUmid(){var e,t;return{fire_ua:null===(e=window.fyOBJ)||void 0===e?void 0:e.getUA(),fire_umid:null===(t=window.fyOBJ)||void 0===t?void 0:t.umidToken,umid:window._umid}},getShopTypeExtend(){const e=window.logParams||Object(o.j)(["shopType","loginShopId","loginShopTypeV2"]),t=e.shopType,n=e.loginShopId,r=e.loginShopTypeV2;return{winVersion:window.winVersion,clientType:window.isClient?"client":"web",shopType:t,loginShopId:n,loginShopTypeV2:r}}},GrayStore:{},LoginStore:{getCurrentProfile:()=>window.isClient?window.chat&&window.chat.invoke("pc.profile.getCurrentProfile"):o.s.getItem("currentProfile")||{}},NoticeStore:{getPollingNotices:()=>o.s.getItem("pollingNotices")||[],getNoticeList:()=>o.s.getItem("noticeList")||[]},ProfileStore:{getCurrentProfile:()=>window.isClient?window.chat&&window.chat.invoke("pc.profile.getCurrentProfile"):o.s.getItem("currentProfile")||{}},ShopDeliveryStore:{},StatsStore:{},NavNoticeStore:{getChainGrayInfo:()=>null},OrderPollingStore:{},UtilsStore:{history(e={}){const t=e||{},n=t.method,r=t.params;n&&(Array.isArray(r)?window.history[n](...r):window.history[n](r))},location(e={}){const t=e||{},n=t.method,r=t.params;return n?Array.isArray(r)?window.location[n](...r):window.location[n](r):window.location},localStorage(e={}){const t=e||{},n=t.method,r=t.params;if(n)return Array.isArray(r)?window.localStorage[n](...r):window.localStorage[n](r)},sessionStorage(e={}){const t=e||{},n=t.method,r=t.params;if(n)return Array.isArray(r)?window.sessionStorage[n](...r):window.sessionStorage[n](r)},isNewShell:()=>!0}};const v={[b.a.DAILY]:{appstoreUrl:"https://nest-market.daily.elenet.me",melodyShopSpringUrl:"https://melody-shop-spring.daily.elenet.me",melodyShopUrl:"https://melody-shop.daily.elenet.me",melodyBaseUrl:"https://melody-base.daily.elenet.me",feedBackUrl:"https://help.daily.elenet.me/napos#/createTicket?bizId=145&ticketTypeId=14257&ticketName=站点要求商户关店",melodyStatsUrl:"https://melody-stats.daily.elenet.me/#"},[b.a.ALTC]:{appstoreUrl:"https://nest-market.faas.altc.elenet.me",melodyShopSpringUrl:"https://melody-shop-spring.faas.altc.elenet.me",melodyShopUrl:"https://melody-shop.faas.altc.elenet.me",melodyBaseUrl:"https://melody-base.faas.altc.elenet.me",feedBackUrl:"https://help.altc.elenet.me/napos#/createTicket?bizId=145&ticketTypeId=14257&ticketName=站点要求商户关店",melodyStatsUrl:"https://melody-stats.faas.altc.elenet.me/#"},[b.a.PPE]:{appstoreUrl:"https://ppe-nest-market.faas.ele.me",melodyShopSpringUrl:"https://ppe-melody-shop-spring.faas.ele.me",melodyShopUrl:"https://ppe-melody-shop.faas.ele.me",melodyBaseUrl:"https://ppe-melody-base.faas.ele.me",feedBackUrl:"https://ppe-help.ele.me/napos#/createTicket?bizId=145&ticketTypeId=14257&ticketName=站点要求商户关店",melodyStatsUrl:"https://ppe-melody-stats.faas.ele.me/#"},[b.a.PROD]:{appstoreUrl:"https://nest-market.faas.ele.me",melodyShopSpringUrl:"https://melody-shop-spring.faas.ele.me",melodyShopUrl:"https://melody-shop.faas.ele.me",melodyBaseUrl:"https://melody-base.faas.ele.me",feedBackUrl:"https://help.ele.me/napos#/createTicket?bizId=145&ticketTypeId=14257&ticketName=站点要求商户关店",melodyStatsUrl:"https://melody-stats.faas.ele.me/#"},[b.a.GRAY]:{appstoreUrl:"https://nest-market.faas.ele.me",melodyShopSpringUrl:"https://melody-shop-spring.faas.ele.me",melodyShopUrl:"https://melody-shop.faas.ele.me",melodyBaseUrl:"https://melody-base.faas.ele.me",feedBackUrl:"https://help.ele.me/napos#/createTicket?bizId=145&ticketTypeId=14257&ticketName=站点要求商户关店",melodyStatsUrl:"https://melody-stats.faas.ele.me/#"}};var S=v[b.f]||v[b.a.PROD];function _(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,a=void 0;try{for(var i,c=e[Symbol.iterator]();!(r=(i=c.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){o=!0,a=e}finally{try{r||null==c.return||c.return()}finally{if(o)throw a}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return j(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return j(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function j(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function E(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function I(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?E(Object(n),!0).forEach((function(t){A(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):E(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function A(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const P=new class{constructor(){A(this,"stores",void 0),A(this,"handlers",void 0),A(this,"binder",void 0),A(this,"OLD_STORES",void 0),A(this,"OLD_ACTIONS",void 0),A(this,"config",void 0),this.stores={},this.handlers={}}init(e={}){return this.destroy(!0),this.stores=Object.assign(w,e),this.binder=function(e,t,n,r=!1){return e.addEventListener(t,n,r),function(){e.removeEventListener(t,n,r)}}(window,"message",this.onMessage.bind(this)),this}destroy(e=!1){return this.binder&&this.binder(),this.handlers=e?Object.keys(this.handlers).filter(e=>!e.includes("|")).reduce((e,t)=>I(I({},e),{},{[t]:this.handlers[t]}),{}):{},this.stores={},this}on(e,t){return this.handlers[e]=this.handlers[e]?this.handlers[e].concat(t):[t],this}off(e,t){if(t){const n=(this.handlers[e]||[]).indexOf(t);-1!==n&&this.handlers[e].splice(n,1)}else this.handlers[e]=[];return this}broadcast(e,t){return[].slice.call(document.querySelectorAll("iframe")).forEach(n=>{n.contentWindow&&n.contentWindow.postMessage({eventName:e,data:t,type:"os.event"},"*")}),this}onMessage(e){const t=e.data;switch(t.type){case"os.request":this.response(t,e.source,e.origin);break;case"os.$request":this.$response(t,e.source,e.origin);break;case"os.event":this.handleEvent(t.eventName||"",t.data);break;case"os.state":this.state(t)}}response(e,t,n){const r=_((e.method||"").split("."),2),o=r[0],i=r[1],u=e.params,p=this.stores[o],d={id:e.id,type:"os.response"};let h=!1;const f=Date.now(),m={origin:n,name:e.method,params:u,startTime:f};if(c(s(p,i))){const r=p[i](...u);if(d.result=r,h=l(r),h)return void r.then(r=>{Object(a.b)("MOS_STORE",I(I({},m),{},{response:r})),t&&t.postMessage({id:e.id,type:"os.response",result:r},n)}).catch(r=>{Object(a.b)("MOS_STORE",I(I({},m),{},{error:r})),t&&t.postMessage({id:e.id,type:"os.response",error:{message:null==r?void 0:r.message}},n)});Object(a.b)("MOS_STORE",I(I({},m),{},{response:r})),d.result=r}else{const t=new Error(e.method+" is not defined!");Object(a.b)("MOS_STORE",I(I({},m),{},{error:t})),d.error={message:t.message}}h||t&&t.postMessage(d,n)}$response(e,t,n){const r=_((e.method||"").split("."),2),o=r[0],i=r[1],u=e.params,p=o,d=i;let h;const f=Date.now(),m={origin:n,name:e.method,params:u,startTime:f},g=y[p];if(c(s(y[p],d))){const e=g[d](...u);if(null==e){["ClientService.startFlashWindow","ClientService.stopFlashWindow","ClientService.callSwitchToFront","OrderAction.queryPollingV2","ArenaAction.melodyRoute","ArenaAction.setAutoDelivery","ArenaAction.routeBySteps"].includes(`${p}.${d}`)||Object(a.b)("MOS_ACTION",I(I({},m),{},{error:new Error("empty-response")}))}l(e)?h=e.then(e=>(Object(a.b)("MOS_ACTION",I(I({},m),{},{response:e})),{result:e})).catch(e=>(Object(a.b)("MOS_ACTION",I(I({},m),{},{error:e})),{error:{message:null==e?void 0:e.message}})):(Object(a.b)("MOS_ACTION",I(I({},m),{},{response:e})),h=Promise.resolve({result:e}))}else{const t=new Error(e.method+" is not a function");Object(a.b)("MOS_ACTION",I(I({},m),{},{error:t})),h=Promise.resolve({error:{message:t.message}})}h.then(r=>{t&&t.postMessage({id:e.id,type:"os.$response",result:r.result,error:r.error},n)})}handleEvent(e,t){const n=r.a.currentAppName();(this.handlers[`${n}|${e}`]||this.handlers[e]||[]).forEach(e=>{e(t)})}state(e){const t=e.stateName,n=e.params,r=e.reload;this.go(t||"",n,{reload:r})}go(e,t,{reload:n=!1}={}){const a=(t||n)&&I(I({},t),{},{_reload:n});if("login"===e)Object(o.p)();else if("app.shop"===e)r.a.go("app.shop.dashboard");else if("."===e){const e=r.a.currentAppName();r.a.go(e,I(I({},a),{},{_onlySync:!0}))}else{const t=Object(i.h)(e);r.a.go(t,a)}}};P.OLD_STORES=w,P.OLD_ACTIONS=y,P.config=S;var T=P;t.a=T},8:function(e,t,n){"use strict";var r=n(216);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const a={apps:[],maxAppNum:3,container:"app-container",methods:{},values:{shopId:localStorage.shopId||localStorage.loginShopId,chainId:localStorage.shopId||localStorage.loginShopId},isUseAllowDownloads:!window.isClient,defaultLaunch:!1};r.a.init(a);t.a=r.a;const i=new class{constructor(){o(this,"eventHub",{}),o(this,"on",(e,t)=>{const n=this.eventHub[e]||[];return n.push(t),this.eventHub[e]=n,()=>{this.eventHub[e]=n.filter(e=>e!==t)}}),o(this,"once",(e,t)=>{this.off(e),this.on(e,t)}),o(this,"off",(e,t)=>{if(t){const n=this.eventHub[e].indexOf(t);-1!==n&&this.eventHub[e].splice(n,1)}else this.eventHub[e]=[]}),o(this,"emit",(e,t)=>{(this.eventHub[e]||[]).forEach(e=>e(t))}),o(this,"_once",(e,t)=>{this.on(e,(...n)=>{this.off(e),"function"==typeof t&&t(...n)})})}};window.eventBus=i},80:function(e,t,n){e.exports={"download-file":"download-file__3phnZmQOjUtfLO7ajUASRU",downloadFile:"download-file__3phnZmQOjUtfLO7ajUASRU",header:"header__3FA44z5P7BfJBgZGktmhAI","header-title":"header-title__Rp7OC2RQVjKbu5-FZ42qL",headerTitle:"header-title__Rp7OC2RQVjKbu5-FZ42qL",icon:"icon__1QxzGmAO9gbM4BYv2-9s5",arrow:"arrow__3XjlO2AgP4kqNF-hx6PQpL",close:"close__gJiEkEkDqmf7xdkncd6KP",body:"body__2v_CGJjssuyGDowkri4cLI","body-title":"body-title__3CnKUyiYqYkpLlFZzk9Omh",bodyTitle:"body-title__3CnKUyiYqYkpLlFZzk9Omh","items-wrapper":"items-wrapper__3zBIRu69izVJBzh9Ht-JW_",itemsWrapper:"items-wrapper__3zBIRu69izVJBzh9Ht-JW_",item:"item__W1SstdtftveRXHGD7VJZq","item-content":"item-content__YUWJohtbd75cm1q7ryyxj",itemContent:"item-content__YUWJohtbd75cm1q7ryyxj","item-title":"item-title__2p2GEDENnqiUOY6qF_Msbi",itemTitle:"item-title__2p2GEDENnqiUOY6qF_Msbi",download:"download__sdVbRlMCSsl04YF-XcqsO"}},832:function(e,t,n){},835:function(e,t,n){},84:function(e,t,n){"use strict";n.d(t,"c",(function(){return O})),n.d(t,"b",(function(){return E}));n(48),n(55),n(41),n(42),n(29),n(20),n(17),n(385);var r=n(103),o=n.n(r),a=n(172),i=n(87),c=n(1),s=n(201);function l(e,t,n,r,o,a,i){try{var c=e[a](i),s=c.value}catch(e){return void n(e)}c.done?t(s):Promise.resolve(s).then(r,o)}function u(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function p(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?u(Object(n),!0).forEach((function(t){d(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):u(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function d(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function h(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,a=void 0;try{for(var i,c=e[Symbol.iterator]();!(r=(i=c.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){o=!0,a=e}finally{try{r||null==c.return||c.return()}finally{if(o)throw a}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return f(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return f(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function f(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}const m=["shopId","ksid"],y=["ksid","keeper","loginShopName","shopId","shopName","shopType","isChain","keeperId","loginShopId","loginShopType","loginShopTypeV2","keeperId","username"];function g(e,t){c.s.setItem(e,t,{local:!0}),m.includes(e)&&Object(s.b)(e,Object(c.r)(t))}function b(e){if(window.logParams&&window.logParams[e])return window.logParams[e];const t=c.s.getItem(e,{local:!0});if("isChain"===e&&["false","true"].includes(t))return"true"===t;let n=null;return m.includes(e)&&(n=o.a.get(e),t&&"null"!==t&&"undefined"!==t&&String(t)!==n&&Object(s.b)(e,String(t))),t||n}function O(e){"ksid"in e&&e.ksid&&v({ksid:e.ksid}),Object.entries(e).forEach(e=>{const t=h(e,2),n=t[0],r=t[1];null!=r&&g(n,r)}),e.keeper&&e.keeper.shopId&&w(e.keeper),"shopId"in e&&e.shopId&&(S(e.shopId),window.OPEN_API.setCurrentShopId(e.shopId))}const w=e=>{const t=_(e.keeperType,e.chainKeeper),n=j(e.keeperType,e.chainKeeper,null==e?void 0:e.restaurantUnitType);g("loginShopType",t),g("loginShopTypeV2",n),g("loginShopId",e.shopId),g("keeperId",e.id),v({keeperId:e.id}),S(void 0,e.shopId,t,n)},v=({shopId:e,shopType:t,loginShopType:n,loginShopTypeV2:r,loginShopId:o,ksid:a,keeperId:i}={})=>{if(!window.logParams){const e=b("shopId"),t=b("shopType"),n=b("loginShopType"),r=b("loginShopTypeV2"),o=b("loginShopId"),a=b("ksid"),i=b("keeperId");window.logParams={shopId:e,shopType:t,loginShopType:n,loginShopTypeV2:r,loginShopId:o,ksid:a,keeperId:i}}e&&(window.logParams.shopId=e),t&&(window.logParams.shopType=t),n&&(window.logParams.loginShopType=n),r&&(window.logParams.loginShopTypeV2=r),o&&(window.logParams.loginShopId=o),a&&(window.logParams.ksid=a),i&&(window.logParams.keeperId=i)},S=(e,t,n,r)=>{const o=e||b("shopId"),a=t||b("loginShopId"),c=n||b("loginShopType"),s=r||b("loginShopTypeV2"),l=a==o?c:i.a.SHOP,u=l===i.a.CHAIN;g("shopType",l),g("isChain",u),v({shopId:o,shopType:l,loginShopType:c,loginShopId:a,loginShopTypeV2:s})},_=(e,t)=>{const n={[a.a.BRAND_CENTER]:i.a.BRAND,[a.a.STANDARD]:i.a.CHAIN,[a.a.ROOT]:i.a.CHAIN};return t?n[e]:i.a.SHOP},j=(e,t,n)=>{const r=_(e,t);return r===i.a.SHOP&&null===n?i.b.SAN_DIAN:r};function E(e){return e.reduce((e,t)=>{const n=b(t);return p(p({},e),{},{[t]:n})},{})}const I=function(){var e,t=(e=function*(e){const t=h(yield Object(c.t)(c.a.addProfile,e),2),n=t[0];t[1]||c.a.launchProfile(n)},function(){var t=this,n=arguments;return new Promise((function(r,o){var a=e.apply(t,n);function i(e){l(a,r,o,i,c,"next",e)}function c(e){l(a,r,o,i,c,"throw",e)}i(void 0)}))});return function(e){return t.apply(this,arguments)}}();t.a={setKeeperInfo:O,removeKeeperInfo:function(){window.isClient&&c.a.removeCurrentProfile(),y.forEach(e=>{return t=e,c.s.removeItem(t,{local:!0}),void(m.includes(t)&&o.a.remove(t));var t}),window.logParams=void 0},loginWriteClient:I,ShopType:i.a}},853:function(e,t,n){},864:function(e,t,n){},865:function(e,t){const n=window.navigator,r=n.userAgent,o=n.platform,a="Win32"===o||"Windows"===o,i=/Windows\s*(NT|\/)\s*5\.1/.test(r),c={normal:'-apple-system, BlinkMacSystemFont, "Helvetica Neue", Helvetica, Tahoma, Arial, "PingFang SC", "Heiti SC", "Microsoft YaHei", SimHei, "WenQuanYi MicroHei", sans-serif',windows:'Tahoma, Arial, "Microsoft YaHei", SimHei, sans-serif',windowsXp:"Tahoma, Arial, 宋体, sans-serif"};!function(){const e=c,t=document.querySelector("head"),n=document.createElement("style"),r=a?i?e.windowsXp:e.windows:e.normal;n.type="text/css",n.innerHTML="html, body, button, input, textarea, select { font-family: ".concat(r," !important }"),t.appendChild(n)}()},866:function(e,t,n){"use strict";n.r(t);var r=n(0),o=n(50),a=(n(41),n(20),n(42),n(29),n(48),n(17),n(465)),i=n(11),c=n(40),s=(n(55),n(1));function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function u(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(Object(n),!0).forEach((function(t){p(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function p(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var d=function(e){e.onError((e,t)=>{e.message.includes("receive packet error")&&Object(i.b)("CHAT",{w_succ:0,name:t.method,params:t.params,error:e})});const t=e.invoke.bind(e);return function(e,n,r){const o={name:e,params:n,startTime:Date.now()};try{const a=t(e,n,r);return"Promise"===Object(s.u)(a)?a.then(e=>e).catch(e=>(Object(i.b)("CHAT",u(u({},o),{},{error:e})),Promise.reject(e))):a}catch(e){return Object(i.b)("CHAT",u(u({},o),{},{error:e})),Promise.reject(e)}}},h=n(173),f=n(30),m=n(174),y=n(21);function g(){const e=document.body.querySelector("#app");window.isOverV505Client?(Object(y.a)(e,"over505"),m.a.isMaxWindow().then(e=>{b(!e)}),m.a.isMaximize(()=>{setTimeout(()=>{b(!1)},10)}),m.a.resize(()=>{setTimeout(()=>{b()},10)})):document.body.removeChild(window.CLIENT_TITLE_BAR)}const b=(e=!0)=>{const t=window.CLIENT_TITLE_BAR,n=t.querySelector("#icon-max"),r=t.querySelector("#icon-unmax");r&&n&&(e?(r.style.display="none",n.style.display="inline-flex"):(r.style.display="inline-flex",n.style.display="none"))};function O(e,t,n,r,o,a,i){try{var c=e[a](i),s=c.value}catch(e){return void n(e)}c.done?t(s):Promise.resolve(s).then(r,o)}function w(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var a=e.apply(t,n);function i(e){O(a,r,o,i,c,"next",e)}function c(e){O(a,r,o,i,c,"throw",e)}i(void 0)}))}}function v(){S(),window.setInterval(S,18e5),window.isOverV505Client=Object(s.v)(window.clientVersion,"5.0.5")}function S(){return _.apply(this,arguments)}function _(){return(_=w((function*(){try{const e=yield fetch("//shadow.elemecdn.com/faas/melody-plus/version.js?_dc="+(new Date).valueOf()).then(e=>e.json());window.codeVersion=window.codeVersion||e,window.codeVersion!==e&&(Object(i.c)("check_update","reload"),window.location.reload(!0))}catch(e){Object(i.c)("check_update","fail",{error:e})}}))).apply(this,arguments)}var j=n(358),E=n.n(j),I=n(12);const A=(e,t)=>({invoke:(n,r)=>{const o={service:n.split(".")[0],method:n.split(".")[1],params:r};return t&&(o.module=t),e.fetch(o)}}),P={getCurrentRestaurant(){const e=window._OSAdaptor.OLD_STORES.RestaurantStore;return null==e?void 0:e.getCurrentRestaurant()},getChainRestaurantId(){const e=window._OSAdaptor.OLD_STORES.RestaurantStore;return null==e?void 0:e.getChainRestaurantId()},isChain(){const e=window._OSAdaptor.OLD_STORES.RestaurantStore;return null==e?void 0:e.isChain()}};function T(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,a=void 0;try{for(var i,c=e[Symbol.iterator]();!(r=(i=c.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){o=!0,a=e}finally{try{r||null==c.return||c.return()}finally{if(o)throw a}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return C(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return C(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function C(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function k(e,t,n,r,o,a,i){try{var c=e[a](i),s=c.value}catch(e){return void n(e)}c.done?t(s):Promise.resolve(s).then(r,o)}function N(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var a=e.apply(t,n);function i(e){k(a,r,o,i,c,"next",e)}function c(e){k(a,r,o,i,c,"throw",e)}i(void 0)}))}}function R(){return(R=N((function*(){try{const e=Object(c.a)(),t=e.isClient;if(t!==e.hasDeviceId){const e=t?void 0:{outerWidth:window.outerWidth};Object(i.c)("abnormalEnv",t?"noDeviceId":"notIsClient",e)}if(s.b.isClient){const e=new a.a;e.invoke=d(e),window.chat=e;const t=s.a.getVersionSync(),n=T(t,2)[1];window.clientVersion=n||"1.1.1",Object(h.b)(),v(),g()}else window.chat={invoke:e=>e&&["pc.notify.startFlashWindow","pc.notify.stopFlashWindow","pc.system.callSwitchToFront"].includes(e)?Promise.resolve():Promise.reject(new Error("browser env should not invoke chat")),on:()=>new Error("browser env should not invoke chat"),remove:()=>new Error("browser env should not invoke chat")},window.clientVersion="1.1.1"}catch(e){Object(i.c)("bootstrap","fail",{error:e})}}))).apply(this,arguments)}"function"==typeof E.a&&(window.$ace={arena:A(I.a),buttonwood:A(I.f),buttonwoodSandbox:A(I.f,"sandbox-api")},window.OPEN_API=E()(P)),f.g&&(localStorage.env||localStorage.setItem("env","daily"),n.e(12).then((()=>{const e=n(1037);e&&new e({target:document.body})}).bind(null,n)).catch(n.oe));var M=n(254),L=n(501),D=n(499);const U=()=>{const e=(window.logParams||Object(s.j)(["keeperId"])).keeperId;return e?String(e):void 0};var x=n(92);n(864),n(865);(()=>{const e=f.d?"melody-plus":"melody-plus-test",t=Object(L.a)({options:{system:"NAPOS",terminal:"PC",name:"melody-plus",userId:U,debug:!!localStorage.getItem("debug"),reportInTestEnv:!0,rel:"melody-plus@(2021-08-12 14:15 | 8c25ba03)",reportSucApi:!1},plugins:[[D.a,{bid:e}]]});window.tracker=t})(),(()=>{if(!window.SharedWorker){window.tracker&&window.tracker.report({category:100,msg:"not-support-SharedWorker"});const e=document.querySelector("#app");return e&&(e.innerHTML='<span>当前浏览器版本过低, 请下载Chrome 浏览器访问</span><a target="__blank" href="https://cn.bing.com/search?q=chrome+%E6%B5%8F%E8%A7%88%E5%99%A8&PC=U316&FORM=CHROMN">去下载<a/>'),!1}return!0})()&&function(){return R.apply(this,arguments)}().then(()=>{Object(x.a)(),o.render(r.createElement(M.a,null),document.getElementById("app"))})},87:function(e,t,n){"use strict";let r,o;n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return o})),function(e){e.CHAIN="CHAIN",e.SHOP="SHOP",e.BRAND="BRAND"}(r||(r={})),function(e){e.CHAIN="CHAIN",e.SHOP="SHOP",e.SAN_DIAN="SAN_DIAN",e.BRAND="BRAND"}(o||(o={}))},90:function(e,t,n){"use strict";n(20),n(17);var r=n(103),o=n.n(r),a=n(21);const i={};function c(e,t){const n=t||{},r=n.local,o=void 0!==r&&r,a=n.session,c=void 0!==a&&a,s=n.memory,l=void 0===s||s;o&&localStorage.removeItem(""+e),c&&sessionStorage.removeItem(""+e),l&&delete i[e]}t.a={getItem:function(e,t){const n=()=>i[e],r=()=>Object(a.o)(localStorage.getItem(e)),c=()=>Object(a.o)(sessionStorage.getItem(e)),s=()=>Object(a.o)(o.a.get(e)||null);if("boolean"==typeof t){if(t){return n()||s()||c()||r()}return n()}if("object"==typeof t&&Object(a.k)(t)){const e=t||{},o=e.local,a=void 0!==o&&o,i=e.session,l=void 0!==i&&i,u=e.cookie,p=void 0!==u&&u;return n()||(p?s():null)||(l?c():null)||(a?r():null)}return n()},setItem:function(e,t,n){const r=n||{},o=r.local,c=void 0!==o&&o,s=r.session,l=void 0!==s&&s,u=r.memory,p=void 0===u||u;c&&localStorage.setItem(""+e,Object(a.p)(t)),l&&sessionStorage.setItem(""+e,Object(a.p)(t)),p&&(i[e]=t)},removeItem:c,clear:function(e){Object.keys(i).forEach(t=>{c(t,e)})},keys:function(){return Object.keys(i)}}},91:function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"d",(function(){return c})),n.d(t,"a",(function(){return s})),n.d(t,"e",(function(){return l})),n.d(t,"c",(function(){return u}));n(55),n(29),n(20),n(17);function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const i=o(o(o(o(o(o(o({},{SWITCH_LOGIN_MODE:{logkey:"/napos.login-page.switch_login_mode",gmkey:"CLK",reqMethod:"GET"},SWITCH_VERIFY_MODE:{logkey:"/napos.login-page.switch_verify_mode",gmkey:"CLK",reqMethod:"GET"},LOGIN_PROBLEM_BTN:{logkey:"/napos.login-page.login_problem_btn",gmkey:"CLK",reqMethod:"GET"},MULTI_ACCOUNT_BTN:{logkey:"/napos.login-page.multi_account_btn",gmkey:"CLK",reqMethod:"GET"},FORGET_PASS_BTN:{logkey:"/napos.login-page.forget_pass_btn",gmkey:"CLK",reqMethod:"GET"},SEND_AUTH_CODE_BTN:{logkey:"/napos.login-page.send_auth_code_btn",gmkey:"CLK",reqMethod:"GET"},SEND_VOICE_CODE_BTN:{logkey:"/napos.login-page.send_voice_code_btn",gmkey:"CLK",reqMethod:"GET"},GO_OPEN_SHOP_BTN:{logkey:"/napos.login-page.open_shop_btn",gmkey:"CLK",reqMethod:"GET"},LOGIN_BTN:{logkey:"/napos.login-page.login_btn",gmkey:"CLK",reqMethod:"GET"},APP_DOWNLOAD:{logkey:"/napos.login-page.app_download",gmkey:"CLK",reqMethod:"GET"}}),{LOGINED_CONFIRM_LOGIN:{logkey:"/napos.login-page.logined_confirm_login",gmkey:"CLK",reqMethod:"GET"},OTHER_LOGIN:{logkey:"/napos.login-page.logined_other_login",gmkey:"CLK",reqMethod:"GET"}}),{NEXT_STEP:{logkey:"/napos.login-page.next_step_btn",gmkey:"CLK",reqMethod:"GET"},SUCCESS_PAGE:{logkey:"/napos.login-page.suc_page_exp",gmkey:"EXP",reqMethod:"GET"}}),{noticeForceClick:{logkey:"/napos.napos_page_main.basic_service_touch_click",gmkey:"CLK",reqMethod:"POST"},noticeForceExposed:{logkey:"/napos.napos_page_main.basic_service_touch_exposure",gmkey:"EXP",reqMethod:"POST"},smallBellClk:{logkey:"/napos.napos_page_main.small_bell_clk",gmkey:"CLK",reqMethod:"POST"},touch_Popup_picture:{logkey:"/napos.napos_page_main.touch_Popup_picture",gmkey:"CLK",reqMethod:"GET"},touch_Popup_details:{logkey:"/napos.napos_page_main.touch_Popup_details",gmkey:"EXP",reqMethod:"GET"},touch_popup_details_button:{logkey:"/napos.napos_page_main.touch_popup_details_button",gmkey:"CLK",reqMethod:"GET"},touch_Popup_details_bottom:{logkey:"/napos.napos_page_main.touch_Popup_details_bottom",gmkey:"EXP",reqMethod:"GET"},touch_push_ruo:{logkey:"/napos.napos_page_main.touch_push_ruo",gmkey:"CLK",reqMethod:"GET"},touch_push_qiang:{logkey:"/napos.napos_page_main.touch_push_qiang",gmkey:"EXP",reqMethod:"GET"},touch_push_qiang_button:{logkey:"/napos.napos_page_main.touch_push_qiang_button",gmkey:"CLK",reqMethod:"GET"},touch_xiaohuangtiao:{logkey:"/napos.napos_page_main.touch_xiaohuangtiao",gmkey:"CLK",reqMethod:"GET"}}),{CRM_TAB:{logkey:"/napos.crm-tab.crm-tab",gmkey:"CLK",reqMethod:"GET"},MENU_SEARCH_FOCUS:{logkey:"/napos.shell-main.menu-search-focus",gmkey:"CLK",reqMethod:"GET"},MENU_SEARCH_INPUT:{logkey:"/napos.shell-main.menu-search-input",gmkey:"CLK",reqMethod:"GET"},MENU_SEARCH_CLK:{logkey:"/napos.shell-main.menu-search-click",gmkey:"CLK",reqMethod:"GET"},MENU_ITEM_OLD:{logkey:"/napos-pc.shell-main.menu",gmkey:"CLK",reqMethod:"POST"},MENU_ITEM:{logkey:"/napos.shell-main.menu-item",gmkey:"CLK",reqMethod:"POST"},SUB_PAGE_OLD:{logkey:"/napos-pc.shell-main.subpage",gmkey:"EXP",reqMethod:"GET"},SUB_PAGE_EXP:{logkey:"/napos.shell-main.path_exp",gmkey:"EXP",reqMethod:"GET"}}),{IM_ENTRY_CLK:{logkey:"/napos.napos_page_IM.IM_ICON_Click",gmkey:"CLK",reqMethod:"GET"},IM_ENTRY_EXP:{logkey:"/napos.napos_page_IM.IM_ICON_View",gmkey:"EXP",reqMethod:"GET"}}),{ORDER_SEARCH_CLK:{logkey:"/napos.order-search.order-search-click",gmkey:"CLK",reqMethod:"GET"},SHOP_SWITCHER:{logkey:"/napos.shell-main.shop_switcher",gmkey:"CLK",reqMethod:"GET"},SHOP_STATUS_SWITCHER:{logkey:"/napos.shell-main.shop_status_switcher",gmkey:"CLK",reqMethod:"GET"},HELP_ICON_CLK:{logkey:"/napos.shell-main.help_icon",gmkey:"CLK",reqMethod:"GET"},PRINT_CLK:{logkey:"/napos.shell-main.print",gmkey:"CLK",reqMethod:"GET"},MY_ACCOUNT_CLK:{logkey:"/napos.shell-main.account",gmkey:"CLK",reqMethod:"GET"}}),c={spmA:"a2f1q",spmBMap:{login:"20885741",logined:"20885745",ksid_login:"20885748",login_problem:"20885752",password_reset:"20885755",main:"b1609193",auth:""}},s={login:"登录",logined:"登录账号选择",ksid_login:"KSID 登录",auth:"CRM免登",login_problem:"登录问题",password_reset:"重置密码",main:"主页"},l={MENU_CLK_ORDER:"CHANGE_SHOP",CHANGE_SHOP:"CHANGE_SHOP",LEAVE_ORDER_QUERY:"LEAVE_ORDER_QUERY",NOT_USE_IM_PROD:"NOT_USE_IM_PROD",MELODY_LEAVE_PC_IM:"MELODY_LEAVE_PC_IM"},u={"app.shop.order.querying":{exclude:["app.shop.order.processing"],action:"LEAVE_ORDER_QUERY",isChain:!1}}},92:function(e,t,n){"use strict";n.d(t,"d",(function(){return m})),n.d(t,"a",(function(){return y})),n.d(t,"c",(function(){return b})),n.d(t,"b",(function(){return O}));n(48),n(20),n(17),n(386);var r=n(97),o=n(275),a=n(12),i=n(1),c=n(249),s=n(30);function l(e,t,n,r,o,a,i){try{var c=e[a](i),s=c.value}catch(e){return void n(e)}c.done?t(s):Promise.resolve(s).then(r,o)}function u(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var a=e.apply(t,n);function i(e){l(a,r,o,i,c,"next",e)}function c(e){l(a,r,o,i,c,"throw",e)}i(void 0)}))}}const p="production"===s.f,d="ppe"===s.f,h=function(){var e=u((function*(e){var t;const n=e||(null===(t=window.logParams)||void 0===t?void 0:t.shopId),r=p?o.b:o.a,i=[r.SHOP_CATEGORY_NAME,r.SHOP_LIFE_TYPE,r.SHOP_LIFE__PINZHI_LAYER,r.SHOP_BU_FLAG_NAME,r.SHOP_CITY_NAME],c=yield Object(o.c)({tagIds:i,shopId:n,NaposFetchNcp:a.d,business:"PC外壳"});return{SHOP_CATEGORY_NAME:c[r.SHOP_CATEGORY_NAME]||"当前商户无此标签",SHOP_LIFE_TYPE:c[r.SHOP_LIFE_TYPE]||"当前商户无此标签",SHOP_LIFE__PINZHI_LAYER:c[r.SHOP_LIFE__PINZHI_LAYER]||"当前商户无此标签",SHOP_BU_FLAG_NAME:c[r.SHOP_BU_FLAG_NAME]||"当前商户无此标签",SHOP_CITY_NAME:c[r.SHOP_CITY_NAME]||"当前商户无此标签"}}));return function(t){return e.apply(this,arguments)}}();window._getTagId=h;const f=function(){var e=u((function*({isChain:e,shopId:t}){try{if(!p&&!d||e)console.log("[aemx] getTagId clear"),r.a.setConfig({dim5:null,dim6:null,dim7:null,dim8:null,dim9:null});else{const e=yield h(t);console.log("[aemx] getLoggerTagId",e);const n=e.SHOP_CATEGORY_NAME,o=e.SHOP_LIFE_TYPE,a=e.SHOP_LIFE__PINZHI_LAYER,i=e.SHOP_BU_FLAG_NAME,c=e.SHOP_CITY_NAME;r.a.setConfig({dim5:n,dim6:o,dim7:a,dim8:i,dim9:c})}}catch(e){console.error(e)}}));return function(t){return e.apply(this,arguments)}}(),m=function(){var e=u((function*(){const e=window.logParams||Object(i.j)(["shopId","loginShopType","shopType","loginShopId","loginShopTypeV2"]),t=e.shopId,n=e.loginShopType,o=e.shopType,a=e.loginShopId,c=e.loginShopTypeV2,s=["SAN_DIAN","SHOP"].includes(c)?c:o;console.log("[aemx] updateConfig",t,n,o);try{yield f({shopId:t,isChain:"CHAIN"===o})}catch(e){console.error(e),window.tracker&&window.tracker.reportError(e,{})}r.a.setConfig({uid:t,username:a,user_type:"101",dim1:c,dim2:s,dim3:window.isClient?"client":"web",dim4:window.winVersion,env:"prod"})}));return function(){return e.apply(this,arguments)}}();function y(){return g.apply(this,arguments)}function g(){return(g=u((function*(){try{window.winVersion=Object(c.a)(),r.a.setConfig({requiredFields:["uid"]}),r.a.setAEMPageConfig({business:"PC外壳",platform:r.c.PC,project:"主"})}catch(e){console.error(e),window.tracker&&window.tracker.reportError(e,{})}}))).apply(this,arguments)}const b=e=>{console.log("[aemx] switchPage",Object(r.d)(e)),Object(r.e)({page_id:Object(r.d)(e)})},O=(e,t,n)=>{try{n.gokey||(n.gokey={});const o=Object.keys(n.gokey).sort()||[],a={et:t,c1:t,c2:n.gokey[o[0]],c3:n.gokey[o[1]],c4:n.gokey[o[2]],c5:n.gokey[o[4]],c6:n.gokey[o[5]]};Object(r.b)(e,a)}catch(e){console.error(e)}}},94:function(e,t,n){"use strict";n.d(t,"a",(function(){return O})),n.d(t,"b",(function(){return w})),n.d(t,"e",(function(){return v})),n.d(t,"f",(function(){return E})),n.d(t,"c",(function(){return I})),n.d(t,"d",(function(){return T}));n(55),n(41),n(42),n(29),n(20),n(383),n(48),n(17);var r=n(15),o=n(1),a=n(84),i=n(11),c=n(40),s=n(8),l=n(43);function u(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function p(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?u(Object(n),!0).forEach((function(t){d(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):u(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function d(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function h(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,a=void 0;try{for(var i,c=e[Symbol.iterator]();!(r=(i=c.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){o=!0,a=e}finally{try{r||null==c.return||c.return()}finally{if(o)throw a}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return f(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return f(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function f(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function m(e,t,n,r,o,a,i){try{var c=e[a](i),s=c.value}catch(e){return void n(e)}c.done?t(s):Promise.resolve(s).then(r,o)}function y(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var a=e.apply(t,n);function i(e){m(a,r,o,i,c,"next",e)}function c(e){m(a,r,o,i,c,"throw",e)}i(void 0)}))}}const g={},b=(e,t)=>{g[e]&&clearTimeout(g[e]),g[e]=setTimeout(()=>{window.location.pathname.includes("app")&&!window.appMainPageLoading&&t(),g[e]=null},3e5)},O=function(){var e=y((function*(){const e=Object(o.j)(["keeper"]).keeper;if(e)return e;const t=h(yield Object(o.t)(r.c.getKeeper,{}),2),n=t[0],i=t[1];if(i)return Promise.reject(i);Object(a.c)({keeper:e});const c=Object(o.j)(["loginShopId","shopId"]),l=c.loginShopId,u=c.shopId,p=Object(o.j)(["ksid","shopType"]),d=p.ksid,f=p.shopType;return s.a.registerValue("shopId",u),s.a.registerValue("chainId","CHAIN"===f?l:null),s.a.registerValue("brandId","BRAND"===f?l:null),s.a.registerValue("sourceId","BRAND"===f?l:null),s.a.registerValue("ksid",d),n}));return function(){return e.apply(this,arguments)}}(),w=function(){var e=y((function*(){const e=o.s.getItem("restaurantTree",{session:!0});if(e)return e;const t=h(yield Object(o.t)(r.c.getRestaurantTree,{}),2),n=t[0],a=t[1];return a?Promise.reject(a):(o.s.setItem("restaurantTree",n,{session:!0}),n)}));return function(){return e.apply(this,arguments)}}(),v=function(){var e=y((function*(){if("SHOP"!==Object(o.j)(["shopType","shopId"]).shopType)return null;const e=Object(o.j)(["shopId"]).shopId;if(!e)return Object(i.c)("shopId_null","shop_view_cache"),Object(c.e)("getShopView shopId is not exist"),null;const t=o.s.getItem("shopViewMap");if(t&&t[e])return t[e];const n=h(yield Object(o.t)(r.k.getShopView),2),a=n[0],s=n[1];return s?Promise.reject(s):(o.s.setItem("shopViewMap",{[e]:a}),a)}));return function(){return e.apply(this,arguments)}}(),S=({shopType:e,shopId:t})=>r.f.getMenuTree(e).then(e=>{const n=Object(l.l)(e);return o.s.getItem("menuTreeMap",{session:!0})?o.s.setItem("menuTreeMap",{[t]:n},{session:!0,memory:!1}):o.s.setItem("menuTreeMap",{[t]:n},{session:!0,memory:!1}),n}),_=function(){var e=y((function*(e){const t=o.s.getItem("menuTreeBackupMap",{session:!0,memory:!1});if(t&&t[e])return b("menuTreeBackupMap-"+e,()=>{r.f.getMenuTreeBackup(e).then(n=>{const r=Object(l.l)(n);t?o.s.setItem("menuTreeBackupMap",p(p({},t),{},{[e]:r}),{session:!0,memory:!1}):o.s.setItem("menuTreeBackupMap",{[e]:r},{session:!0,memory:!1})}).catch()}),t[e];const n=h(yield Object(o.t)(r.f.getMenuTreeBackup,e),2),a=n[0],i=n[1],c=Object(l.l)(a);return i?Promise.reject(i):(t?o.s.setItem("menuTreeBackupMap",p(p({},t),{},{[e]:c}),{session:!0,memory:!1}):o.s.setItem("menuTreeBackupMap",{[e]:c},{session:!0,memory:!1}),c)}));return function(t){return e.apply(this,arguments)}}(),j=function(){var e=y((function*(e,t){const n=Object(o.j)(["shopId"]).shopId,r=t||{},a=r.noNeedAsyncUpdate,c=r.shopId||n;if(!c||!e)return[];const s=o.s.getItem("menuTreeMap",{session:!0});if(s&&s[c])return a||b("menuTreeMap-"+e,()=>{S({shopType:e,shopId:c})}),s[c];const l=h(yield Object(o.t)(S,{shopType:e,shopId:c}),2),u=l[0];if(l[1])try{return yield _(e)}catch(e){return Object(i.c)("get_menu_fail","backup"),[]}return u}));return function(t,n){return e.apply(this,arguments)}}(),E=()=>{try{const e=Object(o.j)(["shopType","loginShopId"]),t=e.shopType,n=e.loginShopType,r="BRAND"===t;return"CHAIN"===n?v().catch(()=>null):r?Promise.resolve(null):v().catch(()=>null)}catch(e){return Promise.reject(e)}},I=(e,t,n)=>{const r=Object(o.j)(["shopId"]).shopId;if(!r)return Promise.reject(new Error("[getFinalMenu]: shopId is null"));const a={},i={},c=t.length;s.a.emit("os","fetchApp",{fetching:!0});const u=Object(l.d)(t.concat(n)).map((e,t)=>C(e.parametersMap.customGrayInfo).catch(()=>!0).then(n=>{(e.parametersMap.customGrayInfo.reverse_res?!n:n)?(t<=c?a[e.id]=e:i[e.id]=e,Object(l.k)([Object(l.e)(e)])):(s.a.removeApp(e.parametersMap.srefState),s.a.emit("os","removeApp",{appName:e.parametersMap.srefState}))})),p=Object.values(a)||[],d=Object.values(i)||[];return Promise.all(u).then(()=>{const t=Object(l.a)(e,a),n=Object(l.i)(p.concat(d)),i=s.a.getApps();return s.a.emit("os","fetchApp",{fetching:!1}),o.s.setItem("finalMenuMap",{[r]:t}),o.s.setItem("finalApps",{[r]:n.concat(i)}),{finalMenu:t,newApps:n,menuInGrayArr:p}})},A=function(){var e=y((function*(){const e=Object(o.j)(["shopType","loginShopId","keeper"]),t=e.shopType,n=e.loginShopId,r=e.keeper;if(!t||!n)return Object(i.c)("keeper_info_null","preFetchAppForChain",{shopType:t,loginShopId:n}),Promise.reject(new Error("[preFetchAppForChain]: miss info"));const a=h(yield Promise.all(["CHAIN"===t?Promise.resolve([]):j("CHAIN",{noNeedAsyncUpdate:!0,shopId:n}),"CHAIN"===t?_("SHOP"):Promise.resolve([])]),2),c=a[0],s=a[1],u=Object(l.f)(c,{keeper:r,shopType:t}),p=Object(l.d)(u),d=Object(l.i)(p),f=Object(l.f)(s,{keeper:r,shopType:t}),m=Object(l.d)(f),y=Object(l.i)(m);return d.concat(y)}));return function(){return e.apply(this,arguments)}}();let P=!1;const T=function(){var e=y((function*(){try{const e=Object(o.j)(["shopId","shopType","loginShopType","loginShopId"]),t=e.shopId,n=e.shopType,r=e.loginShopType,a=e.loginShopId;if(!n||!t||!a)return Object(i.c)("keeper_info_null","getNoGrayMenu",{shopId:t,shopType:n,loginShopType:r,loginShopId:a}),Promise.reject(new Error("[preFetchAppForChain]: miss info"));const c=Object(o.j)(["keeper"]).keeper;"CHAIN"===r&&(P||A().then(e=>{P=!0,Object(l.k)(e)}));const s=o.s.getItem("finalMenusMap"),u=o.s.getItem("finalMenuTreeMap");if(s&&s[t]&&u&&u[t]){const e=Object(l.i)(s[t]);return{sidebarMenuTree:[],noGrayMenuTree:u[t],noGrayMenus:s[t],noGrayApps:e,grayMenuList:[],grayHideMenuList:[]}}const p=yield j(n),d=Object(l.f)(p,{keeper:c,shopType:n}),h=Object(l.b)(d).sidebarMenuTree,f=Object(l.c)(d),m=f.noGrayMenuTree,y=f.grayMenuList,g=f.grayHideMenuList,b=f.noGrayHideMenuList,O=Object(l.d)(m.concat(b));return{sidebarMenuTree:h,noGrayMenuTree:m,noGrayMenus:O,noGrayApps:Object(l.i)(O),grayMenuList:y,grayHideMenuList:g}}catch(e){return Promise.reject(e)}}));return function(){return e.apply(this,arguments)}}(),C=e=>"NCP"===e.protocol?r.f.getIsInGrayNcp(e):r.f.getIsInGrayRest(e)},96:function(e,t,n){e.exports={orderList:"orderList__3qqwviFkOHVJ0I4KROzrH2","order-card":"order-card__noWWF46V71jwuubOlv9ZP",orderCard:"order-card__noWWF46V71jwuubOlv9ZP","order-card__header":"order-card__header__1O_FEl-7XwiCwPfQPbY1BQ",orderCard__header:"order-card__header__1O_FEl-7XwiCwPfQPbY1BQ","order-card__sn":"order-card__sn__3P8gvqtqpJbZX9-bxS9lDf",orderCard__sn:"order-card__sn__3P8gvqtqpJbZX9-bxS9lDf","order-card__sn--highlight":"order-card__sn--highlight__3H4Upo-3lBeiezBJ-UDoPL",orderCard__snHighlight:"order-card__sn--highlight__3H4Upo-3lBeiezBJ-UDoPL","order-card__content":"order-card__content__2maNscctvJBhpo2LegOnlq",orderCard__content:"order-card__content__2maNscctvJBhpo2LegOnlq","order-card__user":"order-card__user__2Z7U2NbR7aoOFiJ07QXFji",orderCard__user:"order-card__user__2Z7U2NbR7aoOFiJ07QXFji","order-card__separator":"order-card__separator__2g5EeHB-aEcyyOiWzqiLka",orderCard__separator:"order-card__separator__2g5EeHB-aEcyyOiWzqiLka","order-card__phone":"order-card__phone__1f08BUHDHfHP-6lwAtWoZq",orderCard__phone:"order-card__phone__1f08BUHDHfHP-6lwAtWoZq","order-card__income":"order-card__income__3DCj5yQcWouqzRCR_Au4nS",orderCard__income:"order-card__income__3DCj5yQcWouqzRCR_Au4nS"}}});